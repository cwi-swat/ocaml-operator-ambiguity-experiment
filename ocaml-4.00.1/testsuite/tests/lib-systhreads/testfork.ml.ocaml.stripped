(
  let
  (
    compute_thread
      (
        case
        (
          c
          ignore
          (
              c
          )
        )
      )
  )
  let
  (
    main
      (
        case
        (
          ()
                    sequence
          (
            ignore
            (
                Thread.create
                (
                    compute_thread
                    31
                )
            )
          ;
            sequence
            (
              Thread.delay
              (
                  1.0
              )
            ;
              sequence
              (
                print_string
                (
                    "Forking..."
                )
              ;
                sequence
                (
                  print_newline
                  (
                      ()
                                        )
                ;
                  match
                  Unix.fork
                  (
                      ()
                                        )
                  (
                    case
                    (
                      0
                      sequence
                      (
                        Thread.delay
                        (
                            0.5
                        )
                      ;
                        sequence
                        (
                          print_string
                          (
                              "In child..."
                          )
                        ;
                          sequence
                          (
                            print_newline
                            (
                                ()
                                                            )
                          ;
                            sequence
                            (
                              Gc.minor
                              (
                                  ()
                                                                )
                            ;
                              sequence
                              (
                                print_string
                                (
                                    "Child did minor GC."
                                )
                              ;
                                sequence
                                (
                                  print_newline
                                  (
                                      ()
                                                                        )
                                ;
                                  sequence
                                  (
                                    ignore
                                    (
                                        Thread.create
                                        (
                                            compute_thread
                                            32
                                        )
                                    )
                                  ;
                                    sequence
                                    (
                                      Thread.delay
                                      (
                                          1.0
                                      )
                                    ;
                                      sequence
                                      (
                                        print_string
                                        (
                                            "Child is exiting."
                                        )
                                      ;
                                        sequence
                                        (
                                          print_newline
                                          (
                                              ()
                                                                                        )
                                        ;
                                          exit
                                          (
                                              0
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    case
                    (
                      pid
                      sequence
                      (
                        print_string
                        (
                            "In parent..."
                        )
                      ;
                        sequence
                        (
                          print_newline
                          (
                              ()
                                                        )
                        ;
                          sequence
                          (
                            Thread.delay
                            (
                                4.0
                            )
                          ;
                            sequence
                            (
                              print_string
                              (
                                  "Parent is exiting."
                              )
                            ;
                              sequence
                              (
                                print_newline
                                (
                                    ()
                                                                    )
                              ;
                                exit
                                (
                                    0
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  main
  (
      ()
        )
)
