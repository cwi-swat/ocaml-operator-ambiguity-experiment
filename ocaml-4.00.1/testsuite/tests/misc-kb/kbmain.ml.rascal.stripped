(
  open Terms
  open Equations
  open Orderings
  open Kb
  let
  (
    geom_rules
    ::
     (
     record
     (
      number
      1
        numvars
        1
        lhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "U"
         	  	[]
         	  )
         	 ::
         	 (
         	  Var
         	  1
         	 []
         	 ) 
         	 ) 
         )
        rhs
         Var
         1
     )
     ::
     (
     record
     (
      number
      2
        numvars
        1
        lhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "I"
         	  	::
         	  	 (
         	  	  Var
         	  	  1
         	  	 []
         	  	 ) 
         	  )
         	 ::
         	 (
         	  Var
         	  1
         	 []
         	 ) 
         	 ) 
         )
        rhs
         Term
         (
             					 "U"
         	[]
         )
     )
     ::
     (
     record
     (
      number
      3
        numvars
        3
        lhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "*"
         	  	::
         	  	 (
         	  	  Var
         	  	  1
         	  	 ::
         	  	 (
         	  	  Var
         	  	  2
         	  	 []
         	  	 ) 
         	  	 ) 
         	  )
         	 ::
         	 (
         	  Var
         	  3
         	 []
         	 ) 
         	 ) 
         )
        rhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Var
         	  1
         	 ::
         	 (
         	  Term
         	  (
         	      					 "*"
         	  	::
         	  	 (
         	  	  Var
         	  	  2
         	  	 ::
         	  	 (
         	  	  Var
         	  	  3
         	  	 []
         	  	 ) 
         	  	 ) 
         	  )
         	 []
         	 ) 
         	 ) 
         )
     )
     ::
     (
     record
     (
      number
      4
        numvars
        0
        lhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "A"
         	  	[]
         	  )
         	 ::
         	 (
         	  Term
         	  (
         	      					 "B"
         	  	[]
         	  )
         	 []
         	 ) 
         	 ) 
         )
        rhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "B"
         	  	[]
         	  )
         	 ::
         	 (
         	  Term
         	  (
         	      					 "A"
         	  	[]
         	  )
         	 []
         	 ) 
         	 ) 
         )
     )
     ::
     (
     record
     (
      number
      5
        numvars
        0
        lhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "C"
         	  	[]
         	  )
         	 ::
         	 (
         	  Term
         	  (
         	      					 "C"
         	  	[]
         	  )
         	 []
         	 ) 
         	 ) 
         )
        rhs
         Term
         (
             					 "U"
         	[]
         )
     )
     ::
     (
     record
     (
      number
      6
        numvars
        0
        lhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "C"
         	  	[]
         	  )
         	 ::
         	 (
         	  Term
         	  (
         	      					 "*"
         	  	::
         	  	 (
         	  	  Term
         	  	  (
         	  	      					 "A"
         	  	  	[]
         	  	  )
         	  	 ::
         	  	 (
         	  	  Term
         	  	  (
         	  	      					 "I"
         	  	  	::
         	  	  	 (
         	  	  	  Term
         	  	  	  (
         	  	  	      					 "C"
         	  	  	  	[]
         	  	  	  )
         	  	  	 []
         	  	  	 ) 
         	  	  )
         	  	 []
         	  	 ) 
         	  	 ) 
         	  )
         	 []
         	 ) 
         	 ) 
         )
        rhs
         Term
         (
             					 "I"
         	::
         	 (
         	  Term
         	  (
         	      					 "A"
         	  	[]
         	  )
         	 []
         	 ) 
         )
     )
     ::
     (
     record
     (
      number
      7
        numvars
        0
        lhs
         Term
         (
             					 "*"
         	::
         	 (
         	  Term
         	  (
         	      					 "C"
         	  	[]
         	  )
         	 ::
         	 (
         	  Term
         	  (
         	      					 "*"
         	  	::
         	  	 (
         	  	  Term
         	  	  (
         	  	      					 "B"
         	  	  	[]
         	  	  )
         	  	 ::
         	  	 (
         	  	  Term
         	  	  (
         	  	      					 "I"
         	  	  	::
         	  	  	 (
         	  	  	  Term
         	  	  	  (
         	  	  	      					 "C"
         	  	  	  	[]
         	  	  	  )
         	  	  	 []
         	  	  	 ) 
         	  	  )
         	  	 []
         	  	 ) 
         	  	 ) 
         	  )
         	 []
         	 ) 
         	 ) 
         )
        rhs
         Term
         (
             					 "B"
         	[]
         )
     )
     []
     ) 
     ) 
     ) 
     ) 
     ) 
     ) 
     ) 
  )
  let
  (
    group_rank
    (
     case
     (
       "U"
       0
     ) 
       case
       (
        "*"
        1
       )
       case
       (
        "I"
        2
       )
       case
       (
        "B"
        3
       )
       case
       (
        "C"
        4
       )
       case
       (
        "A"
        5
       )
       case
       (
        _
        assert false
       )
    )
  )
  let
  (
    group_precedence
   (
    case
        (
     		 op1
     		(
     		 case
     		     (
     		 	  op2
     		      let
     		      (
     		       (
     		         r1
     		         group_rank
     		         (
     		             op1
     		         ) 
     		         r2
     		         group_rank
     		         (
     		             op2
     		         ) 
     		       )
     		      in
     		        ifthenelse
     		        (
     		         if
     		         (
     		          =
     		          (
     		              r1
     		              r2
     		          )
     		         )
     		         then
     		         (
     		          Equal
     		         )
     		         else
     		         (
     		          ifthenelse
     		          (
     		           if
     		           (
     		            >
     		            (
     		                r1
     		                r2
     		            )
     		           )
     		           then
     		           (
     		            Greater
     		           )
     		           else
     		           (
     		            NotGE
     		           ) 
     		          )
     		         ) 
     		        )
     		      )
     		     )
     		)
        )
   )
  )
  let
  (
    group_order
    rpo
    (
        group_precedence
        lex_ext
    ) 
  )
  let
  (
    greater
   (
    case
        (
    	  pair
         match
         group_order
         (
             pair
         )
         (
         case
         (
           Greater
           true
         ) 
           case
           (
            _
            false
           )
         )
        )
   )
  )
    for i
    1
    20
    kb_complete
    (
        greater
        []
        geom_rules
    )
)
