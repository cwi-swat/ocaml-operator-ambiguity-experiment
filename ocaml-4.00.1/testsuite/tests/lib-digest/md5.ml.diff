0a1,3151
> (
>   open Printf
>   type
>   (
>     context
>       type
>         params =
>           (
>           )
>         cstrs =
>           (
>           )
>         kind =
>             (
>               buf
>                   poly
>                      string
>                     (
>                     )
>               pos
>                   poly
>                      int
>                     (
>                     )
>               a
>                   poly
>                      int32
>                     (
>                     )
>               b
>                   poly
>                      int32
>                     (
>                     )
>               c
>                   poly
>                      int32
>                     (
>                     )
>               d
>                   poly
>                      int32
>                     (
>                     )
>               bits
>                   poly
>                      int64
>                     (
>                     )
>             )
>             )
>   let
>   (
>     step1
>       (
>         case
>         (
>           w
>           (
>             case
>             (
>               x
>               (
>                 case
>                 (
>                   y
>                   (
>                     case
>                     (
>                       z
>                       (
>                         case
>                         (
>                           data
>                           (
>                             case
>                             (
>                               s
>                               let
>                               (
>                                 (
>                                   w
>                                     Int32.add
>                                     (
>                                         Int32.add
>                                         (
>                                             w
>                                             data
>                                         )
>                                         Int32.logxor
>                                         (
>                                             z
>                                             Int32.logand
>                                             (
>                                                 x
>                                                 Int32.logxor
>                                                 (
>                                                     y
>                                                     z
>                                                 )
>                                             )
>                                         )
>                                     )
>                                 )
>                               in
>                                 Int32.add
>                                 (
>                                     x
>                                     Int32.logor
>                                     (
>                                         Int32.shift_left
>                                         (
>                                             w
>                                             s
>                                         )
>                                         Int32.shift_right_logical
>                                         (
>                                             w
>                                             -
>                                             (
>                                                 32
>                                                 s
>                                             )
>                                         )
>                                     )
>                                 )
>                               )
>                             )
>                           )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     step2
>       (
>         case
>         (
>           w
>           (
>             case
>             (
>               x
>               (
>                 case
>                 (
>                   y
>                   (
>                     case
>                     (
>                       z
>                       (
>                         case
>                         (
>                           data
>                           (
>                             case
>                             (
>                               s
>                               let
>                               (
>                                 (
>                                   w
>                                     Int32.add
>                                     (
>                                         Int32.add
>                                         (
>                                             w
>                                             data
>                                         )
>                                         Int32.logxor
>                                         (
>                                             y
>                                             Int32.logand
>                                             (
>                                                 z
>                                                 Int32.logxor
>                                                 (
>                                                     x
>                                                     y
>                                                 )
>                                             )
>                                         )
>                                     )
>                                 )
>                               in
>                                 Int32.add
>                                 (
>                                     x
>                                     Int32.logor
>                                     (
>                                         Int32.shift_left
>                                         (
>                                             w
>                                             s
>                                         )
>                                         Int32.shift_right_logical
>                                         (
>                                             w
>                                             -
>                                             (
>                                                 32
>                                                 s
>                                             )
>                                         )
>                                     )
>                                 )
>                               )
>                             )
>                           )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     step3
>       (
>         case
>         (
>           w
>           (
>             case
>             (
>               x
>               (
>                 case
>                 (
>                   y
>                   (
>                     case
>                     (
>                       z
>                       (
>                         case
>                         (
>                           data
>                           (
>                             case
>                             (
>                               s
>                               let
>                               (
>                                 (
>                                   w
>                                     Int32.add
>                                     (
>                                         Int32.add
>                                         (
>                                             w
>                                             data
>                                         )
>                                         Int32.logxor
>                                         (
>                                             x
>                                             Int32.logxor
>                                             (
>                                                 y
>                                                 z
>                                             )
>                                         )
>                                     )
>                                 )
>                               in
>                                 Int32.add
>                                 (
>                                     x
>                                     Int32.logor
>                                     (
>                                         Int32.shift_left
>                                         (
>                                             w
>                                             s
>                                         )
>                                         Int32.shift_right_logical
>                                         (
>                                             w
>                                             -
>                                             (
>                                                 32
>                                                 s
>                                             )
>                                         )
>                                     )
>                                 )
>                               )
>                             )
>                           )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     step4
>       (
>         case
>         (
>           w
>           (
>             case
>             (
>               x
>               (
>                 case
>                 (
>                   y
>                   (
>                     case
>                     (
>                       z
>                       (
>                         case
>                         (
>                           data
>                           (
>                             case
>                             (
>                               s
>                               let
>                               (
>                                 (
>                                   w
>                                     Int32.add
>                                     (
>                                         Int32.add
>                                         (
>                                             w
>                                             data
>                                         )
>                                         Int32.logxor
>                                         (
>                                             y
>                                             Int32.logor
>                                             (
>                                                 x
>                                                 Int32.logxor
>                                                 (
>                                                     z
>                                                     -1
>                                                 )
>                                             )
>                                         )
>                                     )
>                                 )
>                               in
>                                 Int32.add
>                                 (
>                                     x
>                                     Int32.logor
>                                     (
>                                         Int32.shift_left
>                                         (
>                                             w
>                                             s
>                                         )
>                                         Int32.shift_right_logical
>                                         (
>                                             w
>                                             -
>                                             (
>                                                 32
>                                                 s
>                                             )
>                                         )
>                                     )
>                                 )
>                               )
>                             )
>                           )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     transform
>       (
>         case
>         (
>           ctx
>           (
>             case
>             (
>               data
>               let
>               (
>                 (
>                   a
>                     field
>                     (
>                     ctx
>                     a
>                     )
>                   b
>                     field
>                     (
>                     ctx
>                     b
>                     )
>                   c
>                     field
>                     (
>                     ctx
>                     c
>                     )
>                   d
>                     field
>                     (
>                     ctx
>                     d
>                     )
>                 )
>               in
>                 let
>                 (
>                   (
>                     a
>                       step1
>                       (
>                           a
>                           b
>                           c
>                           d
>                           Int32.add
>                           (
>                               Array.get
>                               (
>                                   data
>                                   0
>                               )
>                               -680876936
>                           )
>                           7
>                       )
>                   )
>                 in
>                   let
>                   (
>                     (
>                       d
>                         step1
>                         (
>                             d
>                             a
>                             b
>                             c
>                             Int32.add
>                             (
>                                 Array.get
>                                 (
>                                     data
>                                     1
>                                 )
>                                 -389564586
>                             )
>                             12
>                         )
>                     )
>                   in
>                     let
>                     (
>                       (
>                         c
>                           step1
>                           (
>                               c
>                               d
>                               a
>                               b
>                               Int32.add
>                               (
>                                   Array.get
>                                   (
>                                       data
>                                       2
>                                   )
>                                   606105819
>                               )
>                               17
>                           )
>                       )
>                     in
>                       let
>                       (
>                         (
>                           b
>                             step1
>                             (
>                                 b
>                                 c
>                                 d
>                                 a
>                                 Int32.add
>                                 (
>                                     Array.get
>                                     (
>                                         data
>                                         3
>                                     )
>                                     -1044525330
>                                 )
>                                 22
>                             )
>                         )
>                       in
>                         let
>                         (
>                           (
>                             a
>                               step1
>                               (
>                                   a
>                                   b
>                                   c
>                                   d
>                                   Int32.add
>                                   (
>                                       Array.get
>                                       (
>                                           data
>                                           4
>                                       )
>                                       -176418897
>                                   )
>                                   7
>                               )
>                           )
>                         in
>                           let
>                           (
>                             (
>                               d
>                                 step1
>                                 (
>                                     d
>                                     a
>                                     b
>                                     c
>                                     Int32.add
>                                     (
>                                         Array.get
>                                         (
>                                             data
>                                             5
>                                         )
>                                         1200080426
>                                     )
>                                     12
>                                 )
>                             )
>                           in
>                             let
>                             (
>                               (
>                                 c
>                                   step1
>                                   (
>                                       c
>                                       d
>                                       a
>                                       b
>                                       Int32.add
>                                       (
>                                           Array.get
>                                           (
>                                               data
>                                               6
>                                           )
>                                           -1473231341
>                                       )
>                                       17
>                                   )
>                               )
>                             in
>                               let
>                               (
>                                 (
>                                   b
>                                     step1
>                                     (
>                                         b
>                                         c
>                                         d
>                                         a
>                                         Int32.add
>                                         (
>                                             Array.get
>                                             (
>                                                 data
>                                                 7
>                                             )
>                                             -45705983
>                                         )
>                                         22
>                                     )
>                                 )
>                               in
>                                 let
>                                 (
>                                   (
>                                     a
>                                       step1
>                                       (
>                                           a
>                                           b
>                                           c
>                                           d
>                                           Int32.add
>                                           (
>                                               Array.get
>                                               (
>                                                   data
>                                                   8
>                                               )
>                                               1770035416
>                                           )
>                                           7
>                                       )
>                                   )
>                                 in
>                                   let
>                                   (
>                                     (
>                                       d
>                                         step1
>                                         (
>                                             d
>                                             a
>                                             b
>                                             c
>                                             Int32.add
>                                             (
>                                                 Array.get
>                                                 (
>                                                     data
>                                                     9
>                                                 )
>                                                 -1958414417
>                                             )
>                                             12
>                                         )
>                                     )
>                                   in
>                                     let
>                                     (
>                                       (
>                                         c
>                                           step1
>                                           (
>                                               c
>                                               d
>                                               a
>                                               b
>                                               Int32.add
>                                               (
>                                                   Array.get
>                                                   (
>                                                       data
>                                                       10
>                                                   )
>                                                   -42063
>                                               )
>                                               17
>                                           )
>                                       )
>                                     in
>                                       let
>                                       (
>                                         (
>                                           b
>                                             step1
>                                             (
>                                                 b
>                                                 c
>                                                 d
>                                                 a
>                                                 Int32.add
>                                                 (
>                                                     Array.get
>                                                     (
>                                                         data
>                                                         11
>                                                     )
>                                                     -1990404162
>                                                 )
>                                                 22
>                                             )
>                                         )
>                                       in
>                                         let
>                                         (
>                                           (
>                                             a
>                                               step1
>                                               (
>                                                   a
>                                                   b
>                                                   c
>                                                   d
>                                                   Int32.add
>                                                   (
>                                                       Array.get
>                                                       (
>                                                           data
>                                                           12
>                                                       )
>                                                       1804603682
>                                                   )
>                                                   7
>                                               )
>                                           )
>                                         in
>                                           let
>                                           (
>                                             (
>                                               d
>                                                 step1
>                                                 (
>                                                     d
>                                                     a
>                                                     b
>                                                     c
>                                                     Int32.add
>                                                     (
>                                                         Array.get
>                                                         (
>                                                             data
>                                                             13
>                                                         )
>                                                         -40341101
>                                                     )
>                                                     12
>                                                 )
>                                             )
>                                           in
>                                             let
>                                             (
>                                               (
>                                                 c
>                                                   step1
>                                                   (
>                                                       c
>                                                       d
>                                                       a
>                                                       b
>                                                       Int32.add
>                                                       (
>                                                           Array.get
>                                                           (
>                                                               data
>                                                               14
>                                                           )
>                                                           -1502002290
>                                                       )
>                                                       17
>                                                   )
>                                               )
>                                             in
>                                               let
>                                               (
>                                                 (
>                                                   b
>                                                     step1
>                                                     (
>                                                         b
>                                                         c
>                                                         d
>                                                         a
>                                                         Int32.add
>                                                         (
>                                                             Array.get
>                                                             (
>                                                                 data
>                                                                 15
>                                                             )
>                                                             1236535329
>                                                         )
>                                                         22
>                                                     )
>                                                 )
>                                               in
>                                                 let
>                                                 (
>                                                   (
>                                                     a
>                                                       step2
>                                                       (
>                                                           a
>                                                           b
>                                                           c
>                                                           d
>                                                           Int32.add
>                                                           (
>                                                               Array.get
>                                                               (
>                                                                   data
>                                                                   1
>                                                               )
>                                                               -165796510
>                                                           )
>                                                           5
>                                                       )
>                                                   )
>                                                 in
>                                                   let
>                                                   (
>                                                     (
>                                                       d
>                                                         step2
>                                                         (
>                                                             d
>                                                             a
>                                                             b
>                                                             c
>                                                             Int32.add
>                                                             (
>                                                                 Array.get
>                                                                 (
>                                                                     data
>                                                                     6
>                                                                 )
>                                                                 -1069501632
>                                                             )
>                                                             9
>                                                         )
>                                                     )
>                                                   in
>                                                     let
>                                                     (
>                                                       (
>                                                         c
>                                                           step2
>                                                           (
>                                                               c
>                                                               d
>                                                               a
>                                                               b
>                                                               Int32.add
>                                                               (
>                                                                   Array.get
>                                                                   (
>                                                                       data
>                                                                       11
>                                                                   )
>                                                                   643717713
>                                                               )
>                                                               14
>                                                           )
>                                                       )
>                                                     in
>                                                       let
>                                                       (
>                                                         (
>                                                           b
>                                                             step2
>                                                             (
>                                                                 b
>                                                                 c
>                                                                 d
>                                                                 a
>                                                                 Int32.add
>                                                                 (
>                                                                     Array.get
>                                                                     (
>                                                                         data
>                                                                         0
>                                                                     )
>                                                                     -373897302
>                                                                 )
>                                                                 20
>                                                             )
>                                                         )
>                                                       in
>                                                         let
>                                                         (
>                                                           (
>                                                             a
>                                                               step2
>                                                               (
>                                                                   a
>                                                                   b
>                                                                   c
>                                                                   d
>                                                                   Int32.add
>                                                                   (
>                                                                       Array.get
>                                                                       (
>                                                                           data
>                                                                           5
>                                                                       )
>                                                                       -701558691
>                                                                   )
>                                                                   5
>                                                               )
>                                                           )
>                                                         in
>                                                           let
>                                                           (
>                                                             (
>                                                               d
>                                                                 step2
>                                                                 (
>                                                                     d
>                                                                     a
>                                                                     b
>                                                                     c
>                                                                     Int32.add
>                                                                     (
>                                                                         Array.get
>                                                                         (
>                                                                             data
>                                                                             10
>                                                                         )
>                                                                         38016083
>                                                                     )
>                                                                     9
>                                                                 )
>                                                             )
>                                                           in
>                                                             let
>                                                             (
>                                                               (
>                                                                 c
>                                                                   step2
>                                                                   (
>                                                                       c
>                                                                       d
>                                                                       a
>                                                                       b
>                                                                       Int32.add
>                                                                       (
>                                                                           Array.get
>                                                                           (
>                                                                               data
>                                                                               15
>                                                                           )
>                                                                           -660478335
>                                                                       )
>                                                                       14
>                                                                   )
>                                                               )
>                                                             in
>                                                               let
>                                                               (
>                                                                 (
>                                                                   b
>                                                                     step2
>                                                                     (
>                                                                         b
>                                                                         c
>                                                                         d
>                                                                         a
>                                                                         Int32.add
>                                                                         (
>                                                                             Array.get
>                                                                             (
>                                                                                 data
>                                                                                 4
>                                                                             )
>                                                                             -405537848
>                                                                         )
>                                                                         20
>                                                                     )
>                                                                 )
>                                                               in
>                                                                 let
>                                                                 (
>                                                                   (
>                                                                     a
>                                                                       step2
>                                                                       (
>                                                                           a
>                                                                           b
>                                                                           c
>                                                                           d
>                                                                           Int32.add
>                                                                           (
>                                                                               Array.get
>                                                                               (
>                                                                                   data
>                                                                                   9
>                                                                               )
>                                                                               568446438
>                                                                           )
>                                                                           5
>                                                                       )
>                                                                   )
>                                                                 in
>                                                                   let
>                                                                   (
>                                                                     (
>                                                                       d
>                                                                         step2
>                                                                         (
>                                                                             d
>                                                                             a
>                                                                             b
>                                                                             c
>                                                                             Int32.add
>                                                                             (
>                                                                                 Array.get
>                                                                                 (
>                                                                                     data
>                                                                                     14
>                                                                                 )
>                                                                                 -1019803690
>                                                                             )
>                                                                             9
>                                                                         )
>                                                                     )
>                                                                   in
>                                                                     let
>                                                                     (
>                                                                       (
>                                                                         c
>                                                                           step2
>                                                                           (
>                                                                               c
>                                                                               d
>                                                                               a
>                                                                               b
>                                                                               Int32.add
>                                                                               (
>                                                                                   Array.get
>                                                                                   (
>                                                                                       data
>                                                                                       3
>                                                                                   )
>                                                                                   -187363961
>                                                                               )
>                                                                               14
>                                                                           )
>                                                                       )
>                                                                     in
>                                                                       let
>                                                                       (
>                                                                         (
>                                                                           b
>                                                                             step2
>                                                                             (
>                                                                                 b
>                                                                                 c
>                                                                                 d
>                                                                                 a
>                                                                                 Int32.add
>                                                                                 (
>                                                                                     Array.get
>                                                                                     (
>                                                                                         data
>                                                                                         8
>                                                                                     )
>                                                                                     1163531501
>                                                                                 )
>                                                                                 20
>                                                                             )
>                                                                         )
>                                                                       in
>                                                                         let
>                                                                         (
>                                                                           (
>                                                                             a
>                                                                               step2
>                                                                               (
>                                                                                   a
>                                                                                   b
>                                                                                   c
>                                                                                   d
>                                                                                   Int32.add
>                                                                                   (
>                                                                                       Array.get
>                                                                                       (
>                                                                                           data
>                                                                                           13
>                                                                                       )
>                                                                                       -1444681467
>                                                                                   )
>                                                                                   5
>                                                                               )
>                                                                           )
>                                                                         in
>                                                                           let
>                                                                           (
>                                                                             (
>                                                                               d
>                                                                                 step2
>                                                                                 (
>                                                                                     d
>                                                                                     a
>                                                                                     b
>                                                                                     c
>                                                                                     Int32.add
>                                                                                     (
>                                                                                         Array.get
>                                                                                         (
>                                                                                             data
>                                                                                             2
>                                                                                         )
>                                                                                         -51403784
>                                                                                     )
>                                                                                     9
>                                                                                 )
>                                                                             )
>                                                                           in
>                                                                             let
>                                                                             (
>                                                                               (
>                                                                                 c
>                                                                                   step2
>                                                                                   (
>                                                                                       c
>                                                                                       d
>                                                                                       a
>                                                                                       b
>                                                                                       Int32.add
>                                                                                       (
>                                                                                           Array.get
>                                                                                           (
>                                                                                               data
>                                                                                               7
>                                                                                           )
>                                                                                           1735328473
>                                                                                       )
>                                                                                       14
>                                                                                   )
>                                                                               )
>                                                                             in
>                                                                               let
>                                                                               (
>                                                                                 (
>                                                                                   b
>                                                                                     step2
>                                                                                     (
>                                                                                         b
>                                                                                         c
>                                                                                         d
>                                                                                         a
>                                                                                         Int32.add
>                                                                                         (
>                                                                                             Array.get
>                                                                                             (
>                                                                                                 data
>                                                                                                 12
>                                                                                             )
>                                                                                             -1926607734
>                                                                                         )
>                                                                                         20
>                                                                                     )
>                                                                                 )
>                                                                               in
>                                                                                 let
>                                                                                 (
>                                                                                   (
>                                                                                     a
>                                                                                       step3
>                                                                                       (
>                                                                                           a
>                                                                                           b
>                                                                                           c
>                                                                                           d
>                                                                                           Int32.add
>                                                                                           (
>                                                                                               Array.get
>                                                                                               (
>                                                                                                   data
>                                                                                                   5
>                                                                                               )
>                                                                                               -378558
>                                                                                           )
>                                                                                           4
>                                                                                       )
>                                                                                   )
>                                                                                 in
>                                                                                   let
>                                                                                   (
>                                                                                     (
>                                                                                       d
>                                                                                         step3
>                                                                                         (
>                                                                                             d
>                                                                                             a
>                                                                                             b
>                                                                                             c
>                                                                                             Int32.add
>                                                                                             (
>                                                                                                 Array.get
>                                                                                                 (
>                                                                                                     data
>                                                                                                     8
>                                                                                                 )
>                                                                                                 -2022574463
>                                                                                             )
>                                                                                             11
>                                                                                         )
>                                                                                     )
>                                                                                   in
>                                                                                     let
>                                                                                     (
>                                                                                       (
>                                                                                         c
>                                                                                           step3
>                                                                                           (
>                                                                                               c
>                                                                                               d
>                                                                                               a
>                                                                                               b
>                                                                                               Int32.add
>                                                                                               (
>                                                                                                   Array.get
>                                                                                                   (
>                                                                                                       data
>                                                                                                       11
>                                                                                                   )
>                                                                                                   1839030562
>                                                                                               )
>                                                                                               16
>                                                                                           )
>                                                                                       )
>                                                                                     in
>                                                                                       let
>                                                                                       (
>                                                                                         (
>                                                                                           b
>                                                                                             step3
>                                                                                             (
>                                                                                                 b
>                                                                                                 c
>                                                                                                 d
>                                                                                                 a
>                                                                                                 Int32.add
>                                                                                                 (
>                                                                                                     Array.get
>                                                                                                     (
>                                                                                                         data
>                                                                                                         14
>                                                                                                     )
>                                                                                                     -35309556
>                                                                                                 )
>                                                                                                 23
>                                                                                             )
>                                                                                         )
>                                                                                       in
>                                                                                         let
>                                                                                         (
>                                                                                           (
>                                                                                             a
>                                                                                               step3
>                                                                                               (
>                                                                                                   a
>                                                                                                   b
>                                                                                                   c
>                                                                                                   d
>                                                                                                   Int32.add
>                                                                                                   (
>                                                                                                       Array.get
>                                                                                                       (
>                                                                                                           data
>                                                                                                           1
>                                                                                                       )
>                                                                                                       -1530992060
>                                                                                                   )
>                                                                                                   4
>                                                                                               )
>                                                                                           )
>                                                                                         in
>                                                                                           let
>                                                                                           (
>                                                                                             (
>                                                                                               d
>                                                                                                 step3
>                                                                                                 (
>                                                                                                     d
>                                                                                                     a
>                                                                                                     b
>                                                                                                     c
>                                                                                                     Int32.add
>                                                                                                     (
>                                                                                                         Array.get
>                                                                                                         (
>                                                                                                             data
>                                                                                                             4
>                                                                                                         )
>                                                                                                         1272893353
>                                                                                                     )
>                                                                                                     11
>                                                                                                 )
>                                                                                             )
>                                                                                           in
>                                                                                             let
>                                                                                             (
>                                                                                               (
>                                                                                                 c
>                                                                                                   step3
>                                                                                                   (
>                                                                                                       c
>                                                                                                       d
>                                                                                                       a
>                                                                                                       b
>                                                                                                       Int32.add
>                                                                                                       (
>                                                                                                           Array.get
>                                                                                                           (
>                                                                                                               data
>                                                                                                               7
>                                                                                                           )
>                                                                                                           -155497632
>                                                                                                       )
>                                                                                                       16
>                                                                                                   )
>                                                                                               )
>                                                                                             in
>                                                                                               let
>                                                                                               (
>                                                                                                 (
>                                                                                                   b
>                                                                                                     step3
>                                                                                                     (
>                                                                                                         b
>                                                                                                         c
>                                                                                                         d
>                                                                                                         a
>                                                                                                         Int32.add
>                                                                                                         (
>                                                                                                             Array.get
>                                                                                                             (
>                                                                                                                 data
>                                                                                                                 10
>                                                                                                             )
>                                                                                                             -1094730640
>                                                                                                         )
>                                                                                                         23
>                                                                                                     )
>                                                                                                 )
>                                                                                               in
>                                                                                                 let
>                                                                                                 (
>                                                                                                   (
>                                                                                                     a
>                                                                                                       step3
>                                                                                                       (
>                                                                                                           a
>                                                                                                           b
>                                                                                                           c
>                                                                                                           d
>                                                                                                           Int32.add
>                                                                                                           (
>                                                                                                               Array.get
>                                                                                                               (
>                                                                                                                   data
>                                                                                                                   13
>                                                                                                               )
>                                                                                                               681279174
>                                                                                                           )
>                                                                                                           4
>                                                                                                       )
>                                                                                                   )
>                                                                                                 in
>                                                                                                   let
>                                                                                                   (
>                                                                                                     (
>                                                                                                       d
>                                                                                                         step3
>                                                                                                         (
>                                                                                                             d
>                                                                                                             a
>                                                                                                             b
>                                                                                                             c
>                                                                                                             Int32.add
>                                                                                                             (
>                                                                                                                 Array.get
>                                                                                                                 (
>                                                                                                                     data
>                                                                                                                     0
>                                                                                                                 )
>                                                                                                                 -358537222
>                                                                                                             )
>                                                                                                             11
>                                                                                                         )
>                                                                                                     )
>                                                                                                   in
>                                                                                                     let
>                                                                                                     (
>                                                                                                       (
>                                                                                                         c
>                                                                                                           step3
>                                                                                                           (
>                                                                                                               c
>                                                                                                               d
>                                                                                                               a
>                                                                                                               b
>                                                                                                               Int32.add
>                                                                                                               (
>                                                                                                                   Array.get
>                                                                                                                   (
>                                                                                                                       data
>                                                                                                                       3
>                                                                                                                   )
>                                                                                                                   -722521979
>                                                                                                               )
>                                                                                                               16
>                                                                                                           )
>                                                                                                       )
>                                                                                                     in
>                                                                                                       let
>                                                                                                       (
>                                                                                                         (
>                                                                                                           b
>                                                                                                             step3
>                                                                                                             (
>                                                                                                                 b
>                                                                                                                 c
>                                                                                                                 d
>                                                                                                                 a
>                                                                                                                 Int32.add
>                                                                                                                 (
>                                                                                                                     Array.get
>                                                                                                                     (
>                                                                                                                         data
>                                                                                                                         6
>                                                                                                                     )
>                                                                                                                     76029189
>                                                                                                                 )
>                                                                                                                 23
>                                                                                                             )
>                                                                                                         )
>                                                                                                       in
>                                                                                                         let
>                                                                                                         (
>                                                                                                           (
>                                                                                                             a
>                                                                                                               step3
>                                                                                                               (
>                                                                                                                   a
>                                                                                                                   b
>                                                                                                                   c
>                                                                                                                   d
>                                                                                                                   Int32.add
>                                                                                                                   (
>                                                                                                                       Array.get
>                                                                                                                       (
>                                                                                                                           data
>                                                                                                                           9
>                                                                                                                       )
>                                                                                                                       -640364487
>                                                                                                                   )
>                                                                                                                   4
>                                                                                                               )
>                                                                                                           )
>                                                                                                         in
>                                                                                                           let
>                                                                                                           (
>                                                                                                             (
>                                                                                                               d
>                                                                                                                 step3
>                                                                                                                 (
>                                                                                                                     d
>                                                                                                                     a
>                                                                                                                     b
>                                                                                                                     c
>                                                                                                                     Int32.add
>                                                                                                                     (
>                                                                                                                         Array.get
>                                                                                                                         (
>                                                                                                                             data
>                                                                                                                             12
>                                                                                                                         )
>                                                                                                                         -421815835
>                                                                                                                     )
>                                                                                                                     11
>                                                                                                                 )
>                                                                                                             )
>                                                                                                           in
>                                                                                                             let
>                                                                                                             (
>                                                                                                               (
>                                                                                                                 c
>                                                                                                                   step3
>                                                                                                                   (
>                                                                                                                       c
>                                                                                                                       d
>                                                                                                                       a
>                                                                                                                       b
>                                                                                                                       Int32.add
>                                                                                                                       (
>                                                                                                                           Array.get
>                                                                                                                           (
>                                                                                                                               data
>                                                                                                                               15
>                                                                                                                           )
>                                                                                                                           530742520
>                                                                                                                       )
>                                                                                                                       16
>                                                                                                                   )
>                                                                                                               )
>                                                                                                             in
>                                                                                                               let
>                                                                                                               (
>                                                                                                                 (
>                                                                                                                   b
>                                                                                                                     step3
>                                                                                                                     (
>                                                                                                                         b
>                                                                                                                         c
>                                                                                                                         d
>                                                                                                                         a
>                                                                                                                         Int32.add
>                                                                                                                         (
>                                                                                                                             Array.get
>                                                                                                                             (
>                                                                                                                                 data
>                                                                                                                                 2
>                                                                                                                             )
>                                                                                                                             -995338651
>                                                                                                                         )
>                                                                                                                         23
>                                                                                                                     )
>                                                                                                                 )
>                                                                                                               in
>                                                                                                                 let
>                                                                                                                 (
>                                                                                                                   (
>                                                                                                                     a
>                                                                                                                       step4
>                                                                                                                       (
>                                                                                                                           a
>                                                                                                                           b
>                                                                                                                           c
>                                                                                                                           d
>                                                                                                                           Int32.add
>                                                                                                                           (
>                                                                                                                               Array.get
>                                                                                                                               (
>                                                                                                                                   data
>                                                                                                                                   0
>                                                                                                                               )
>                                                                                                                               -198630844
>                                                                                                                           )
>                                                                                                                           6
>                                                                                                                       )
>                                                                                                                   )
>                                                                                                                 in
>                                                                                                                   let
>                                                                                                                   (
>                                                                                                                     (
>                                                                                                                       d
>                                                                                                                         step4
>                                                                                                                         (
>                                                                                                                             d
>                                                                                                                             a
>                                                                                                                             b
>                                                                                                                             c
>                                                                                                                             Int32.add
>                                                                                                                             (
>                                                                                                                                 Array.get
>                                                                                                                                 (
>                                                                                                                                     data
>                                                                                                                                     7
>                                                                                                                                 )
>                                                                                                                                 1126891415
>                                                                                                                             )
>                                                                                                                             10
>                                                                                                                         )
>                                                                                                                     )
>                                                                                                                   in
>                                                                                                                     let
>                                                                                                                     (
>                                                                                                                       (
>                                                                                                                         c
>                                                                                                                           step4
>                                                                                                                           (
>                                                                                                                               c
>                                                                                                                               d
>                                                                                                                               a
>                                                                                                                               b
>                                                                                                                               Int32.add
>                                                                                                                               (
>                                                                                                                                   Array.get
>                                                                                                                                   (
>                                                                                                                                       data
>                                                                                                                                       14
>                                                                                                                                   )
>                                                                                                                                   -1416354905
>                                                                                                                               )
>                                                                                                                               15
>                                                                                                                           )
>                                                                                                                       )
>                                                                                                                     in
>                                                                                                                       let
>                                                                                                                       (
>                                                                                                                         (
>                                                                                                                           b
>                                                                                                                             step4
>                                                                                                                             (
>                                                                                                                                 b
>                                                                                                                                 c
>                                                                                                                                 d
>                                                                                                                                 a
>                                                                                                                                 Int32.add
>                                                                                                                                 (
>                                                                                                                                     Array.get
>                                                                                                                                     (
>                                                                                                                                         data
>                                                                                                                                         5
>                                                                                                                                     )
>                                                                                                                                     -57434055
>                                                                                                                                 )
>                                                                                                                                 21
>                                                                                                                             )
>                                                                                                                         )
>                                                                                                                       in
>                                                                                                                         let
>                                                                                                                         (
>                                                                                                                           (
>                                                                                                                             a
>                                                                                                                               step4
>                                                                                                                               (
>                                                                                                                                   a
>                                                                                                                                   b
>                                                                                                                                   c
>                                                                                                                                   d
>                                                                                                                                   Int32.add
>                                                                                                                                   (
>                                                                                                                                       Array.get
>                                                                                                                                       (
>                                                                                                                                           data
>                                                                                                                                           12
>                                                                                                                                       )
>                                                                                                                                       1700485571
>                                                                                                                                   )
>                                                                                                                                   6
>                                                                                                                               )
>                                                                                                                           )
>                                                                                                                         in
>                                                                                                                           let
>                                                                                                                           (
>                                                                                                                             (
>                                                                                                                               d
>                                                                                                                                 step4
>                                                                                                                                 (
>                                                                                                                                     d
>                                                                                                                                     a
>                                                                                                                                     b
>                                                                                                                                     c
>                                                                                                                                     Int32.add
>                                                                                                                                     (
>                                                                                                                                         Array.get
>                                                                                                                                         (
>                                                                                                                                             data
>                                                                                                                                             3
>                                                                                                                                         )
>                                                                                                                                         -1894986606
>                                                                                                                                     )
>                                                                                                                                     10
>                                                                                                                                 )
>                                                                                                                             )
>                                                                                                                           in
>                                                                                                                             let
>                                                                                                                             (
>                                                                                                                               (
>                                                                                                                                 c
>                                                                                                                                   step4
>                                                                                                                                   (
>                                                                                                                                       c
>                                                                                                                                       d
>                                                                                                                                       a
>                                                                                                                                       b
>                                                                                                                                       Int32.add
>                                                                                                                                       (
>                                                                                                                                           Array.get
>                                                                                                                                           (
>                                                                                                                                               data
>                                                                                                                                               10
>                                                                                                                                           )
>                                                                                                                                           -1051523
>                                                                                                                                       )
>                                                                                                                                       15
>                                                                                                                                   )
>                                                                                                                               )
>                                                                                                                             in
>                                                                                                                               let
>                                                                                                                               (
>                                                                                                                                 (
>                                                                                                                                   b
>                                                                                                                                     step4
>                                                                                                                                     (
>                                                                                                                                         b
>                                                                                                                                         c
>                                                                                                                                         d
>                                                                                                                                         a
>                                                                                                                                         Int32.add
>                                                                                                                                         (
>                                                                                                                                             Array.get
>                                                                                                                                             (
>                                                                                                                                                 data
>                                                                                                                                                 1
>                                                                                                                                             )
>                                                                                                                                             -2054922799
>                                                                                                                                         )
>                                                                                                                                         21
>                                                                                                                                     )
>                                                                                                                                 )
>                                                                                                                               in
>                                                                                                                                 let
>                                                                                                                                 (
>                                                                                                                                   (
>                                                                                                                                     a
>                                                                                                                                       step4
>                                                                                                                                       (
>                                                                                                                                           a
>                                                                                                                                           b
>                                                                                                                                           c
>                                                                                                                                           d
>                                                                                                                                           Int32.add
>                                                                                                                                           (
>                                                                                                                                               Array.get
>                                                                                                                                               (
>                                                                                                                                                   data
>                                                                                                                                                   8
>                                                                                                                                               )
>                                                                                                                                               1873313359
>                                                                                                                                           )
>                                                                                                                                           6
>                                                                                                                                       )
>                                                                                                                                   )
>                                                                                                                                 in
>                                                                                                                                   let
>                                                                                                                                   (
>                                                                                                                                     (
>                                                                                                                                       d
>                                                                                                                                         step4
>                                                                                                                                         (
>                                                                                                                                             d
>                                                                                                                                             a
>                                                                                                                                             b
>                                                                                                                                             c
>                                                                                                                                             Int32.add
>                                                                                                                                             (
>                                                                                                                                                 Array.get
>                                                                                                                                                 (
>                                                                                                                                                     data
>                                                                                                                                                     15
>                                                                                                                                                 )
>                                                                                                                                                 -30611744
>                                                                                                                                             )
>                                                                                                                                             10
>                                                                                                                                         )
>                                                                                                                                     )
>                                                                                                                                   in
>                                                                                                                                     let
>                                                                                                                                     (
>                                                                                                                                       (
>                                                                                                                                         c
>                                                                                                                                           step4
>                                                                                                                                           (
>                                                                                                                                               c
>                                                                                                                                               d
>                                                                                                                                               a
>                                                                                                                                               b
>                                                                                                                                               Int32.add
>                                                                                                                                               (
>                                                                                                                                                   Array.get
>                                                                                                                                                   (
>                                                                                                                                                       data
>                                                                                                                                                       6
>                                                                                                                                                   )
>                                                                                                                                                   -1560198380
>                                                                                                                                               )
>                                                                                                                                               15
>                                                                                                                                           )
>                                                                                                                                       )
>                                                                                                                                     in
>                                                                                                                                       let
>                                                                                                                                       (
>                                                                                                                                         (
>                                                                                                                                           b
>                                                                                                                                             step4
>                                                                                                                                             (
>                                                                                                                                                 b
>                                                                                                                                                 c
>                                                                                                                                                 d
>                                                                                                                                                 a
>                                                                                                                                                 Int32.add
>                                                                                                                                                 (
>                                                                                                                                                     Array.get
>                                                                                                                                                     (
>                                                                                                                                                         data
>                                                                                                                                                         13
>                                                                                                                                                     )
>                                                                                                                                                     1309151649
>                                                                                                                                                 )
>                                                                                                                                                 21
>                                                                                                                                             )
>                                                                                                                                         )
>                                                                                                                                       in
>                                                                                                                                         let
>                                                                                                                                         (
>                                                                                                                                           (
>                                                                                                                                             a
>                                                                                                                                               step4
>                                                                                                                                               (
>                                                                                                                                                   a
>                                                                                                                                                   b
>                                                                                                                                                   c
>                                                                                                                                                   d
>                                                                                                                                                   Int32.add
>                                                                                                                                                   (
>                                                                                                                                                       Array.get
>                                                                                                                                                       (
>                                                                                                                                                           data
>                                                                                                                                                           4
>                                                                                                                                                       )
>                                                                                                                                                       -145523070
>                                                                                                                                                   )
>                                                                                                                                                   6
>                                                                                                                                               )
>                                                                                                                                           )
>                                                                                                                                         in
>                                                                                                                                           let
>                                                                                                                                           (
>                                                                                                                                             (
>                                                                                                                                               d
>                                                                                                                                                 step4
>                                                                                                                                                 (
>                                                                                                                                                     d
>                                                                                                                                                     a
>                                                                                                                                                     b
>                                                                                                                                                     c
>                                                                                                                                                     Int32.add
>                                                                                                                                                     (
>                                                                                                                                                         Array.get
>                                                                                                                                                         (
>                                                                                                                                                             data
>                                                                                                                                                             11
>                                                                                                                                                         )
>                                                                                                                                                         -1120210379
>                                                                                                                                                     )
>                                                                                                                                                     10
>                                                                                                                                                 )
>                                                                                                                                             )
>                                                                                                                                           in
>                                                                                                                                             let
>                                                                                                                                             (
>                                                                                                                                               (
>                                                                                                                                                 c
>                                                                                                                                                   step4
>                                                                                                                                                   (
>                                                                                                                                                       c
>                                                                                                                                                       d
>                                                                                                                                                       a
>                                                                                                                                                       b
>                                                                                                                                                       Int32.add
>                                                                                                                                                       (
>                                                                                                                                                           Array.get
>                                                                                                                                                           (
>                                                                                                                                                               data
>                                                                                                                                                               2
>                                                                                                                                                           )
>                                                                                                                                                           718787259
>                                                                                                                                                       )
>                                                                                                                                                       15
>                                                                                                                                                   )
>                                                                                                                                               )
>                                                                                                                                             in
>                                                                                                                                               let
>                                                                                                                                               (
>                                                                                                                                                 (
>                                                                                                                                                   b
>                                                                                                                                                     step4
>                                                                                                                                                     (
>                                                                                                                                                         b
>                                                                                                                                                         c
>                                                                                                                                                         d
>                                                                                                                                                         a
>                                                                                                                                                         Int32.add
>                                                                                                                                                         (
>                                                                                                                                                             Array.get
>                                                                                                                                                             (
>                                                                                                                                                                 data
>                                                                                                                                                                 9
>                                                                                                                                                             )
>                                                                                                                                                             -343485551
>                                                                                                                                                         )
>                                                                                                                                                         21
>                                                                                                                                                     )
>                                                                                                                                                 )
>                                                                                                                                               in
>                                                                                                                                                 sequence
>                                                                                                                                                 (
>                                                                                                                                                   setfield
>                                                                                                                                                   (
>                                                                                                                                                   ctx
>                                                                                                                                                   a
>                                                                                                                                                   Int32.add
>                                                                                                                                                   (
>                                                                                                                                                       field
>                                                                                                                                                       (
>                                                                                                                                                       ctx
>                                                                                                                                                       a
>                                                                                                                                                       )
>                                                                                                                                                       a
>                                                                                                                                                   )
>                                                                                                                                                   )
>                                                                                                                                                 ;
>                                                                                                                                                   sequence
>                                                                                                                                                   (
>                                                                                                                                                     setfield
>                                                                                                                                                     (
>                                                                                                                                                     ctx
>                                                                                                                                                     b
>                                                                                                                                                     Int32.add
>                                                                                                                                                     (
>                                                                                                                                                         field
>                                                                                                                                                         (
>                                                                                                                                                         ctx
>                                                                                                                                                         b
>                                                                                                                                                         )
>                                                                                                                                                         b
>                                                                                                                                                     )
>                                                                                                                                                     )
>                                                                                                                                                   ;
>                                                                                                                                                     sequence
>                                                                                                                                                     (
>                                                                                                                                                       setfield
>                                                                                                                                                       (
>                                                                                                                                                       ctx
>                                                                                                                                                       c
>                                                                                                                                                       Int32.add
>                                                                                                                                                       (
>                                                                                                                                                           field
>                                                                                                                                                           (
>                                                                                                                                                           ctx
>                                                                                                                                                           c
>                                                                                                                                                           )
>                                                                                                                                                           c
>                                                                                                                                                       )
>                                                                                                                                                       )
>                                                                                                                                                     ;
>                                                                                                                                                       setfield
>                                                                                                                                                       (
>                                                                                                                                                       ctx
>                                                                                                                                                       d
>                                                                                                                                                       Int32.add
>                                                                                                                                                       (
>                                                                                                                                                           field
>                                                                                                                                                           (
>                                                                                                                                                           ctx
>                                                                                                                                                           d
>                                                                                                                                                           )
>                                                                                                                                                           d
>                                                                                                                                                       )
>                                                                                                                                                       )
>                                                                                                                                                     )
>                                                                                                                                                   )
>                                                                                                                                                 )
>                                                                                                                                               )
>                                                                                                                                             )
>                                                                                                                                           )
>                                                                                                                                         )
>                                                                                                                                       )
>                                                                                                                                     )
>                                                                                                                                   )
>                                                                                                                                 )
>                                                                                                                               )
>                                                                                                                             )
>                                                                                                                           )
>                                                                                                                         )
>                                                                                                                       )
>                                                                                                                     )
>                                                                                                                   )
>                                                                                                                 )
>                                                                                                               )
>                                                                                                             )
>                                                                                                           )
>                                                                                                         )
>                                                                                                       )
>                                                                                                     )
>                                                                                                   )
>                                                                                                 )
>                                                                                               )
>                                                                                             )
>                                                                                           )
>                                                                                         )
>                                                                                       )
>                                                                                     )
>                                                                                   )
>                                                                                 )
>                                                                               )
>                                                                             )
>                                                                           )
>                                                                         )
>                                                                       )
>                                                                     )
>                                                                   )
>                                                                 )
>                                                               )
>                                                             )
>                                                           )
>                                                         )
>                                                       )
>                                                     )
>                                                   )
>                                                 )
>                                               )
>                                             )
>                                           )
>                                         )
>                                       )
>                                     )
>                                   )
>                                 )
>                               )
>                             )
>                           )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     string_to_data
>       (
>         case
>         (
>           s
>           let
>           (
>             (
>               data
>                 Array.make
>                 (
>                     16
>                     0
>                 )
>             )
>           in
>             sequence
>             (
>               for i
>               0
>               15
>               let
>               (
>                 (
>                   j
>                     lsl
>                     (
>                         i
>                         2
>                     )
>                 )
>               in
>                 Array.set
>                 (
>                     data
>                     i
>                     Int32.logor
>                     (
>                         Int32.shift_left
>                         (
>                             Int32.of_int
>                             (
>                                 Char.code
>                                 (
>                                     String.get
>                                     (
>                                         s
>                                         +
>                                         (
>                                             j
>                                             3
>                                         )
>                                     )
>                                 )
>                             )
>                             24
>                         )
>                         Int32.logor
>                         (
>                             Int32.shift_left
>                             (
>                                 Int32.of_int
>                                 (
>                                     Char.code
>                                     (
>                                         String.get
>                                         (
>                                             s
>                                             +
>                                             (
>                                                 j
>                                                 2
>                                             )
>                                         )
>                                     )
>                                 )
>                                 16
>                             )
>                             Int32.logor
>                             (
>                                 Int32.shift_left
>                                 (
>                                     Int32.of_int
>                                     (
>                                         Char.code
>                                         (
>                                             String.get
>                                             (
>                                                 s
>                                                 +
>                                                 (
>                                                     j
>                                                     1
>                                                 )
>                                             )
>                                         )
>                                     )
>                                     8
>                                 )
>                                 Int32.of_int
>                                 (
>                                     Char.code
>                                     (
>                                         String.get
>                                         (
>                                             s
>                                             j
>                                         )
>                                     )
>                                 )
>                             )
>                         )
>                     )
>                 )
>               )
>             ;
>               data
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     int32_to_string
>       (
>         case
>         (
>           n
>           (
>             case
>             (
>               s
>               (
>                 case
>                 (
>                   i
>                   sequence
>                   (
>                     String.set
>                     (
>                         s
>                         +
>                         (
>                             i
>                             3
>                         )
>                         Char.chr
>                         (
>                             land
>                             (
>                                 Int32.to_int
>                                 (
>                                     Int32.shift_right
>                                     (
>                                         n
>                                         24
>                                     )
>                                 )
>                                 255
>                             )
>                         )
>                     )
>                   ;
>                     sequence
>                     (
>                       String.set
>                       (
>                           s
>                           +
>                           (
>                               i
>                               2
>                           )
>                           Char.chr
>                           (
>                               land
>                               (
>                                   Int32.to_int
>                                   (
>                                       Int32.shift_right
>                                       (
>                                           n
>                                           16
>                                       )
>                                   )
>                                   255
>                               )
>                           )
>                       )
>                     ;
>                       sequence
>                       (
>                         String.set
>                         (
>                             s
>                             +
>                             (
>                                 i
>                                 1
>                             )
>                             Char.chr
>                             (
>                                 land
>                                 (
>                                     Int32.to_int
>                                     (
>                                         Int32.shift_right
>                                         (
>                                             n
>                                             8
>                                         )
>                                     )
>                                     255
>                                 )
>                             )
>                         )
>                       ;
>                         String.set
>                         (
>                             s
>                             i
>                             Char.chr
>                             (
>                                 land
>                                 (
>                                     Int32.to_int
>                                     (
>                                         n
>                                     )
>                                     255
>                                 )
>                             )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     init
>       (
>         case
>         (
>           ()
>                     record
>           (
>             buf
>               String.create
>               (
>                   64
>               )
>             pos
>               0
>             a
>               1732584193
>             b
>               -271733879
>             c
>               -1732584194
>             d
>               271733878
>             bits
>               0
>           )
>                   )
>       )
>   )
>   let
>   (
>     update
>       (
>         case
>         (
>           ctx
>           (
>             case
>             (
>               input
>               (
>                 case
>                 (
>                   ofs
>                   (
>                     case
>                     (
>                       len
>                       let
>                       (
>                         (
>                           upd
>                             (
>                               case
>                               (
>                                 ofs
>                                 (
>                                   case
>                                   (
>                                     len
>                                     ifthenelse
>                                     (
>                                       if
>                                       (
>                                         <=
>                                         (
>                                             len
>                                             0
>                                         )
>                                       )
>                                       then
>                                       (
>                                         ()
>                                                                               )
>                                       else
>                                       (
>                                           ifthenelse
>                                           (
>                                             if
>                                             (
>                                               <
>                                               (
>                                                   +
>                                                   (
>                                                       field
>                                                       (
>                                                       ctx
>                                                       pos
>                                                       )
>                                                       len
>                                                   )
>                                                   64
>                                               )
>                                             )
>                                             then
>                                             (
>                                               sequence
>                                               (
>                                                 String.blit
>                                                 (
>                                                     input
>                                                     ofs
>                                                     field
>                                                     (
>                                                     ctx
>                                                     buf
>                                                     )
>                                                     field
>                                                     (
>                                                     ctx
>                                                     pos
>                                                     )
>                                                     len
>                                                 )
>                                               ;
>                                                 setfield
>                                                 (
>                                                 ctx
>                                                 pos
>                                                 +
>                                                 (
>                                                     field
>                                                     (
>                                                     ctx
>                                                     pos
>                                                     )
>                                                     len
>                                                 )
>                                                 )
>                                               )
>                                             )
>                                             else
>                                             (
>                                                 let
>                                                 (
>                                                   (
>                                                     len'
>                                                       -
>                                                       (
>                                                           64
>                                                           field
>                                                           (
>                                                           ctx
>                                                           pos
>                                                           )
>                                                       )
>                                                   )
>                                                 in
>                                                   sequence
>                                                   (
>                                                     ifthenelse
>                                                     (
>                                                       if
>                                                       (
>                                                         >
>                                                         (
>                                                             len'
>                                                             0
>                                                         )
>                                                       )
>                                                       then
>                                                       (
>                                                         String.blit
>                                                         (
>                                                             input
>                                                             ofs
>                                                             field
>                                                             (
>                                                             ctx
>                                                             buf
>                                                             )
>                                                             field
>                                                             (
>                                                             ctx
>                                                             pos
>                                                             )
>                                                             len'
>                                                         )
>                                                       )
>                                                       else
>                                                       (
>                                                                                                               )
>                                                     )
>                                                   ;
>                                                     sequence
>                                                     (
>                                                       transform
>                                                       (
>                                                           ctx
>                                                           string_to_data
>                                                           (
>                                                               field
>                                                               (
>                                                               ctx
>                                                               buf
>                                                               )
>                                                           )
>                                                       )
>                                                     ;
>                                                       sequence
>                                                       (
>                                                         setfield
>                                                         (
>                                                         ctx
>                                                         pos
>                                                         0
>                                                         )
>                                                       ;
>                                                         upd
>                                                         (
>                                                             +
>                                                             (
>                                                                 ofs
>                                                                 len'
>                                                             )
>                                                             -
>                                                             (
>                                                                 len
>                                                                 len'
>                                                             )
>                                                         )
>                                                       )
>                                                     )
>                                                   )
>                                                 )
>                                             )
>                                           )
>                                       )
>                                     )
>                                   )
>                                 )
>                               )
>                             )
>                         )
>                       in
>                         sequence
>                         (
>                           upd
>                           (
>                               ofs
>                               len
>                           )
>                         ;
>                           setfield
>                           (
>                           ctx
>                           bits
>                           Int64.add
>                           (
>                               field
>                               (
>                               ctx
>                               bits
>                               )
>                               Int64.of_int
>                               (
>                                   lsl
>                                   (
>                                       len
>                                       3
>                                   )
>                               )
>                           )
>                           )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     finish
>       (
>         case
>         (
>           ctx
>           let
>           (
>             (
>               padding
>                 String.make
>                 (
>                     64
>                     00
>                 )
>             )
>           in
>             sequence
>             (
>               String.set
>               (
>                   padding
>                   0
>                   80
>               )
>             ;
>               let
>               (
>                 (
>                   numbits
>                     field
>                     (
>                     ctx
>                     bits
>                     )
>                 )
>               in
>                 sequence
>                 (
>                   ifthenelse
>                   (
>                     if
>                     (
>                       <
>                       (
>                           field
>                           (
>                           ctx
>                           pos
>                           )
>                           56
>                       )
>                     )
>                     then
>                     (
>                       update
>                       (
>                           ctx
>                           padding
>                           0
>                           -
>                           (
>                               56
>                               field
>                               (
>                               ctx
>                               pos
>                               )
>                           )
>                       )
>                     )
>                     else
>                     (
>                         update
>                         (
>                             ctx
>                             padding
>                             0
>                             -
>                             (
>                                 +
>                                 (
>                                     64
>                                     56
>                                 )
>                                 field
>                                 (
>                                 ctx
>                                 pos
>                                 )
>                             )
>                         )
>                     )
>                   )
>                 ;
>                   sequence
>                   (
>                     assert                    =
>                     (
>                         field
>                         (
>                         ctx
>                         pos
>                         )
>                         56
>                     )
>                   ;
>                     let
>                     (
>                       (
>                         data
>                           string_to_data
>                           (
>                               field
>                               (
>                               ctx
>                               buf
>                               )
>                           )
>                       )
>                     in
>                       sequence
>                       (
>                         Array.set
>                         (
>                             data
>                             14
>                             Int64.to_int32
>                             (
>                                 numbits
>                             )
>                         )
>                       ;
>                         sequence
>                         (
>                           Array.set
>                           (
>                               data
>                               15
>                               Int64.to_int32
>                               (
>                                   Int64.shift_right_logical
>                                   (
>                                       numbits
>                                       32
>                                   )
>                               )
>                           )
>                         ;
>                           sequence
>                           (
>                             transform
>                             (
>                                 ctx
>                                 data
>                             )
>                           ;
>                             let
>                             (
>                               (
>                                 res
>                                   String.create
>                                   (
>                                       16
>                                   )
>                               )
>                             in
>                               sequence
>                               (
>                                 int32_to_string
>                                 (
>                                     field
>                                     (
>                                     ctx
>                                     a
>                                     )
>                                     res
>                                     0
>                                 )
>                               ;
>                                 sequence
>                                 (
>                                   int32_to_string
>                                   (
>                                       field
>                                       (
>                                       ctx
>                                       b
>                                       )
>                                       res
>                                       4
>                                   )
>                                 ;
>                                   sequence
>                                   (
>                                     int32_to_string
>                                     (
>                                         field
>                                         (
>                                         ctx
>                                         c
>                                         )
>                                         res
>                                         8
>                                     )
>                                   ;
>                                     sequence
>                                     (
>                                       int32_to_string
>                                       (
>                                           field
>                                           (
>                                           ctx
>                                           d
>                                           )
>                                           res
>                                           12
>                                       )
>                                     ;
>                                       res
>                                     )
>                                   )
>                                 )
>                               )
>                             )
>                           )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     test
>       (
>         case
>         (
>           s
>           let
>           (
>             (
>               ctx
>                 init
>                 (
>                     ()
>                                     )
>             )
>           in
>             sequence
>             (
>               update
>               (
>                   ctx
>                   s
>                   0
>                   String.length
>                   (
>                       s
>                   )
>               )
>             ;
>               let
>               (
>                 (
>                   res
>                     finish
>                     (
>                         ctx
>                     )
>                 )
>               in
>                 let
>                 (
>                   (
>                     exp
>                       Digest.string
>                       (
>                           s
>                       )
>                   )
>                 in
>                   let
>                   (
>                     (
>                       ok
>                         =
>                         (
>                             res
>                             exp
>                         )
>                     )
>                   in
>                     sequence
>                     (
>                       ifthenelse
>                       (
>                         if
>                         (
>                           not
>                           (
>                               ok
>                           )
>                         )
>                         then
>                         (
>                           Printf.printf
>                           (
>                               "Failure for '%s'\n"
>                               s
>                           )
>                         )
>                         else
>                         (
>                                                   )
>                       )
>                     ;
>                       ok
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   let
>   (
>     time
>       (
>         case
>         (
>           msg
>           (
>             case
>             (
>               iter
>               (
>                 case
>                 (
>                   fn
>                   let
>                   (
>                     (
>                       start
>                         Sys.time
>                         (
>                             ()
>                                                     )
>                     )
>                   in
>                     sequence
>                     (
>                       for i
>                       1
>                       iter
>                       fn
>                       (
>                           ()
>                                                 )
>                     ;
>                       let
>                       (
>                         (
>                           stop
>                             Sys.time
>                             (
>                                 ()
>                                                             )
>                         )
>                       in
>                         printf
>                         (
>                             "%s: %.2f s\n"
>                             msg
>                             -.
>                             (
>                                 stop
>                                 start
>                             )
>                         )
>                       )
>                     )
>                   )
>                 )
>               )
>             )
>           )
>         )
>       )
>   )
>   sequence
>   (
>     ifthenelse
>     (
>       if
>       (
>         &&
>         (
>             test
>             (
>                 ""
>             )
>             &&
>             (
>                 test
>                 (
>                     "a"
>                 )
>                 &&
>                 (
>                     test
>                     (
>                         "abc"
>                     )
>                     &&
>                     (
>                         test
>                         (
>                             "message digest"
>                         )
>                         test
>                         (
>                             "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
>                         )
>                     )
>                 )
>             )
>         )
>       )
>       then
>       (
>         printf
>         (
>             "Test vectors passed.\n"
>         )
>       )
>       else
>       (
>               )
>     )
>   ;
>     sequence
>     (
>       flush
>       (
>           stdout
>       )
>     ;
>       ifthenelse
>       (
>         if
>         (
>           &&
>           (
>               >
>               (
>                   Array.length
>                   (
>                       Sys.argv
>                   )
>                   1
>               )
>               =
>               (
>                   Array.get
>                   (
>                       Sys.argv
>                       1
>                   )
>                   "-benchmark"
>               )
>           )
>         )
>         then
>         (
>           let
>           (
>             (
>               s
>                 String.make
>                 (
>                     50000
>                     61
>                 )
>             )
>           in
>             let
>             (
>               (
>                 num_iter
>                   1000
>               )
>             in
>               sequence
>               (
>                 time
>                 (
>                     "OCaml implementation"
>                     num_iter
>                     (
>                       case
>                       (
>                         ()
>                                                 let
>                         (
>                           (
>                             ctx
>                               init
>                               (
>                                   ()
>                                                                 )
>                           )
>                         in
>                           sequence
>                           (
>                             update
>                             (
>                                 ctx
>                                 s
>                                 0
>                                 String.length
>                                 (
>                                     s
>                                 )
>                             )
>                           ;
>                             ignore
>                             (
>                                 finish
>                                 (
>                                     ctx
>                                 )
>                             )
>                           )
>                         )
>                       )
>                     )
>                 )
>               ;
>                 time
>                 (
>                     "C implementation"
>                     num_iter
>                     (
>                       case
>                       (
>                         ()
>                                                 ignore
>                         (
>                             Digest.string
>                             (
>                                 s
>                             )
>                         )
>                       )
>                     )
>                 )
>               )
>             )
>           )
>         )
>         else
>         (
>                   )
>       )
>     )
>   )
> )
