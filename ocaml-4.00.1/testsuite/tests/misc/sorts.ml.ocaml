(
  open Printf
  let
  (
    exp2
      (
        case
        (
          n
          ifthenelse
          (
            if
            (
              <=
              (
                
                  n
                
                  0
              )
            )
            then
            (
              1
            )
            else
            (
                *
                (
                  
                    2
                  
                    exp2
                    (
                      
                        -
                        (
                          
                            n
                          
                            1
                        )
                    )
                )
            )
          )
        )
      )
  )
  let
  (
    id
      (
        case
        (
          x
          x
        )
      )
  )
  let
  (
    postl
      (
        case
        (
          x
          (
            case
            (
              y
              Array.of_list
              (
                
                  y
              )
            )
          )
        )
      )
  )
  let
  (
    posta
      (
        case
        (
          x
          (
            case
            (
              y
              x
            )
          )
        )
      )
  )
  let
  (
    mkconst
      (
        case
        (
          n
          Array.make
          (
            
              n
            
              0
          )
        )
      )
  )
  let
  (
    chkconst
      (
        case
        (
          _
          (
            case
            (
              n
              (
                case
                (
                  a
                  =
                  (
                    
                      a
                    
                      mkconst
                      (
                        
                          n
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    mksorted
      (
        case
        (
          n
          let
          (
            (
              a
                Array.make
                (
                  
                    n
                  
                    0
                )
            )
          in
            sequence
            (
              for i
              0
              -
              (
                
                  n
                
                  1
              )
              Array.set
              (
                
                  a
                
                  i
                
                  i
              )
            ;
              a
            )
          )
        )
      )
  )
  let
  (
    chksorted
      (
        case
        (
          _
          (
            case
            (
              n
              (
                case
                (
                  a
                  =
                  (
                    
                      a
                    
                      mksorted
                      (
                        
                          n
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    mkrev
      (
        case
        (
          n
          let
          (
            (
              a
                Array.make
                (
                  
                    n
                  
                    0
                )
            )
          in
            sequence
            (
              for i
              0
              -
              (
                
                  n
                
                  1
              )
              Array.set
              (
                
                  a
                
                  i
                
                  -
                  (
                    
                      -
                      (
                        
                          n
                        
                          1
                      )
                    
                      i
                  )
              )
            ;
              a
            )
          )
        )
      )
  )
  let
  (
    chkrev
      (
        case
        (
          _
          (
            case
            (
              n
              (
                case
                (
                  a
                  =
                  (
                    
                      a
                    
                      mksorted
                      (
                        
                          n
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    seed
      ref
      (
        
          0
      )
  )
  let
  (
    random_reinit
      (
        case
        (
          ()
                    Random.init
          (
            
              !
              (
                
                  seed
              )
          )
        )
      )
  )
  let
  (
    random_get_state
      (
        case
        (
          ()
                    let
          (
            (
              a
                Array.make
                (
                  
                    55
                  
                    0
                )
            )
          in
            sequence
            (
              for i
              0
              54
              Array.set
              (
                
                  a
                
                  i
                
                  Random.bits
                  (
                    
                      ()
                                        )
              )
            ;
              sequence
              (
                Random.full_init
                (
                  
                    a
                )
              ;
                a
              )
            )
          )
        )
      )
  )
  let
  (
    random_set_state
      (
        case
        (
          a
          Random.full_init
          (
            
              a
          )
        )
      )
  )
  let
  (
    chkgen
      (
        case
        (
          mke
          (
            case
            (
              cmp
              (
                case
                (
                  rstate
                  (
                    case
                    (
                      n
                      (
                        case
                        (
                          a
                          let
                          (
                            (
                              marks
                                Array.make
                                (
                                  
                                    n
                                  
                                    -1
                                )
                            )
                          in
                            let
                            (
                              (
                                skipmarks
                                  (
                                    case
                                    (
                                      l
                                      ifthenelse
                                      (
                                        if
                                        (
                                          =
                                          (
                                            
                                              Array.get
                                              (
                                                
                                                  marks
                                                
                                                  l
                                              )
                                            
                                              -1
                                          )
                                        )
                                        then
                                        (
                                          l
                                        )
                                        else
                                        (
                                            let
                                            (
                                              (
                                                m
                                                  ref
                                                  (
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          marks
                                                        
                                                          l
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                while
                                                <>
                                                (
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        marks
                                                      
                                                        !
                                                        (
                                                          
                                                            m
                                                        )
                                                    )
                                                  
                                                    -1
                                                )
                                                incr
                                                (
                                                  
                                                    m
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      marks
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          m
                                                      )
                                                  )
                                                ;
                                                  !
                                                  (
                                                    
                                                      m
                                                  )
                                                )
                                              )
                                            )
                                        )
                                      )
                                    )
                                  )
                              )
                            in
                              let
                              (
                                (
                                  linear
                                    (
                                      case
                                      (
                                        e
                                        (
                                          case
                                          (
                                            l
                                            let
                                            (
                                              (
                                                l
                                                  skipmarks
                                                  (
                                                    
                                                      l
                                                  )
                                              )
                                            in
                                              let
                                              (
                                                (
                                                  loop
                                                    (
                                                      case
                                                      (
                                                        l
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            >
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    Array.get
                                                                    (
                                                                      
                                                                        a
                                                                      
                                                                        l
                                                                    )
                                                                  
                                                                    e
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            raise
                                                            (
                                                              
                                                                Exit
                                                                                                                            )
                                                          )
                                                          else
                                                          (
                                                              ifthenelse
                                                              (
                                                                if
                                                                (
                                                                  =
                                                                  (
                                                                    
                                                                      e
                                                                    
                                                                      Array.get
                                                                      (
                                                                        
                                                                          a
                                                                        
                                                                          l
                                                                      )
                                                                  )
                                                                )
                                                                then
                                                                (
                                                                  Array.set
                                                                  (
                                                                    
                                                                      marks
                                                                    
                                                                      l
                                                                    
                                                                      +
                                                                      (
                                                                        
                                                                          l
                                                                        
                                                                          1
                                                                      )
                                                                  )
                                                                )
                                                                else
                                                                (
                                                                    loop
                                                                    (
                                                                      
                                                                        +
                                                                        (
                                                                          
                                                                            l
                                                                          
                                                                            1
                                                                        )
                                                                    )
                                                                )
                                                              )
                                                          )
                                                        )
                                                      )
                                                    )
                                                )
                                              in
                                                loop
                                                (
                                                  
                                                    l
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    dicho
                                      (
                                        case
                                        (
                                          e
                                          (
                                            case
                                            (
                                              l
                                              (
                                                case
                                                (
                                                  r
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      =
                                                      (
                                                        
                                                          l
                                                        
                                                          r
                                                      )
                                                    )
                                                    then
                                                    (
                                                      linear
                                                      (
                                                        
                                                          e
                                                        
                                                          l
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          assert                                                          <
                                                          (
                                                            
                                                              l
                                                            
                                                              r
                                                          )
                                                          
                                                        ;
                                                          let
                                                          (
                                                            (
                                                              m
                                                                /
                                                                (
                                                                  
                                                                    +
                                                                    (
                                                                      
                                                                        l
                                                                      
                                                                        r
                                                                    )
                                                                  
                                                                    2
                                                                )
                                                            )
                                                          in
                                                            ifthenelse
                                                            (
                                                              if
                                                              (
                                                                >=
                                                                (
                                                                  
                                                                    cmp
                                                                    (
                                                                      
                                                                        Array.get
                                                                        (
                                                                          
                                                                            a
                                                                          
                                                                            m
                                                                        )
                                                                      
                                                                        e
                                                                    )
                                                                  
                                                                    0
                                                                )
                                                              )
                                                              then
                                                              (
                                                                dicho
                                                                (
                                                                  
                                                                    e
                                                                  
                                                                    l
                                                                  
                                                                    m
                                                                )
                                                              )
                                                              else
                                                              (
                                                                  dicho
                                                                  (
                                                                    
                                                                      e
                                                                    
                                                                      +
                                                                      (
                                                                        
                                                                          m
                                                                        
                                                                          1
                                                                      )
                                                                    
                                                                      r
                                                                  )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                  )
                                in
                                  try
                                  sequence
                                  (
                                    for i
                                    0
                                    -
                                    (
                                      
                                        n
                                      
                                        2
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    i
                                                )
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    +
                                                    (
                                                      
                                                        i
                                                      
                                                        1
                                                    )
                                                )
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        raise
                                        (
                                          
                                            Exit
                                                                                    )
                                      )
                                      else
                                      (
                                                                              )
                                    )
                                  ;
                                    sequence
                                    (
                                      random_set_state
                                      (
                                        
                                          rstate
                                      )
                                    ;
                                      sequence
                                      (
                                        for i
                                        0
                                        -
                                        (
                                          
                                            n
                                          
                                            1
                                        )
                                        dicho
                                        (
                                          
                                            mke
                                            (
                                              
                                                i
                                            )
                                          
                                            0
                                          
                                            -
                                            (
                                              
                                                Array.length
                                                (
                                                  
                                                    a
                                                )
                                              
                                                1
                                            )
                                        )
                                      ;
                                        true
                                                                              )
                                    )
                                  )
                                  (
                                    case
                                    (
                                      pat_or
                                      (
                                      Exit
                                                                            Invalid_argument
                                        _
                                      )
                                      false
                                                                          )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    mkrand_dup
      (
        case
        (
          n
          let
          (
            (
              a
                Array.make
                (
                  
                    n
                  
                    0
                )
            )
          in
            sequence
            (
              for i
              0
              -
              (
                
                  n
                
                  1
              )
              Array.set
              (
                
                  a
                
                  i
                
                  Random.int
                  (
                    
                      n
                  )
              )
            ;
              a
            )
          )
        )
      )
  )
  let
  (
    chkrand_dup
      (
        case
        (
          rstate
          (
            case
            (
              n
              (
                case
                (
                  a
                  chkgen
                  (
                    
                      (
                        case
                        (
                          i
                          Random.int
                          (
                            
                              n
                          )
                        )
                      )
                    
                      compare
                    
                      rstate
                    
                      n
                    
                      a
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    mkrand_nodup
      (
        case
        (
          n
          let
          (
            (
              a
                Array.make
                (
                  
                    n
                  
                    0
                )
            )
          in
            sequence
            (
              for i
              0
              -
              (
                
                  n
                
                  1
              )
              Array.set
              (
                
                  a
                
                  i
                
                  Random.bits
                  (
                    
                      ()
                                        )
              )
            ;
              a
            )
          )
        )
      )
  )
  let
  (
    chkrand_nodup
      (
        case
        (
          rstate
          (
            case
            (
              n
              (
                case
                (
                  a
                  chkgen
                  (
                    
                      (
                        case
                        (
                          i
                          Random.bits
                          (
                            
                              ()
                                                        )
                        )
                      )
                    
                      compare
                    
                      rstate
                    
                      n
                    
                      a
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    mkfloats
      (
        case
        (
          n
          let
          (
            (
              a
                Array.make
                (
                  
                    n
                  
                    0.0
                )
            )
          in
            sequence
            (
              for i
              0
              -
              (
                
                  n
                
                  1
              )
              Array.set
              (
                
                  a
                
                  i
                
                  Random.float
                  (
                    
                      1.0
                  )
              )
            ;
              a
            )
          )
        )
      )
  )
  let
  (
    chkfloats
      (
        case
        (
          rstate
          (
            case
            (
              n
              (
                case
                (
                  a
                  chkgen
                  (
                    
                      (
                        case
                        (
                          i
                          Random.float
                          (
                            
                              1.0
                          )
                        )
                      )
                    
                      compare
                    
                      rstate
                    
                      n
                    
                      a
                  )
                )
              )
            )
          )
        )
      )
  )
  type
  (
    record
      type
        params =
          (
          )
        cstrs =
          (
          )
        kind =
            (
              s1
                  poly
                  
                     string
                    (
                    )
              s2
                  poly
                  
                     string
                    (
                    )
              i1
                  poly
                  
                     int
                    (
                    )
              i2
                  poly
                  
                     int
                    (
                    )
            )
            )
  let
  (
    rand_string
      (
        case
        (
          ()
                    let
          (
            (
              len
                Random.int
                (
                  
                    10
                )
            )
          in
            let
            (
              (
                s
                  String.create
                  (
                    
                      len
                  )
              )
            in
              sequence
              (
                for i
                0
                -
                (
                  
                    len
                  
                    1
                )
                String.set
                (
                  
                    s
                  
                    i
                  
                    Char.chr
                    (
                      
                        Random.int
                        (
                          
                            256
                        )
                    )
                )
              ;
                s
              )
            )
          )
        )
      )
  )
  let
  (
    mkrec1
      (
        case
        (
          b
          (
            case
            (
              i
              record
              (
                s1
                  rand_string
                  (
                    
                      ()
                                        )
                s2
                  rand_string
                  (
                    
                      ()
                                        )
                i1
                  Random.int
                  (
                    
                      b
                  )
                i2
                  i
              )
                          )
          )
        )
      )
  )
  let
  (
    mkrecs
      (
        case
        (
          b
          (
            case
            (
              n
              Array.init
              (
                
                  n
                
                  mkrec1
                  (
                    
                      b
                  )
              )
            )
          )
        )
      )
  )
  let
  (
    mkrec1_rev
      (
        case
        (
          b
          (
            case
            (
              i
              record
              (
                s1
                  rand_string
                  (
                    
                      ()
                                        )
                s2
                  rand_string
                  (
                    
                      ()
                                        )
                i1
                  ~-
                  (
                    
                      i
                  )
                i2
                  i
              )
                          )
          )
        )
      )
  )
  let
  (
    mkrecs_rev
      (
        case
        (
          n
          Array.init
          (
            
              n
            
              mkrec1_rev
              (
                
                  0
              )
          )
        )
      )
  )
  let
  (
    cmpstr
      (
        case
        (
          r1
          (
            case
            (
              r2
              let
              (
                (
                  c1
                    compare
                    (
                      
                        field
                        (
                        r1
                        s1
                        )
                      
                        field
                        (
                        r2
                        s1
                        )
                    )
                )
              in
                ifthenelse
                (
                  if
                  (
                    =
                    (
                      
                        c1
                      
                        0
                    )
                  )
                  then
                  (
                    compare
                    (
                      
                        field
                        (
                        r1
                        s2
                        )
                      
                        field
                        (
                        r2
                        s2
                        )
                    )
                  )
                  else
                  (
                      c1
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lestr
      (
        case
        (
          r1
          (
            case
            (
              r2
              let
              (
                (
                  c1
                    compare
                    (
                      
                        field
                        (
                        r1
                        s1
                        )
                      
                        field
                        (
                        r2
                        s1
                        )
                    )
                )
              in
                ifthenelse
                (
                  if
                  (
                    =
                    (
                      
                        c1
                      
                        0
                    )
                  )
                  then
                  (
                    <=
                    (
                      
                        field
                        (
                        r1
                        s2
                        )
                      
                        field
                        (
                        r2
                        s2
                        )
                    )
                  )
                  else
                  (
                      <
                      (
                        
                          c1
                        
                          0
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    chkstr
      (
        case
        (
          b
          (
            case
            (
              rstate
              (
                case
                (
                  n
                  (
                    case
                    (
                      a
                      chkgen
                      (
                        
                          mkrec1
                          (
                            
                              b
                          )
                        
                          cmpstr
                        
                          rstate
                        
                          n
                        
                          a
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cmpint
      (
        case
        (
          r1
          (
            case
            (
              r2
              compare
              (
                
                  field
                  (
                  r1
                  i1
                  )
                
                  field
                  (
                  r2
                  i1
                  )
              )
            )
          )
        )
      )
  )
  let
  (
    leint
      (
        case
        (
          r1
          (
            case
            (
              r2
              <=
              (
                
                  field
                  (
                  r1
                  i1
                  )
                
                  field
                  (
                  r2
                  i1
                  )
              )
            )
          )
        )
      )
  )
  let
  (
    chkint
      (
        case
        (
          b
          (
            case
            (
              rstate
              (
                case
                (
                  n
                  (
                    case
                    (
                      a
                      chkgen
                      (
                        
                          mkrec1
                          (
                            
                              b
                          )
                        
                          cmpint
                        
                          rstate
                        
                          n
                        
                          a
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cmplex
      (
        case
        (
          r1
          (
            case
            (
              r2
              let
              (
                (
                  c1
                    compare
                    (
                      
                        field
                        (
                        r1
                        i1
                        )
                      
                        field
                        (
                        r2
                        i1
                        )
                    )
                )
              in
                ifthenelse
                (
                  if
                  (
                    =
                    (
                      
                        c1
                      
                        0
                    )
                  )
                  then
                  (
                    compare
                    (
                      
                        field
                        (
                        r1
                        i2
                        )
                      
                        field
                        (
                        r2
                        i2
                        )
                    )
                  )
                  else
                  (
                      c1
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lelex
      (
        case
        (
          r1
          (
            case
            (
              r2
              let
              (
                (
                  c1
                    compare
                    (
                      
                        field
                        (
                        r1
                        i1
                        )
                      
                        field
                        (
                        r2
                        i1
                        )
                    )
                )
              in
                ifthenelse
                (
                  if
                  (
                    =
                    (
                      
                        c1
                      
                        0
                    )
                  )
                  then
                  (
                    <=
                    (
                      
                        field
                        (
                        r1
                        i2
                        )
                      
                        field
                        (
                        r2
                        i2
                        )
                    )
                  )
                  else
                  (
                      <
                      (
                        
                          c1
                        
                          0
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    chklex
      (
        case
        (
          b
          (
            case
            (
              rstate
              (
                case
                (
                  n
                  (
                    case
                    (
                      a
                      chkgen
                      (
                        
                          mkrec1
                          (
                            
                              b
                          )
                        
                          cmplex
                        
                          rstate
                        
                          n
                        
                          a
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lens
      ::
        (
          0
          ::
            (
              1
              ::
                (
                  2
                  ::
                    (
                      3
                      ::
                        (
                          4
                          ::
                            (
                              5
                              ::
                                (
                                  6
                                  ::
                                    (
                                      7
                                      ::
                                        (
                                          8
                                          ::
                                            (
                                              9
                                              ::
                                                (
                                                  10
                                                  ::
                                                    (
                                                      11
                                                      ::
                                                        (
                                                          12
                                                          ::
                                                            (
                                                              13
                                                              ::
                                                                (
                                                                  28
                                                                  ::
                                                                    (
                                                                      100
                                                                      ::
                                                                        (
                                                                          127
                                                                          ::
                                                                            (
                                                                              128
                                                                              ::
                                                                                (
                                                                                  129
                                                                                  ::
                                                                                    (
                                                                                      191
                                                                                      ::
                                                                                        (
                                                                                          192
                                                                                          ::
                                                                                            (
                                                                                              193
                                                                                              ::
                                                                                                (
                                                                                                  506
                                                                                                  ::
                                                                                                    (
                                                                                                      1000
                                                                                                      ::
                                                                                                        (
                                                                                                          1023
                                                                                                          ::
                                                                                                            (
                                                                                                              1024
                                                                                                              ::
                                                                                                                (
                                                                                                                  1025
                                                                                                                  ::
                                                                                                                    (
                                                                                                                      1535
                                                                                                                      ::
                                                                                                                        (
                                                                                                                          1536
                                                                                                                          ::
                                                                                                                            (
                                                                                                                              1537
                                                                                                                              ::
                                                                                                                                (
                                                                                                                                  2323
                                                                                                                                  ::
                                                                                                                                    (
                                                                                                                                      4000
                                                                                                                                      ::
                                                                                                                                        (
                                                                                                                                          4094
                                                                                                                                          ::
                                                                                                                                            (
                                                                                                                                              4096
                                                                                                                                              ::
                                                                                                                                                (
                                                                                                                                                  4098
                                                                                                                                                  ::
                                                                                                                                                    (
                                                                                                                                                      5123
                                                                                                                                                      []
                                                                                                                                                                                                                                                                                                          )
                                                                                                                                                )
                                                                                                                                            )
                                                                                                                                        )
                                                                                                                                    )
                                                                                                                                )
                                                                                                                            )
                                                                                                                        )
                                                                                                                    )
                                                                                                                )
                                                                                                            )
                                                                                                        )
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
        )
  )
  type
  (
    aux
      type
        params =
          (
            a
            b
            c
            d
          )
        cstrs =
          (
          )
        kind =
            (
              prepf
                  poly
                  
                    arrow
                    
                      arrow
                      
                        a
                        arrow
                        
                          a
                           int
                          (
                          )
                      arrow
                      
                        arrow
                        
                          a
                          arrow
                          
                            a
                             bool
                            (
                            )
                        b
              prepd
                  poly
                  
                    arrow
                    
                       array
                      (
                          a
                      )
                      c
              postd
                  poly
                  
                    arrow
                    
                       array
                      (
                          a
                      )
                      arrow
                      
                        d
                         array
                        (
                            a
                        )
            )
            )
  let
  (
    ll
      record
      (
        prepf
          (
            case
            (
              x
              (
                case
                (
                  y
                  y
                )
              )
            )
          )
        prepd
          Array.to_list
        postd
          postl
      )
        )
  let
  (
    lc
      record
      (
        prepf
          (
            case
            (
              x
              (
                case
                (
                  y
                  x
                )
              )
            )
          )
        prepd
          Array.to_list
        postd
          postl
      )
        )
  let
  (
    al
      record
      (
        prepf
          (
            case
            (
              x
              (
                case
                (
                  y
                  y
                )
              )
            )
          )
        prepd
          id
        postd
          posta
      )
        )
  let
  (
    ac
      record
      (
        prepf
          (
            case
            (
              x
              (
                case
                (
                  y
                  x
                )
              )
            )
          )
        prepd
          id
        postd
          posta
      )
        )
  type
  (
    outcome
      type
        params =
          (
            a
          )
        cstrs =
          (
          )
        kind =
            (
              Value
                (
                    a
                )
                              Exception
                (
                     exn
                    (
                    )
                )
                            )
            )
  let
  (
    numfailed
      ref
      (
        
          0
      )
  )
  let
  (
    test1
      (
        case
        (
          name
          (
            case
            (
              f
              (
                case
                (
                  prepdata
                  (
                    case
                    (
                      postdata
                      (
                        case
                        (
                          cmp
                          (
                            case
                            (
                              desc
                              (
                                case
                                (
                                  mk
                                  (
                                    case
                                    (
                                      chk
                                      sequence
                                      (
                                        random_reinit
                                        (
                                          
                                            ()
                                                                                    )
                                      ;
                                        sequence
                                        (
                                          printf
                                          (
                                            
                                              "  %s with %s"
                                            
                                              name
                                            
                                              desc
                                          )
                                        ;
                                          let
                                          (
                                            (
                                              i
                                                ref
                                                (
                                                  
                                                    0
                                                )
                                            )
                                          in
                                            sequence
                                            (
                                              List.iter
                                              (
                                                
                                                  (
                                                    case
                                                    (
                                                      n
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            =
                                                            (
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            printf
                                                            (
                                                              
                                                                "\n    "
                                                            )
                                                          )
                                                          else
                                                          (
                                                                                                                      )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              i
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            ifthenelse
                                                            (
                                                              if
                                                              (
                                                                >
                                                                (
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        i
                                                                    )
                                                                  
                                                                    11
                                                                )
                                                              )
                                                              then
                                                              (
                                                                :=
                                                                (
                                                                  
                                                                    i
                                                                  
                                                                    0
                                                                )
                                                              )
                                                              else
                                                              (
                                                                                                                              )
                                                            )
                                                          ;
                                                            sequence
                                                            (
                                                              printf
                                                              (
                                                                
                                                                  "%5d"
                                                                
                                                                  n
                                                              )
                                                            ;
                                                              sequence
                                                              (
                                                                flush
                                                                (
                                                                  
                                                                    stdout
                                                                )
                                                              ;
                                                                let
                                                                (
                                                                  (
                                                                    rstate
                                                                      random_get_state
                                                                      (
                                                                        
                                                                          ()
                                                                                                                                                )
                                                                  )
                                                                in
                                                                  let
                                                                  (
                                                                    (
                                                                      a
                                                                        mk
                                                                        (
                                                                          
                                                                            n
                                                                        )
                                                                    )
                                                                  in
                                                                    let
                                                                    (
                                                                      (
                                                                        input
                                                                          prepdata
                                                                          (
                                                                            
                                                                              a
                                                                          )
                                                                      )
                                                                    in
                                                                      let
                                                                      (
                                                                        (
                                                                          output
                                                                            try
                                                                            Value
                                                                              f
                                                                              (
                                                                                
                                                                                  cmp
                                                                                
                                                                                  input
                                                                              )
                                                                            (
                                                                              case
                                                                              (
                                                                                e
                                                                                Exception
                                                                                  e
                                                                              )
                                                                            )
                                                                        )
                                                                      in
                                                                        sequence
                                                                        (
                                                                          printf
                                                                          (
                                                                            
                                                                              "."
                                                                          )
                                                                        ;
                                                                          sequence
                                                                          (
                                                                            flush
                                                                            (
                                                                              
                                                                                stdout
                                                                            )
                                                                          ;
                                                                            sequence
                                                                            (
                                                                              match
                                                                              output
                                                                              (
                                                                                case
                                                                                (
                                                                                  Value
                                                                                    v
                                                                                  ifthenelse
                                                                                  (
                                                                                    if
                                                                                    (
                                                                                      not
                                                                                      (
                                                                                        
                                                                                          chk
                                                                                          (
                                                                                            
                                                                                              rstate
                                                                                            
                                                                                              n
                                                                                            
                                                                                              postdata
                                                                                              (
                                                                                                
                                                                                                  a
                                                                                                
                                                                                                  v
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                    then
                                                                                    (
                                                                                      sequence
                                                                                      (
                                                                                        incr
                                                                                        (
                                                                                          
                                                                                            numfailed
                                                                                        )
                                                                                      ;
                                                                                        printf
                                                                                        (
                                                                                          
                                                                                            "\n*** FAIL\n"
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                    else
                                                                                    (
                                                                                                                                                                          )
                                                                                  )
                                                                                )
                                                                                case
                                                                                (
                                                                                  Exception
                                                                                    e
                                                                                  sequence
                                                                                  (
                                                                                    incr
                                                                                    (
                                                                                      
                                                                                        numfailed
                                                                                    )
                                                                                  ;
                                                                                    printf
                                                                                    (
                                                                                      
                                                                                        "\n*** %s\n"
                                                                                      
                                                                                        Printexc.to_string
                                                                                        (
                                                                                          
                                                                                            e
                                                                                        )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                            ;
                                                                              flush
                                                                              (
                                                                                
                                                                                  stdout
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                
                                                  lens
                                              )
                                            ;
                                              printf
                                              (
                                                
                                                  "\n"
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test
      (
        case
        (
          name
          (
            case
            (
              stable
              (
                case
                (
                  f1
                  (
                    case
                    (
                      f2
                      (
                        case
                        (
                          aux1
                          (
                            case
                            (
                              aux2
                              sequence
                              (
                                printf
                                (
                                  
                                    "Testing %s...\n"
                                  
                                    name
                                )
                              ;
                                let
                                (
                                  (
                                    t
                                      (
                                        case
                                        (
                                          a
                                          (
                                            case
                                            (
                                              b
                                              (
                                                case
                                                (
                                                  c
                                                  (
                                                    case
                                                    (
                                                      d
                                                      test1
                                                      (
                                                        
                                                          name
                                                        
                                                          f1
                                                        
                                                          field
                                                          (
                                                          aux1
                                                          prepd
                                                          )
                                                        
                                                          field
                                                          (
                                                          aux1
                                                          postd
                                                          )
                                                        
                                                          a
                                                        
                                                          b
                                                        
                                                          c
                                                        
                                                          d
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      cmp
                                        field
                                        (
                                        aux1
                                        prepf
                                        )
                                        (
                                          
                                            compare
                                          
                                            <=
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      t
                                      (
                                        
                                          cmp
                                        
                                          "constant ints"
                                        
                                          mkconst
                                        
                                          chkconst
                                      )
                                    ;
                                      sequence
                                      (
                                        t
                                        (
                                          
                                            cmp
                                          
                                            "sorted ints"
                                          
                                            mksorted
                                          
                                            chksorted
                                        )
                                      ;
                                        sequence
                                        (
                                          t
                                          (
                                            
                                              cmp
                                            
                                              "reverse-sorted ints"
                                            
                                              mkrev
                                            
                                              chkrev
                                          )
                                        ;
                                          sequence
                                          (
                                            t
                                            (
                                              
                                                cmp
                                              
                                                "random ints (many dups)"
                                              
                                                mkrand_dup
                                              
                                                chkrand_dup
                                            )
                                          ;
                                            sequence
                                            (
                                              t
                                              (
                                                
                                                  cmp
                                                
                                                  "random ints (few dups)"
                                                
                                                  mkrand_nodup
                                                
                                                  chkrand_nodup
                                              )
                                            ;
                                              let
                                              (
                                                (
                                                  t
                                                    (
                                                      case
                                                      (
                                                        a
                                                        (
                                                          case
                                                          (
                                                            b
                                                            (
                                                              case
                                                              (
                                                                c
                                                                (
                                                                  case
                                                                  (
                                                                    d
                                                                    test1
                                                                    (
                                                                      
                                                                        name
                                                                      
                                                                        f2
                                                                      
                                                                        field
                                                                        (
                                                                        aux2
                                                                        prepd
                                                                        )
                                                                      
                                                                        field
                                                                        (
                                                                        aux2
                                                                        postd
                                                                        )
                                                                      
                                                                        a
                                                                      
                                                                        b
                                                                      
                                                                        c
                                                                      
                                                                        d
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    cmp
                                                      field
                                                      (
                                                      aux2
                                                      prepf
                                                      )
                                                      (
                                                        
                                                          cmpstr
                                                        
                                                          lestr
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    t
                                                    (
                                                      
                                                        cmp
                                                      
                                                        "records (str)"
                                                      
                                                        mkrecs
                                                        (
                                                          
                                                            1
                                                        )
                                                      
                                                        chkstr
                                                        (
                                                          
                                                            1
                                                        )
                                                    )
                                                  ;
                                                    let
                                                    (
                                                      (
                                                        cmp
                                                          field
                                                          (
                                                          aux2
                                                          prepf
                                                          )
                                                          (
                                                            
                                                              cmpint
                                                            
                                                              leint
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        List.iter
                                                        (
                                                          
                                                            (
                                                              case
                                                              (
                                                                m
                                                                t
                                                                (
                                                                  
                                                                    cmp
                                                                  
                                                                    sprintf
                                                                    (
                                                                      
                                                                        "records (int[%d])"
                                                                      
                                                                        m
                                                                    )
                                                                  
                                                                    mkrecs
                                                                    (
                                                                      
                                                                        m
                                                                    )
                                                                  
                                                                    chkint
                                                                    (
                                                                      
                                                                        m
                                                                    )
                                                                )
                                                              )
                                                            )
                                                          
                                                            ::
                                                              (
                                                                1
                                                                ::
                                                                  (
                                                                    10
                                                                    ::
                                                                      (
                                                                        100
                                                                        ::
                                                                          (
                                                                            1000
                                                                            []
                                                                                                                                                      )
                                                                      )
                                                                  )
                                                              )
                                                        )
                                                      ;
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            stable
                                                          )
                                                          then
                                                          (
                                                            List.iter
                                                            (
                                                              
                                                                (
                                                                  case
                                                                  (
                                                                    m
                                                                    t
                                                                    (
                                                                      
                                                                        cmp
                                                                      
                                                                        sprintf
                                                                        (
                                                                          
                                                                            "records (int[%d]) [stable]"
                                                                          
                                                                            m
                                                                        )
                                                                      
                                                                        mkrecs
                                                                        (
                                                                          
                                                                            m
                                                                        )
                                                                      
                                                                        chklex
                                                                        (
                                                                          
                                                                            m
                                                                        )
                                                                    )
                                                                  )
                                                                )
                                                              
                                                                ::
                                                                  (
                                                                    1
                                                                    ::
                                                                      (
                                                                        10
                                                                        ::
                                                                          (
                                                                            100
                                                                            ::
                                                                              (
                                                                                1000
                                                                                []
                                                                                                                                                              )
                                                                          )
                                                                      )
                                                                  )
                                                            )
                                                          )
                                                          else
                                                          (
                                                                                                                      )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    rpt_timer1
      (
        case
        (
          repeat
          (
            case
            (
              f
              (
                case
                (
                  x
                  sequence
                  (
                    Gc.compact
                    (
                      
                        ()
                                            )
                  ;
                    sequence
                    (
                      ignore
                      (
                        
                          f
                          (
                            
                              x
                          )
                      )
                    ;
                      let
                      (
                        (
                          st
                            Sys.time
                            (
                              
                                ()
                                                            )
                        )
                      in
                        sequence
                        (
                          for i
                          1
                          repeat
                          ignore
                          (
                            
                              f
                              (
                                
                                  x
                              )
                          )
                        ;
                          let
                          (
                            (
                              en
                                Sys.time
                                (
                                  
                                    ()
                                                                    )
                            )
                          in
                            -.
                            (
                              
                                en
                              
                                st
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    rpt_timer
      (
        case
        (
          f
          (
            case
            (
              x
              let
              (
                (
                  repeat
                    ref
                    (
                      
                        1
                    )
                )
              in
                let
                (
                  (
                    t
                      ref
                      (
                        
                          rpt_timer1
                          (
                            
                              !
                              (
                                
                                  repeat
                              )
                            
                              f
                            
                              x
                          )
                      )
                  )
                in
                  sequence
                  (
                    while
                    <
                    (
                      
                        !
                        (
                          
                            t
                        )
                      
                        0.2
                    )
                    sequence
                    (
                      :=
                      (
                        
                          repeat
                        
                          *
                          (
                            
                              10
                            
                              !
                              (
                                
                                  repeat
                              )
                          )
                      )
                    ;
                      :=
                      (
                        
                          t
                        
                          rpt_timer1
                          (
                            
                              !
                              (
                                
                                  repeat
                              )
                            
                              f
                            
                              x
                          )
                      )
                    )
                  ;
                    sequence
                    (
                      ifthenelse
                      (
                        if
                        (
                          <
                          (
                            
                              !
                              (
                                
                                  t
                              )
                            
                              2.0
                          )
                        )
                        then
                        (
                          sequence
                          (
                            :=
                            (
                              
                                repeat
                              
                                +
                                (
                                  
                                    int_of_float
                                    (
                                      
                                        /.
                                        (
                                          
                                            *.
                                            (
                                              
                                                10.
                                              
                                                float
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        repeat
                                                    )
                                                )
                                            )
                                          
                                            !
                                            (
                                              
                                                t
                                            )
                                        )
                                    )
                                  
                                    1
                                )
                            )
                          ;
                            :=
                            (
                              
                                t
                              
                                rpt_timer1
                                (
                                  
                                    !
                                    (
                                      
                                        repeat
                                    )
                                  
                                    f
                                  
                                    x
                                )
                            )
                          )
                        )
                        else
                        (
                                                  )
                      )
                    ;
                      /.
                      (
                        
                          !
                          (
                            
                              t
                          )
                        
                          float
                          (
                            
                              !
                              (
                                
                                  repeat
                              )
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    timer
      (
        case
        (
          f
          (
            case
            (
              x
              let
              (
                (
                  st
                    Sys.time
                    (
                      
                        ()
                                            )
                )
              in
                sequence
                (
                  ignore
                  (
                    
                      f
                      (
                        
                          x
                      )
                  )
                ;
                  let
                  (
                    (
                      en
                        Sys.time
                        (
                          
                            ()
                                                    )
                    )
                  in
                    -.
                    (
                      
                        en
                      
                        st
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    table1
      (
        case
        (
          limit
          (
            case
            (
              f
              (
                case
                (
                  mkarg
                  sequence
                  (
                    printf
                    (
                      
                        "  %10s  %9s  %9s  %9s  %9s  %9s\n"
                      
                        "n"
                      
                        "t1"
                      
                        "t2"
                      
                        "t3"
                      
                        "t4"
                      
                        "t5"
                    )
                  ;
                    let
                    (
                      (
                        sz
                          ref
                          (
                            
                              49151
                          )
                      )
                    in
                      while
                      <
                      (
                        
                          !
                          (
                            
                              sz
                          )
                        
                          int_of_float
                          (
                            
                              **
                              (
                                
                                  2.
                                
                                  float
                                  (
                                    
                                      limit
                                  )
                              )
                          )
                      )
                      sequence
                      (
                        try
                        sequence
                        (
                          printf
                          (
                            
                              "  %10d  "
                            
                              !
                              (
                                
                                  sz
                              )
                          )
                        ;
                          sequence
                          (
                            flush
                            (
                              
                                stdout
                            )
                          ;
                            sequence
                            (
                              for i
                              0
                              4
                              let
                              (
                                (
                                  arg
                                    mkarg
                                    (
                                      
                                        !
                                        (
                                          
                                            sz
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      timer
                                      (
                                        
                                          f
                                        
                                          arg
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    printf
                                    (
                                      
                                        " %.2e   "
                                      
                                        t
                                    )
                                  ;
                                    flush
                                    (
                                      
                                        stdout
                                    )
                                  )
                                )
                              )
                            ;
                              printf
                              (
                                
                                  "\n"
                              )
                            )
                          )
                        )
                        (
                          case
                          (
                            e
                            printf
                            (
                              
                                "*** %s\n"
                              
                                Printexc.to_string
                                (
                                  
                                    e
                                )
                            )
                          )
                        )
                      ;
                        sequence
                        (
                          flush
                          (
                            
                              stdout
                          )
                        ;
                          :=
                          (
                            
                              sz
                            
                              +
                              (
                                
                                  *
                                  (
                                    
                                      2
                                    
                                      !
                                      (
                                        
                                          sz
                                      )
                                  )
                                
                                  1
                              )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    table2
      (
        case
        (
          limit
          (
            case
            (
              f
              (
                case
                (
                  mkarg
                  sequence
                  (
                    printf
                    (
                      
                        "  %10s  %9s  %9s  %9s  %9s  %9s\n"
                      
                        " n"
                      
                        "t"
                      
                        "t/n"
                      
                        "t/nlogn"
                      
                        "t/nlog^2n"
                      
                        "t/n^2"
                    )
                  ;
                    let
                    (
                      (
                        sz
                          ref
                          (
                            
                              49151
                          )
                      )
                    in
                      while
                      <
                      (
                        
                          float
                          (
                            
                              !
                              (
                                
                                  sz
                              )
                          )
                        
                          **
                          (
                            
                              2.
                            
                              float
                              (
                                
                                  limit
                              )
                          )
                      )
                      sequence
                      (
                        try
                        sequence
                        (
                          printf
                          (
                            
                              "  %10d   "
                            
                              !
                              (
                                
                                  sz
                              )
                          )
                        ;
                          sequence
                          (
                            flush
                            (
                              
                                stdout
                            )
                          ;
                            sequence
                            (
                              Gc.compact
                              (
                                
                                  ()
                                                                )
                            ;
                              let
                              (
                                (
                                  arg
                                    mkarg
                                    (
                                      
                                        !
                                        (
                                          
                                            sz
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      timer
                                      (
                                        
                                          f
                                        
                                          arg
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      n
                                        float
                                        (
                                          
                                            !
                                            (
                                              
                                                sz
                                            )
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        logn
                                          /.
                                          (
                                            
                                              log
                                              (
                                                
                                                  float
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          sz
                                                      )
                                                  )
                                              )
                                            
                                              log
                                              (
                                                
                                                  2.
                                              )
                                          )
                                      )
                                    in
                                      printf
                                      (
                                        
                                          "%.2e   %.2e   %.2e   %.2e   %.2e\n"
                                        
                                          t
                                        
                                          /.
                                          (
                                            
                                              t
                                            
                                              n
                                          )
                                        
                                          /.
                                          (
                                            
                                              /.
                                              (
                                                
                                                  t
                                                
                                                  n
                                              )
                                            
                                              logn
                                          )
                                        
                                          /.
                                          (
                                            
                                              /.
                                              (
                                                
                                                  /.
                                                  (
                                                    
                                                      t
                                                    
                                                      n
                                                  )
                                                
                                                  logn
                                              )
                                            
                                              logn
                                          )
                                        
                                          /.
                                          (
                                            
                                              /.
                                              (
                                                
                                                  t
                                                
                                                  n
                                              )
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                        (
                          case
                          (
                            e
                            printf
                            (
                              
                                "*** %s\n"
                              
                                Printexc.to_string
                                (
                                  
                                    e
                                )
                            )
                          )
                        )
                      ;
                        sequence
                        (
                          flush
                          (
                            
                              stdout
                          )
                        ;
                          :=
                          (
                            
                              sz
                            
                              +
                              (
                                
                                  *
                                  (
                                    
                                      2
                                    
                                      !
                                      (
                                        
                                          sz
                                      )
                                  )
                                
                                  1
                              )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    table3
      (
        case
        (
          limit
          (
            case
            (
              f
              (
                case
                (
                  mkarg
                  sequence
                  (
                    printf
                    (
                      
                        "  %10s  %9s  %9s  %9s  %9s  %9s\n"
                      
                        "n"
                      
                        "t1"
                      
                        "t2"
                      
                        "t3"
                      
                        "t4"
                      
                        "t5"
                    )
                  ;
                    let
                    (
                      (
                        sz
                          ref
                          (
                            
                              2
                          )
                      )
                    in
                      while
                      <
                      (
                        
                          float
                          (
                            
                              !
                              (
                                
                                  sz
                              )
                          )
                        
                          **
                          (
                            
                              2.
                            
                              float
                              (
                                
                                  limit
                              )
                          )
                      )
                      sequence
                      (
                        try
                        sequence
                        (
                          printf
                          (
                            
                              "  %10d  "
                            
                              !
                              (
                                
                                  sz
                              )
                          )
                        ;
                          sequence
                          (
                            flush
                            (
                              
                                stdout
                            )
                          ;
                            sequence
                            (
                              for i
                              0
                              4
                              let
                              (
                                (
                                  arg
                                    mkarg
                                    (
                                      
                                        !
                                        (
                                          
                                            sz
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      rpt_timer
                                      (
                                        
                                          f
                                        
                                          arg
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    printf
                                    (
                                      
                                        " %.2e   "
                                      
                                        t
                                    )
                                  ;
                                    flush
                                    (
                                      
                                        stdout
                                    )
                                  )
                                )
                              )
                            ;
                              printf
                              (
                                
                                  "\n"
                              )
                            )
                          )
                        )
                        (
                          case
                          (
                            e
                            printf
                            (
                              
                                "*** %s\n"
                              
                                Printexc.to_string
                                (
                                  
                                    e
                                )
                            )
                          )
                        )
                      ;
                        sequence
                        (
                          flush
                          (
                            
                              stdout
                          )
                        ;
                          :=
                          (
                            
                              sz
                            
                              +
                              (
                                
                                  *
                                  (
                                    
                                      2
                                    
                                      !
                                      (
                                        
                                          sz
                                      )
                                  )
                                
                                  1
                              )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    bench1a
      (
        case
        (
          limit
          (
            case
            (
              name
              (
                case
                (
                  f
                  (
                    case
                    (
                      aux
                      sequence
                      (
                        assert                        not
                        (
                          
                            true
                                                    )
                        
                      ;
                        sequence
                        (
                          random_reinit
                          (
                            
                              ()
                                                        )
                        ;
                          sequence
                          (
                            printf
                            (
                              
                                "\n%s with random records [10]:\n"
                              
                                name
                            )
                          ;
                            let
                            (
                              (
                                cmp
                                  field
                                  (
                                  aux
                                  prepf
                                  )
                                  (
                                    
                                      cmplex
                                    
                                      lelex
                                  )
                              )
                            in
                              table1
                              (
                                
                                  limit
                                
                                  f
                                  (
                                    
                                      cmp
                                  )
                                
                                  (
                                    case
                                    (
                                      n
                                      field
                                      (
                                      aux
                                      prepd
                                      )
                                      (
                                        
                                          mkrecs
                                          (
                                            
                                              10
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    bench1b
      (
        case
        (
          limit
          (
            case
            (
              name
              (
                case
                (
                  f
                  (
                    case
                    (
                      aux
                      sequence
                      (
                        assert                        not
                        (
                          
                            true
                                                    )
                        
                      ;
                        sequence
                        (
                          random_reinit
                          (
                            
                              ()
                                                        )
                        ;
                          sequence
                          (
                            printf
                            (
                              
                                "\n%s with random integers:\n"
                              
                                name
                            )
                          ;
                            let
                            (
                              (
                                cmp
                                  field
                                  (
                                  aux
                                  prepf
                                  )
                                  (
                                    
                                      -
                                    
                                      <=
                                  )
                              )
                            in
                              table1
                              (
                                
                                  limit
                                
                                  f
                                  (
                                    
                                      cmp
                                  )
                                
                                  (
                                    case
                                    (
                                      n
                                      field
                                      (
                                      aux
                                      prepd
                                      )
                                      (
                                        
                                          mkrand_nodup
                                          (
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    bench1c
      (
        case
        (
          limit
          (
            case
            (
              name
              (
                case
                (
                  f
                  (
                    case
                    (
                      aux
                      sequence
                      (
                        assert                        not
                        (
                          
                            true
                                                    )
                        
                      ;
                        sequence
                        (
                          random_reinit
                          (
                            
                              ()
                                                        )
                        ;
                          sequence
                          (
                            printf
                            (
                              
                                "\n%s with random floats:\n"
                              
                                name
                            )
                          ;
                            let
                            (
                              (
                                cmp
                                  field
                                  (
                                  aux
                                  prepf
                                  )
                                  (
                                    
                                      compare
                                    
                                      <=
                                  )
                              )
                            in
                              table1
                              (
                                
                                  limit
                                
                                  f
                                  (
                                    
                                      cmp
                                  )
                                
                                  (
                                    case
                                    (
                                      n
                                      field
                                      (
                                      aux
                                      prepd
                                      )
                                      (
                                        
                                          mkfloats
                                          (
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    bench2
      (
        case
        (
          limit
          (
            case
            (
              name
              (
                case
                (
                  f
                  (
                    case
                    (
                      aux
                      sequence
                      (
                        assert                        not
                        (
                          
                            true
                                                    )
                        
                      ;
                        sequence
                        (
                          printf
                          (
                            
                              "\n%s with constant integers:\n"
                            
                              name
                          )
                        ;
                          let
                          (
                            (
                              cmp
                                field
                                (
                                aux
                                prepf
                                )
                                (
                                  
                                    compare
                                  
                                    <=
                                )
                            )
                          in
                            sequence
                            (
                              table2
                              (
                                
                                  limit
                                
                                  f
                                  (
                                    
                                      cmp
                                  )
                                
                                  (
                                    case
                                    (
                                      n
                                      field
                                      (
                                      aux
                                      prepd
                                      )
                                      (
                                        
                                          mkconst
                                          (
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                              )
                            ;
                              sequence
                              (
                                printf
                                (
                                  
                                    "\n%s with sorted integers:\n"
                                  
                                    name
                                )
                              ;
                                let
                                (
                                  (
                                    cmp
                                      field
                                      (
                                      aux
                                      prepf
                                      )
                                      (
                                        
                                          compare
                                        
                                          <=
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    table2
                                    (
                                      
                                        limit
                                      
                                        f
                                        (
                                          
                                            cmp
                                        )
                                      
                                        (
                                          case
                                          (
                                            n
                                            field
                                            (
                                            aux
                                            prepd
                                            )
                                            (
                                              
                                                mksorted
                                                (
                                                  
                                                    n
                                                )
                                            )
                                          )
                                        )
                                    )
                                  ;
                                    sequence
                                    (
                                      printf
                                      (
                                        
                                          "\n%s with reverse-sorted integers:\n"
                                        
                                          name
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          cmp
                                            field
                                            (
                                            aux
                                            prepf
                                            )
                                            (
                                              
                                                compare
                                              
                                                <=
                                            )
                                        )
                                      in
                                        table2
                                        (
                                          
                                            limit
                                          
                                            f
                                            (
                                              
                                                cmp
                                            )
                                          
                                            (
                                              case
                                              (
                                                n
                                                field
                                                (
                                                aux
                                                prepd
                                                )
                                                (
                                                  
                                                    mkrev
                                                    (
                                                      
                                                        n
                                                    )
                                                )
                                              )
                                            )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    bench3a
      (
        case
        (
          limit
          (
            case
            (
              name
              (
                case
                (
                  f
                  (
                    case
                    (
                      aux
                      sequence
                      (
                        assert                        not
                        (
                          
                            true
                                                    )
                        
                      ;
                        sequence
                        (
                          random_reinit
                          (
                            
                              ()
                                                        )
                        ;
                          sequence
                          (
                            printf
                            (
                              
                                "\n%s with random records [10]:\n"
                              
                                name
                            )
                          ;
                            let
                            (
                              (
                                cmp
                                  field
                                  (
                                  aux
                                  prepf
                                  )
                                  (
                                    
                                      cmplex
                                    
                                      lelex
                                  )
                              )
                            in
                              table3
                              (
                                
                                  limit
                                
                                  f
                                  (
                                    
                                      cmp
                                  )
                                
                                  (
                                    case
                                    (
                                      n
                                      field
                                      (
                                      aux
                                      prepd
                                      )
                                      (
                                        
                                          mkrecs
                                          (
                                            
                                              10
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    bench3b
      (
        case
        (
          limit
          (
            case
            (
              name
              (
                case
                (
                  f
                  (
                    case
                    (
                      aux
                      sequence
                      (
                        assert                        not
                        (
                          
                            true
                                                    )
                        
                      ;
                        sequence
                        (
                          random_reinit
                          (
                            
                              ()
                                                        )
                        ;
                          sequence
                          (
                            printf
                            (
                              
                                "\n%s with random integers:\n"
                              
                                name
                            )
                          ;
                            let
                            (
                              (
                                cmp
                                  field
                                  (
                                  aux
                                  prepf
                                  )
                                  (
                                    
                                      -
                                    
                                      <=
                                  )
                              )
                            in
                              table3
                              (
                                
                                  limit
                                
                                  f
                                  (
                                    
                                      cmp
                                  )
                                
                                  (
                                    case
                                    (
                                      n
                                      field
                                      (
                                      aux
                                      prepd
                                      )
                                      (
                                        
                                          mkrand_nodup
                                          (
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    bench3c
      (
        case
        (
          limit
          (
            case
            (
              name
              (
                case
                (
                  f
                  (
                    case
                    (
                      aux
                      sequence
                      (
                        assert                        not
                        (
                          
                            true
                                                    )
                        
                      ;
                        sequence
                        (
                          random_reinit
                          (
                            
                              ()
                                                        )
                        ;
                          sequence
                          (
                            printf
                            (
                              
                                "\n%s with random floats:\n"
                              
                                name
                            )
                          ;
                            let
                            (
                              (
                                cmp
                                  field
                                  (
                                  aux
                                  prepf
                                  )
                                  (
                                    
                                      compare
                                    
                                      <=
                                  )
                              )
                            in
                              table3
                              (
                                
                                  limit
                                
                                  f
                                  (
                                    
                                      cmp
                                  )
                                
                                  (
                                    case
                                    (
                                      n
                                      field
                                      (
                                      aux
                                      prepd
                                      )
                                      (
                                        
                                          mkfloats
                                          (
                                            
                                              n
                                          )
                                      )
                                    )
                                  )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    @@
      List.rev_append
  )
  let
  (
    lmerge_1a
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  init
                    (
                      case
                      (
                        accu
                        (
                          case
                          (
                            []
                                                        accu
                          )
                          case
                          (
                            ::
                              (
                                e
                                rest
                              )
                            init
                            (
                              
                                ::
                                  (
                                    ::
                                      (
                                        e
                                        []
                                                                              )
                                    accu
                                  )
                              
                                rest
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    merge
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          match
                                          (
                                            l1
                                            l2
                                          )
                                          (
                                            case
                                            (
                                              (
                                                []
                                                                                                _
                                              )
                                              mergepairs
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l2
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                _
                                                []
                                                                                              )
                                              mergepairs
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l1
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                ::
                                                  (
                                                    h1
                                                    t1
                                                  )
                                                ::
                                                  (
                                                    h2
                                                    t2
                                                  )
                                              )
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          h1
                                                        
                                                          h2
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  merge
                                                  (
                                                    
                                                      rest
                                                    
                                                      accu2
                                                    
                                                      ::
                                                        (
                                                          h1
                                                          accu
                                                        )
                                                    
                                                      t1
                                                    
                                                      l2
                                                  )
                                                )
                                                else
                                                (
                                                    merge
                                                    (
                                                      
                                                        rest
                                                      
                                                        accu2
                                                      
                                                        ::
                                                          (
                                                            h2
                                                            accu
                                                          )
                                                      
                                                        l1
                                                      
                                                        t2
                                                    )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    merge_rev
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          match
                                          (
                                            l1
                                            l2
                                          )
                                          (
                                            case
                                            (
                                              (
                                                []
                                                                                                _
                                              )
                                              mergepairs_rev
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l2
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                _
                                                []
                                                                                              )
                                              mergepairs_rev
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l1
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                ::
                                                  (
                                                    h1
                                                    t1
                                                  )
                                                ::
                                                  (
                                                    h2
                                                    t2
                                                  )
                                              )
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          h2
                                                        
                                                          h1
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  merge_rev
                                                  (
                                                    
                                                      rest
                                                    
                                                      accu2
                                                    
                                                      ::
                                                        (
                                                          h1
                                                          accu
                                                        )
                                                    
                                                      t1
                                                    
                                                      l2
                                                  )
                                                )
                                                else
                                                (
                                                    merge_rev
                                                    (
                                                      
                                                        rest
                                                      
                                                        accu2
                                                      
                                                        ::
                                                          (
                                                            h2
                                                            accu
                                                          )
                                                      
                                                        l1
                                                      
                                                        t2
                                                    )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    mergepairs
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall_rev
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall_rev
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergepairs_rev
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge_rev
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergeall
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          l
                        )
                        case
                        (
                          llist
                          mergepairs
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                    mergeall_rev
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          List.rev
                          (
                            
                              l
                          )
                        )
                        case
                        (
                          llist
                          mergepairs_rev
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                  )
                in
                  mergeall_rev
                  (
                    
                      init
                      (
                        
                          []
                                                  
                          l
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_1b
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  init
                    (
                      case
                      (
                        accu
                        (
                          case
                          (
                            []
                                                        accu
                          )
                          case
                          (
                            ::
                              (
                                e
                                []
                                                              )
                            ::
                              (
                                ::
                                  (
                                    e
                                    []
                                                                      )
                                accu
                              )
                          )
                          case
                          (
                            ::
                              (
                                e1
                                ::
                                  (
                                    e2
                                    rest
                                  )
                              )
                            init
                            (
                              
                                ::
                                  (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                e1
                                              
                                                e2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            e2
                                            ::
                                              (
                                                e1
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              e1
                                              ::
                                                (
                                                  e2
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                    accu
                                  )
                              
                                rest
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    merge
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          match
                                          (
                                            l1
                                            l2
                                          )
                                          (
                                            case
                                            (
                                              (
                                                []
                                                                                                _
                                              )
                                              mergepairs
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l2
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                _
                                                []
                                                                                              )
                                              mergepairs
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l1
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                ::
                                                  (
                                                    h1
                                                    t1
                                                  )
                                                ::
                                                  (
                                                    h2
                                                    t2
                                                  )
                                              )
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          h1
                                                        
                                                          h2
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  merge
                                                  (
                                                    
                                                      rest
                                                    
                                                      accu2
                                                    
                                                      ::
                                                        (
                                                          h1
                                                          accu
                                                        )
                                                    
                                                      t1
                                                    
                                                      l2
                                                  )
                                                )
                                                else
                                                (
                                                    merge
                                                    (
                                                      
                                                        rest
                                                      
                                                        accu2
                                                      
                                                        ::
                                                          (
                                                            h2
                                                            accu
                                                          )
                                                      
                                                        l1
                                                      
                                                        t2
                                                    )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    merge_rev
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          match
                                          (
                                            l1
                                            l2
                                          )
                                          (
                                            case
                                            (
                                              (
                                                []
                                                                                                _
                                              )
                                              mergepairs_rev
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l2
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                _
                                                []
                                                                                              )
                                              mergepairs_rev
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l1
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              (
                                                ::
                                                  (
                                                    h1
                                                    t1
                                                  )
                                                ::
                                                  (
                                                    h2
                                                    t2
                                                  )
                                              )
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          h2
                                                        
                                                          h1
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  merge_rev
                                                  (
                                                    
                                                      rest
                                                    
                                                      accu2
                                                    
                                                      ::
                                                        (
                                                          h1
                                                          accu
                                                        )
                                                    
                                                      t1
                                                    
                                                      l2
                                                  )
                                                )
                                                else
                                                (
                                                    merge_rev
                                                    (
                                                      
                                                        rest
                                                      
                                                        accu2
                                                      
                                                        ::
                                                          (
                                                            h2
                                                            accu
                                                          )
                                                      
                                                        l1
                                                      
                                                        t2
                                                    )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    mergepairs
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall_rev
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall_rev
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergepairs_rev
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge_rev
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergeall
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          l
                        )
                        case
                        (
                          llist
                          mergepairs
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                    mergeall_rev
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          List.rev
                          (
                            
                              l
                          )
                        )
                        case
                        (
                          llist
                          mergepairs_rev
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                  )
                in
                  mergeall_rev
                  (
                    
                      init
                      (
                        
                          []
                                                  
                          l
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_1c
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  init
                    (
                      case
                      (
                        accu
                        (
                          case
                          (
                            []
                                                        accu
                          )
                          case
                          (
                            ::
                              (
                                e
                                []
                                                              )
                            ::
                              (
                                ::
                                  (
                                    e
                                    []
                                                                      )
                                accu
                              )
                          )
                          case
                          (
                            ::
                              (
                                e1
                                ::
                                  (
                                    e2
                                    rest
                                  )
                              )
                            init
                            (
                              
                                ::
                                  (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                e1
                                              
                                                e2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            e2
                                            ::
                                              (
                                                e1
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              e1
                                              ::
                                                (
                                                  e2
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                    accu
                                  )
                              
                                rest
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    merge
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          match
                                          l1
                                          (
                                            case
                                            (
                                              []
                                                                                            mergepairs
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l2
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              ::
                                                (
                                                  h1
                                                  t1
                                                )
                                              match
                                              l2
                                              (
                                                case
                                                (
                                                  []
                                                                                                    mergepairs
                                                  (
                                                    
                                                      ::
                                                        (
                                                          @@
                                                          (
                                                            
                                                              l1
                                                            
                                                              accu
                                                          )
                                                          accu2
                                                        )
                                                    
                                                      rest
                                                  )
                                                )
                                                case
                                                (
                                                  ::
                                                    (
                                                      h2
                                                      t2
                                                    )
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              h1
                                                            
                                                              h2
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      merge
                                                      (
                                                        
                                                          rest
                                                        
                                                          accu2
                                                        
                                                          ::
                                                            (
                                                              h1
                                                              accu
                                                            )
                                                        
                                                          t1
                                                        
                                                          l2
                                                      )
                                                    )
                                                    else
                                                    (
                                                        merge
                                                        (
                                                          
                                                            rest
                                                          
                                                            accu2
                                                          
                                                            ::
                                                              (
                                                                h2
                                                                accu
                                                              )
                                                          
                                                            l1
                                                          
                                                            t2
                                                        )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    merge_rev
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          match
                                          l1
                                          (
                                            case
                                            (
                                              []
                                                                                            mergepairs_rev
                                              (
                                                
                                                  ::
                                                    (
                                                      @@
                                                      (
                                                        
                                                          l2
                                                        
                                                          accu
                                                      )
                                                      accu2
                                                    )
                                                
                                                  rest
                                              )
                                            )
                                            case
                                            (
                                              ::
                                                (
                                                  h1
                                                  t1
                                                )
                                              match
                                              l2
                                              (
                                                case
                                                (
                                                  []
                                                                                                    mergepairs_rev
                                                  (
                                                    
                                                      ::
                                                        (
                                                          @@
                                                          (
                                                            
                                                              l1
                                                            
                                                              accu
                                                          )
                                                          accu2
                                                        )
                                                    
                                                      rest
                                                  )
                                                )
                                                case
                                                (
                                                  ::
                                                    (
                                                      h2
                                                      t2
                                                    )
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              h2
                                                            
                                                              h1
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      merge_rev
                                                      (
                                                        
                                                          rest
                                                        
                                                          accu2
                                                        
                                                          ::
                                                            (
                                                              h1
                                                              accu
                                                            )
                                                        
                                                          t1
                                                        
                                                          l2
                                                      )
                                                    )
                                                    else
                                                    (
                                                        merge_rev
                                                        (
                                                          
                                                            rest
                                                          
                                                            accu2
                                                          
                                                            ::
                                                              (
                                                                h2
                                                                accu
                                                              )
                                                          
                                                            l1
                                                          
                                                            t2
                                                        )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    mergepairs
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall_rev
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall_rev
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergepairs_rev
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge_rev
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergeall
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          l
                        )
                        case
                        (
                          llist
                          mergepairs
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                    mergeall_rev
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          List.rev
                          (
                            
                              l
                          )
                        )
                        case
                        (
                          llist
                          mergepairs_rev
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                  )
                in
                  mergeall_rev
                  (
                    
                      init
                      (
                        
                          []
                                                  
                          l
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_1d
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  init
                    (
                      case
                      (
                        accu
                        (
                          case
                          (
                            []
                                                        accu
                          )
                          case
                          (
                            ::
                              (
                                e
                                []
                                                              )
                            ::
                              (
                                ::
                                  (
                                    e
                                    []
                                                                      )
                                accu
                              )
                          )
                          case
                          (
                            ::
                              (
                                e1
                                ::
                                  (
                                    e2
                                    rest
                                  )
                              )
                            init
                            (
                              
                                ::
                                  (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                e1
                                              
                                                e2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            e2
                                            ::
                                              (
                                                e1
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              e1
                                              ::
                                                (
                                                  e2
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                    accu
                                  )
                              
                                rest
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    merge
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          let
                                          (
                                            (
                                              merge_rest_accu2
                                                (
                                                  case
                                                  (
                                                    accu
                                                    (
                                                      case
                                                      (
                                                        l1
                                                        (
                                                          case
                                                          (
                                                            l2
                                                            match
                                                            l1
                                                            (
                                                              case
                                                              (
                                                                []
                                                                                                                                mergepairs
                                                                (
                                                                  
                                                                    ::
                                                                      (
                                                                        @@
                                                                        (
                                                                          
                                                                            l2
                                                                          
                                                                            accu
                                                                        )
                                                                        accu2
                                                                      )
                                                                  
                                                                    rest
                                                                )
                                                              )
                                                              case
                                                              (
                                                                ::
                                                                  (
                                                                    h1
                                                                    t1
                                                                  )
                                                                match
                                                                l2
                                                                (
                                                                  case
                                                                  (
                                                                    []
                                                                                                                                        mergepairs
                                                                    (
                                                                      
                                                                        ::
                                                                          (
                                                                            @@
                                                                            (
                                                                              
                                                                                l1
                                                                              
                                                                                accu
                                                                            )
                                                                            accu2
                                                                          )
                                                                      
                                                                        rest
                                                                    )
                                                                  )
                                                                  case
                                                                  (
                                                                    ::
                                                                      (
                                                                        h2
                                                                        t2
                                                                      )
                                                                    ifthenelse
                                                                    (
                                                                      if
                                                                      (
                                                                        <=
                                                                        (
                                                                          
                                                                            cmp
                                                                            (
                                                                              
                                                                                h1
                                                                              
                                                                                h2
                                                                            )
                                                                          
                                                                            0
                                                                        )
                                                                      )
                                                                      then
                                                                      (
                                                                        merge
                                                                        (
                                                                          
                                                                            rest
                                                                          
                                                                            accu2
                                                                          
                                                                            ::
                                                                              (
                                                                                h1
                                                                                accu
                                                                              )
                                                                          
                                                                            t1
                                                                          
                                                                            l2
                                                                        )
                                                                      )
                                                                      else
                                                                      (
                                                                          merge
                                                                          (
                                                                            
                                                                              rest
                                                                            
                                                                              accu2
                                                                            
                                                                              ::
                                                                                (
                                                                                  h2
                                                                                  accu
                                                                                )
                                                                            
                                                                              l1
                                                                            
                                                                              t2
                                                                          )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                            )
                                          in
                                            merge_rest_accu2
                                            (
                                              
                                                accu
                                              
                                                l1
                                              
                                                l2
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    merge_rev
                      (
                        case
                        (
                          rest
                          (
                            case
                            (
                              accu2
                              (
                                case
                                (
                                  accu
                                  (
                                    case
                                    (
                                      l1
                                      (
                                        case
                                        (
                                          l2
                                          let
                                          (
                                            (
                                              merge_rev_rest_accu2
                                                (
                                                  case
                                                  (
                                                    accu
                                                    (
                                                      case
                                                      (
                                                        l1
                                                        (
                                                          case
                                                          (
                                                            l2
                                                            match
                                                            l1
                                                            (
                                                              case
                                                              (
                                                                []
                                                                                                                                mergepairs_rev
                                                                (
                                                                  
                                                                    ::
                                                                      (
                                                                        @@
                                                                        (
                                                                          
                                                                            l2
                                                                          
                                                                            accu
                                                                        )
                                                                        accu2
                                                                      )
                                                                  
                                                                    rest
                                                                )
                                                              )
                                                              case
                                                              (
                                                                ::
                                                                  (
                                                                    h1
                                                                    t1
                                                                  )
                                                                match
                                                                l2
                                                                (
                                                                  case
                                                                  (
                                                                    []
                                                                                                                                        mergepairs_rev
                                                                    (
                                                                      
                                                                        ::
                                                                          (
                                                                            @@
                                                                            (
                                                                              
                                                                                l1
                                                                              
                                                                                accu
                                                                            )
                                                                            accu2
                                                                          )
                                                                      
                                                                        rest
                                                                    )
                                                                  )
                                                                  case
                                                                  (
                                                                    ::
                                                                      (
                                                                        h2
                                                                        t2
                                                                      )
                                                                    ifthenelse
                                                                    (
                                                                      if
                                                                      (
                                                                        <=
                                                                        (
                                                                          
                                                                            cmp
                                                                            (
                                                                              
                                                                                h2
                                                                              
                                                                                h1
                                                                            )
                                                                          
                                                                            0
                                                                        )
                                                                      )
                                                                      then
                                                                      (
                                                                        merge_rev
                                                                        (
                                                                          
                                                                            rest
                                                                          
                                                                            accu2
                                                                          
                                                                            ::
                                                                              (
                                                                                h1
                                                                                accu
                                                                              )
                                                                          
                                                                            t1
                                                                          
                                                                            l2
                                                                        )
                                                                      )
                                                                      else
                                                                      (
                                                                          merge_rev
                                                                          (
                                                                            
                                                                              rest
                                                                            
                                                                              accu2
                                                                            
                                                                              ::
                                                                                (
                                                                                  h2
                                                                                  accu
                                                                                )
                                                                            
                                                                              l1
                                                                            
                                                                              t2
                                                                          )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                            )
                                          in
                                            merge_rev_rest_accu2
                                            (
                                              
                                                accu
                                              
                                                l1
                                              
                                                l2
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    mergepairs
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall_rev
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall_rev
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergepairs_rev
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              []
                                                            mergeall
                              (
                                
                                  accu
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l
                                  []
                                                                  )
                              mergeall
                              (
                                
                                  ::
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                      accu
                                    )
                              )
                            )
                            case
                            (
                              ::
                                (
                                  l1
                                  ::
                                    (
                                      l2
                                      rest
                                    )
                                )
                              merge_rev
                              (
                                
                                  rest
                                
                                  accu
                                
                                  []
                                                                  
                                  l1
                                
                                  l2
                              )
                            )
                          )
                        )
                      )
                    mergeall
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          l
                        )
                        case
                        (
                          llist
                          mergepairs
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                    mergeall_rev
                      (
                        case
                        (
                          []
                                                    []
                                                  )
                        case
                        (
                          ::
                            (
                              l
                              []
                                                          )
                          List.rev
                          (
                            
                              l
                          )
                        )
                        case
                        (
                          llist
                          mergepairs_rev
                          (
                            
                              []
                                                          
                              llist
                          )
                        )
                      )
                  )
                in
                  mergeall_rev
                  (
                    
                      init
                      (
                        
                          []
                                                  
                          l
                      )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    rev_merge_append
      (
        case
        (
          order
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  (
                    case
                    (
                      acc
                      match
                      l1
                      (
                        case
                        (
                          []
                                                    List.rev_append
                          (
                            
                              l2
                            
                              acc
                          )
                        )
                        case
                        (
                          ::
                            (
                              h1
                              t1
                            )
                          match
                          l2
                          (
                            case
                            (
                              []
                                                            List.rev_append
                              (
                                
                                  l1
                                
                                  acc
                              )
                            )
                            case
                            (
                              ::
                                (
                                  h2
                                  t2
                                )
                              ifthenelse
                              (
                                if
                                (
                                  order
                                  (
                                    
                                      h1
                                    
                                      h2
                                  )
                                )
                                then
                                (
                                  rev_merge_append
                                  (
                                    
                                      order
                                    
                                      t1
                                    
                                      l2
                                    
                                      ::
                                        (
                                          h1
                                          acc
                                        )
                                  )
                                )
                                else
                                (
                                    rev_merge_append
                                    (
                                      
                                        order
                                      
                                        l1
                                      
                                        t2
                                      
                                        ::
                                          (
                                            h2
                                            acc
                                          )
                                    )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    rev_merge
      (
        case
        (
          order
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  rev_merge_append
                  (
                    
                      order
                    
                      l1
                    
                      l2
                    
                      []
                                        )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    rev_merge_append'
      (
        case
        (
          order
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  (
                    case
                    (
                      acc
                      match
                      l1
                      (
                        case
                        (
                          []
                                                    List.rev_append
                          (
                            
                              l2
                            
                              acc
                          )
                        )
                        case
                        (
                          ::
                            (
                              h1
                              t1
                            )
                          match
                          l2
                          (
                            case
                            (
                              []
                                                            List.rev_append
                              (
                                
                                  l1
                                
                                  acc
                              )
                            )
                            case
                            (
                              ::
                                (
                                  h2
                                  t2
                                )
                              ifthenelse
                              (
                                if
                                (
                                  order
                                  (
                                    
                                      h2
                                    
                                      h1
                                  )
                                )
                                then
                                (
                                  rev_merge_append'
                                  (
                                    
                                      order
                                    
                                      t1
                                    
                                      l2
                                    
                                      ::
                                        (
                                          h1
                                          acc
                                        )
                                  )
                                )
                                else
                                (
                                    rev_merge_append'
                                    (
                                      
                                        order
                                      
                                        l1
                                      
                                        t2
                                      
                                        ::
                                          (
                                            h2
                                            acc
                                          )
                                    )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    rev_merge'
      (
        case
        (
          order
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  rev_merge_append'
                  (
                    
                      order
                    
                      l1
                    
                      l2
                    
                      []
                                        )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_3
      (
        case
        (
          order
          (
            case
            (
              l
              let
              (
                (
                  initlist
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            acc
                            match
                            l
                            (
                              case
                              (
                                ::
                                  (
                                    e1
                                    ::
                                      (
                                        e2
                                        rest
                                      )
                                  )
                                initlist
                                (
                                  
                                    rest
                                  
                                    ::
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            order
                                            (
                                              
                                                e1
                                              
                                                e2
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                e1
                                                ::
                                                  (
                                                    e2
                                                    []
                                                                                                      )
                                              )
                                          )
                                          else
                                          (
                                              ::
                                                (
                                                  e2
                                                  ::
                                                    (
                                                      e1
                                                      []
                                                                                                          )
                                                )
                                          )
                                        )
                                        acc
                                      )
                                )
                              )
                              case
                              (
                                ::
                                  (
                                    e
                                    []
                                                                      )
                                ::
                                  (
                                    ::
                                      (
                                        e
                                        []
                                                                              )
                                    acc
                                  )
                              )
                              case
                              (
                                []
                                                                acc
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    merge2
                      (
                        case
                        (
                          ll
                          (
                            case
                            (
                              acc
                              match
                              ll
                              (
                                case
                                (
                                  []
                                                                    acc
                                )
                                case
                                (
                                  ::
                                    (
                                      l
                                      []
                                                                          )
                                  @
                                  (
                                    
                                      ::
                                        (
                                          List.rev
                                          (
                                            
                                              l
                                          )
                                          []
                                                                                  )
                                    
                                      acc
                                  )
                                )
                                case
                                (
                                  ::
                                    (
                                      l1
                                      ::
                                        (
                                          l2
                                          rest
                                        )
                                    )
                                  merge2
                                  (
                                    
                                      rest
                                    
                                      ::
                                        (
                                          rev_merge
                                          (
                                            
                                              order
                                            
                                              l1
                                            
                                              l2
                                          )
                                          acc
                                        )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      merge2'
                        (
                          case
                          (
                            ll
                            (
                              case
                              (
                                acc
                                match
                                ll
                                (
                                  case
                                  (
                                    []
                                                                        acc
                                  )
                                  case
                                  (
                                    ::
                                      (
                                        l
                                        []
                                                                              )
                                    @
                                    (
                                      
                                        ::
                                          (
                                            List.rev
                                            (
                                              
                                                l
                                            )
                                            []
                                                                                      )
                                      
                                        acc
                                    )
                                  )
                                  case
                                  (
                                    ::
                                      (
                                        l1
                                        ::
                                          (
                                            l2
                                            rest
                                          )
                                      )
                                    merge2'
                                    (
                                      
                                        rest
                                      
                                        ::
                                          (
                                            rev_merge'
                                            (
                                              
                                                order
                                              
                                                l1
                                              
                                                l2
                                            )
                                            acc
                                          )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        mergeall
                          (
                            case
                            (
                              rev
                              (
                                case
                                (
                                  []
                                                                    []
                                                                  )
                                case
                                (
                                  ::
                                    (
                                      l
                                      []
                                                                          )
                                  ifthenelse
                                  (
                                    if
                                    (
                                      rev
                                    )
                                    then
                                    (
                                      List.rev
                                      (
                                        
                                          l
                                      )
                                    )
                                    else
                                    (
                                        l
                                    )
                                  )
                                )
                                case
                                (
                                  llist
                                  mergeall
                                  (
                                    
                                      not
                                      (
                                        
                                          rev
                                      )
                                    
                                      ifthenelse
                                      (
                                        if
                                        (
                                          rev
                                        )
                                        then
                                        (
                                          merge2'
                                        )
                                        else
                                        (
                                            merge2
                                        )
                                      )
                                      (
                                        
                                          llist
                                        
                                          []
                                                                                )
                                  )
                                )
                              )
                            )
                          )
                      )
                    in
                      mergeall
                      (
                        
                          false
                                                  
                          initlist
                          (
                            
                              l
                            
                              []
                                                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    chop
      (
        case
        (
          k
          (
            case
            (
              l
              match
              (
                k
                l
              )
              (
                case
                (
                  (
                    0
                    _
                  )
                  l
                )
                case
                (
                  (
                    _
                    ::
                      (
                        x
                        l
                      )
                  )
                  chop
                  (
                    
                      -
                      (
                        
                          k
                        
                          1
                      )
                    
                      l
                  )
                )
                case
                (
                  (
                    _
                    _
                  )
                  assert false
                )
              )
            )
          )
        )
      )
  )
  let
  (
    merge
      (
        case
        (
          order
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  match
                  l1
                  (
                    case
                    (
                      []
                                            l2
                    )
                    case
                    (
                      ::
                        (
                          h1
                          t1
                        )
                      match
                      l2
                      (
                        case
                        (
                          []
                                                    l1
                        )
                        case
                        (
                          ::
                            (
                              h2
                              t2
                            )
                          ifthenelse
                          (
                            if
                            (
                              order
                              (
                                
                                  h1
                                
                                  h2
                              )
                            )
                            then
                            (
                              ::
                                (
                                  h1
                                  merge
                                  (
                                    
                                      order
                                    
                                      t1
                                    
                                      l2
                                  )
                                )
                            )
                            else
                            (
                                ::
                                  (
                                    h2
                                    merge
                                    (
                                      
                                        order
                                      
                                        l1
                                      
                                        t2
                                    )
                                  )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_4a
      (
        case
        (
          order
          (
            case
            (
              l
              match
              l
              (
                case
                (
                  pat_or
                  (
                  []
                                    ::
                    (
                      _
                      []
                                          )
                  )
                  l
                )
                case
                (
                  _
                  let
                  (
                    (
                      sort
                        (
                          case
                          (
                            k
                            (
                              case
                              (
                                l
                                match
                                (
                                  k
                                  l
                                )
                                (
                                  case
                                  (
                                    (
                                      2
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              _
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        order
                                        (
                                          
                                            x1
                                          
                                            x2
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x1
                                            ::
                                              (
                                                x2
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x1
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      3
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x3
                                                  _
                                                )
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        order
                                        (
                                          
                                            x1
                                          
                                            x2
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            order
                                            (
                                              
                                                x2
                                              
                                                x3
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x1
                                                ::
                                                  (
                                                    x2
                                                    ::
                                                      (
                                                        x3
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  order
                                                  (
                                                    
                                                      x1
                                                    
                                                      x3
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        x3
                                                        ::
                                                          (
                                                            x1
                                                            ::
                                                              (
                                                                x2
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              order
                                              (
                                                
                                                  x1
                                                
                                                  x3
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x2
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    order
                                                    (
                                                      
                                                        x2
                                                      
                                                        x3
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        x2
                                                        ::
                                                          (
                                                            x3
                                                            ::
                                                              (
                                                                x1
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              ::
                                                                (
                                                                  x1
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      _
                                      _
                                    )
                                    let
                                    (
                                      (
                                        k1
                                          /
                                          (
                                            
                                              k
                                            
                                              2
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          k2
                                            -
                                            (
                                              
                                                k
                                              
                                                k1
                                            )
                                        )
                                      in
                                        merge
                                        (
                                          
                                            order
                                          
                                            sort
                                            (
                                              
                                                k1
                                              
                                                l
                                            )
                                          
                                            sort
                                            (
                                              
                                                k2
                                              
                                                chop
                                                (
                                                  
                                                    k1
                                                  
                                                    l
                                                )
                                            )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    sort
                    (
                      
                        List.length
                        (
                          
                            l
                        )
                      
                        l
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    chop
      (
        case
        (
          k
          (
            case
            (
              l
              match
              (
                k
                l
              )
              (
                case
                (
                  (
                    0
                    _
                  )
                  l
                )
                case
                (
                  (
                    _
                    ::
                      (
                        x
                        l
                      )
                  )
                  chop
                  (
                    
                      -
                      (
                        
                          k
                        
                          1
                      )
                    
                      l
                  )
                )
                case
                (
                  (
                    _
                    _
                  )
                  assert false
                )
              )
            )
          )
        )
      )
  )
  let
  (
    merge
      (
        case
        (
          order
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  match
                  l1
                  (
                    case
                    (
                      []
                                            l2
                    )
                    case
                    (
                      ::
                        (
                          h1
                          t1
                        )
                      match
                      l2
                      (
                        case
                        (
                          []
                                                    l1
                        )
                        case
                        (
                          ::
                            (
                              h2
                              t2
                            )
                          ifthenelse
                          (
                            if
                            (
                              <=
                              (
                                
                                  order
                                  (
                                    
                                      h1
                                    
                                      h2
                                  )
                                
                                  0
                              )
                            )
                            then
                            (
                              ::
                                (
                                  h1
                                  merge
                                  (
                                    
                                      order
                                    
                                      t1
                                    
                                      l2
                                  )
                                )
                            )
                            else
                            (
                                ::
                                  (
                                    h2
                                    merge
                                    (
                                      
                                        order
                                      
                                        l1
                                      
                                        t2
                                    )
                                  )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_4b
      (
        case
        (
          order
          (
            case
            (
              l
              match
              l
              (
                case
                (
                  pat_or
                  (
                  []
                                    ::
                    (
                      _
                      []
                                          )
                  )
                  l
                )
                case
                (
                  _
                  let
                  (
                    (
                      sort
                        (
                          case
                          (
                            k
                            (
                              case
                              (
                                l
                                match
                                (
                                  k
                                  l
                                )
                                (
                                  case
                                  (
                                    (
                                      2
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              _
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            order
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x1
                                            ::
                                              (
                                                x2
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x1
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      3
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x3
                                                  _
                                                )
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            order
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                order
                                                (
                                                  
                                                    x2
                                                  
                                                    x3
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x1
                                                ::
                                                  (
                                                    x2
                                                    ::
                                                      (
                                                        x3
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      order
                                                      (
                                                        
                                                          x1
                                                        
                                                          x3
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        x3
                                                        ::
                                                          (
                                                            x1
                                                            ::
                                                              (
                                                                x2
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  order
                                                  (
                                                    
                                                      x1
                                                    
                                                      x3
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x2
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        order
                                                        (
                                                          
                                                            x2
                                                          
                                                            x3
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        x2
                                                        ::
                                                          (
                                                            x3
                                                            ::
                                                              (
                                                                x1
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              ::
                                                                (
                                                                  x1
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      _
                                      _
                                    )
                                    let
                                    (
                                      (
                                        k1
                                          /
                                          (
                                            
                                              k
                                            
                                              2
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          k2
                                            -
                                            (
                                              
                                                k
                                              
                                                k1
                                            )
                                        )
                                      in
                                        merge
                                        (
                                          
                                            order
                                          
                                            sort
                                            (
                                              
                                                k1
                                              
                                                l
                                            )
                                          
                                            sort
                                            (
                                              
                                                k2
                                              
                                                chop
                                                (
                                                  
                                                    k1
                                                  
                                                    l
                                                )
                                            )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    sort
                    (
                      
                        List.length
                        (
                          
                            l
                        )
                      
                        l
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    chop
      (
        case
        (
          k
          (
            case
            (
              l
              ifthenelse
              (
                if
                (
                  =
                  (
                    
                      k
                    
                      0
                  )
                )
                then
                (
                  l
                )
                else
                (
                    match
                    l
                    (
                      case
                      (
                        ::
                          (
                            x
                            t
                          )
                        chop
                        (
                          
                            -
                            (
                              
                                k
                              
                                1
                            )
                          
                            t
                        )
                      )
                      case
                      (
                        _
                        assert false
                      )
                    )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_4c
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  merge1
                    (
                      case
                      (
                        h1
                        (
                          case
                          (
                            t1
                            (
                              case
                              (
                                l2
                                match
                                l2
                                (
                                  case
                                  (
                                    []
                                                                        ::
                                      (
                                        h1
                                        t1
                                      )
                                  )
                                  case
                                  (
                                    ::
                                      (
                                        h2
                                        t2
                                      )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                h1
                                              
                                                h2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            h1
                                            merge2
                                            (
                                              
                                                t1
                                              
                                                h2
                                              
                                                t2
                                            )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              h2
                                              merge1
                                              (
                                                
                                                  h1
                                                
                                                  t1
                                                
                                                  t2
                                              )
                                            )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  merge2
                    (
                      case
                      (
                        l1
                        (
                          case
                          (
                            h2
                            (
                              case
                              (
                                t2
                                match
                                l1
                                (
                                  case
                                  (
                                    []
                                                                        ::
                                      (
                                        h2
                                        t2
                                      )
                                  )
                                  case
                                  (
                                    ::
                                      (
                                        h1
                                        t1
                                      )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                h1
                                              
                                                h2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            h1
                                            merge2
                                            (
                                              
                                                t1
                                              
                                                h2
                                              
                                                t2
                                            )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              h2
                                              merge1
                                              (
                                                
                                                  h1
                                                
                                                  t1
                                                
                                                  t2
                                              )
                                            )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    merge
                      (
                        case
                        (
                          l1
                          (
                            case
                            (
                              []
                                                            l1
                            )
                            case
                            (
                              ::
                                (
                                  h2
                                  t2
                                )
                              merge2
                              (
                                
                                  l1
                                
                                  h2
                                
                                  t2
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sort
                        (
                          case
                          (
                            n
                            (
                              case
                              (
                                l
                                match
                                (
                                  n
                                  l
                                )
                                (
                                  case
                                  (
                                    (
                                      2
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              _
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x1
                                            ::
                                              (
                                                x2
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x1
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      3
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x3
                                                  _
                                                )
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    x2
                                                  
                                                    x3
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x1
                                                ::
                                                  (
                                                    x2
                                                    ::
                                                      (
                                                        x3
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          x1
                                                        
                                                          x3
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        x3
                                                        ::
                                                          (
                                                            x1
                                                            ::
                                                              (
                                                                x2
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      x1
                                                    
                                                      x3
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x2
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            x2
                                                          
                                                            x3
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        x2
                                                        ::
                                                          (
                                                            x3
                                                            ::
                                                              (
                                                                x1
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              ::
                                                                (
                                                                  x1
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      n
                                      l
                                    )
                                    let
                                    (
                                      (
                                        n1
                                          asr
                                          (
                                            
                                              n
                                            
                                              1
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          n2
                                            -
                                            (
                                              
                                                n
                                              
                                                n1
                                            )
                                        )
                                      in
                                        merge
                                        (
                                          
                                            sort
                                            (
                                              
                                                n1
                                              
                                                l
                                            )
                                          
                                            sort
                                            (
                                              
                                                n2
                                              
                                                chop
                                                (
                                                  
                                                    n1
                                                  
                                                    l
                                                )
                                            )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        len
                          List.length
                          (
                            
                              l
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <
                          (
                            
                              len
                            
                              2
                          )
                        )
                        then
                        (
                          l
                        )
                        else
                        (
                            sort
                            (
                              
                                len
                              
                                l
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    chop
      (
        case
        (
          k
          (
            case
            (
              l
              ifthenelse
              (
                if
                (
                  =
                  (
                    
                      k
                    
                      0
                  )
                )
                then
                (
                  l
                )
                else
                (
                    match
                    l
                    (
                      case
                      (
                        ::
                          (
                            x
                            t
                          )
                        chop
                        (
                          
                            -
                            (
                              
                                k
                              
                                1
                            )
                          
                            t
                        )
                      )
                      case
                      (
                        _
                        assert false
                      )
                    )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_4d
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  rev_merge
                    (
                      case
                      (
                        l1
                        (
                          case
                          (
                            l2
                            (
                              case
                              (
                                accu
                                match
                                (
                                  l1
                                  l2
                                )
                                (
                                  case
                                  (
                                    (
                                      []
                                                                            l2
                                    )
                                    @@
                                    (
                                      
                                        l2
                                      
                                        accu
                                    )
                                  )
                                  case
                                  (
                                    (
                                      l1
                                      []
                                                                          )
                                    @@
                                    (
                                      
                                        l1
                                      
                                        accu
                                    )
                                  )
                                  case
                                  (
                                    (
                                      ::
                                        (
                                          h1
                                          t1
                                        )
                                      ::
                                        (
                                          h2
                                          t2
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                h1
                                              
                                                h2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        rev_merge
                                        (
                                          
                                            t1
                                          
                                            l2
                                          
                                            ::
                                              (
                                                h1
                                                accu
                                              )
                                        )
                                      )
                                      else
                                      (
                                          rev_merge
                                          (
                                            
                                              l1
                                            
                                              t2
                                            
                                              ::
                                                (
                                                  h2
                                                  accu
                                                )
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    rev_merge_rev
                      (
                        case
                        (
                          l1
                          (
                            case
                            (
                              l2
                              (
                                case
                                (
                                  accu
                                  match
                                  (
                                    l1
                                    l2
                                  )
                                  (
                                    case
                                    (
                                      (
                                        []
                                                                                l2
                                      )
                                      @@
                                      (
                                        
                                          l2
                                        
                                          accu
                                      )
                                    )
                                    case
                                    (
                                      (
                                        l1
                                        []
                                                                              )
                                      @@
                                      (
                                        
                                          l1
                                        
                                          accu
                                      )
                                    )
                                    case
                                    (
                                      (
                                        ::
                                          (
                                            h1
                                            t1
                                          )
                                        ::
                                          (
                                            h2
                                            t2
                                          )
                                      )
                                      ifthenelse
                                      (
                                        if
                                        (
                                          >
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  h1
                                                
                                                  h2
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          rev_merge_rev
                                          (
                                            
                                              t1
                                            
                                              l2
                                            
                                              ::
                                                (
                                                  h1
                                                  accu
                                                )
                                          )
                                        )
                                        else
                                        (
                                            rev_merge_rev
                                            (
                                              
                                                l1
                                              
                                                t2
                                              
                                                ::
                                                  (
                                                    h2
                                                    accu
                                                  )
                                            )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sort
                        (
                          case
                          (
                            n
                            (
                              case
                              (
                                l
                                match
                                (
                                  n
                                  l
                                )
                                (
                                  case
                                  (
                                    (
                                      2
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              _
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x1
                                            ::
                                              (
                                                x2
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x1
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      3
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x3
                                                  _
                                                )
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    x2
                                                  
                                                    x3
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x1
                                                ::
                                                  (
                                                    x2
                                                    ::
                                                      (
                                                        x3
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          x1
                                                        
                                                          x3
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        x3
                                                        ::
                                                          (
                                                            x1
                                                            ::
                                                              (
                                                                x2
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      x1
                                                    
                                                      x3
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x2
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            x2
                                                          
                                                            x3
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        x2
                                                        ::
                                                          (
                                                            x3
                                                            ::
                                                              (
                                                                x1
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              ::
                                                                (
                                                                  x1
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      n
                                      l
                                    )
                                    let
                                    (
                                      (
                                        n1
                                          asr
                                          (
                                            
                                              n
                                            
                                              1
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          n2
                                            -
                                            (
                                              
                                                n
                                              
                                                n1
                                            )
                                        )
                                      in
                                        rev_merge_rev
                                        (
                                          
                                            rev_sort
                                            (
                                              
                                                n1
                                              
                                                l
                                            )
                                          
                                            rev_sort
                                            (
                                              
                                                n2
                                              
                                                chop
                                                (
                                                  
                                                    n1
                                                  
                                                    l
                                                )
                                            )
                                          
                                            []
                                                                                    )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      rev_sort
                        (
                          case
                          (
                            n
                            (
                              case
                              (
                                l
                                match
                                (
                                  n
                                  l
                                )
                                (
                                  case
                                  (
                                    (
                                      2
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              _
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x1
                                            ::
                                              (
                                                x2
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x1
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      3
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x3
                                                  _
                                                )
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    x2
                                                  
                                                    x3
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x1
                                                ::
                                                  (
                                                    x2
                                                    ::
                                                      (
                                                        x3
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          x1
                                                        
                                                          x3
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        x3
                                                        ::
                                                          (
                                                            x1
                                                            ::
                                                              (
                                                                x2
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      x1
                                                    
                                                      x3
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x2
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            x2
                                                          
                                                            x3
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        x2
                                                        ::
                                                          (
                                                            x3
                                                            ::
                                                              (
                                                                x1
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              ::
                                                                (
                                                                  x1
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      n
                                      l
                                    )
                                    let
                                    (
                                      (
                                        n1
                                          asr
                                          (
                                            
                                              n
                                            
                                              1
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          n2
                                            -
                                            (
                                              
                                                n
                                              
                                                n1
                                            )
                                        )
                                      in
                                        rev_merge
                                        (
                                          
                                            sort
                                            (
                                              
                                                n1
                                              
                                                l
                                            )
                                          
                                            sort
                                            (
                                              
                                                n2
                                              
                                                chop
                                                (
                                                  
                                                    n1
                                                  
                                                    l
                                                )
                                            )
                                          
                                            []
                                                                                    )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        len
                          List.length
                          (
                            
                              l
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <
                          (
                            
                              len
                            
                              2
                          )
                        )
                        then
                        (
                          l
                        )
                        else
                        (
                            sort
                            (
                              
                                len
                              
                                l
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    chop
      (
        case
        (
          k
          (
            case
            (
              l
              ifthenelse
              (
                if
                (
                  =
                  (
                    
                      k
                    
                      0
                  )
                )
                then
                (
                  l
                )
                else
                (
                    match
                    l
                    (
                      case
                      (
                        ::
                          (
                            x
                            t
                          )
                        chop
                        (
                          
                            -
                            (
                              
                                k
                              
                                1
                            )
                          
                            t
                        )
                      )
                      case
                      (
                        _
                        assert false
                      )
                    )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_4e
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  rev_merge
                    (
                      case
                      (
                        l1
                        (
                          case
                          (
                            l2
                            (
                              case
                              (
                                accu
                                match
                                (
                                  l1
                                  l2
                                )
                                (
                                  case
                                  (
                                    (
                                      []
                                                                            l2
                                    )
                                    @@
                                    (
                                      
                                        l2
                                      
                                        accu
                                    )
                                  )
                                  case
                                  (
                                    (
                                      l1
                                      []
                                                                          )
                                    @@
                                    (
                                      
                                        l1
                                      
                                        accu
                                    )
                                  )
                                  case
                                  (
                                    (
                                      ::
                                        (
                                          h1
                                          t1
                                        )
                                      ::
                                        (
                                          h2
                                          t2
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                h1
                                              
                                                h2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        rev_merge
                                        (
                                          
                                            t1
                                          
                                            l2
                                          
                                            ::
                                              (
                                                h1
                                                accu
                                              )
                                        )
                                      )
                                      else
                                      (
                                          rev_merge
                                          (
                                            
                                              l1
                                            
                                              t2
                                            
                                              ::
                                                (
                                                  h2
                                                  accu
                                                )
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    rev_merge_rev
                      (
                        case
                        (
                          l1
                          (
                            case
                            (
                              l2
                              (
                                case
                                (
                                  accu
                                  match
                                  (
                                    l1
                                    l2
                                  )
                                  (
                                    case
                                    (
                                      (
                                        []
                                                                                l2
                                      )
                                      @@
                                      (
                                        
                                          l2
                                        
                                          accu
                                      )
                                    )
                                    case
                                    (
                                      (
                                        l1
                                        []
                                                                              )
                                      @@
                                      (
                                        
                                          l1
                                        
                                          accu
                                      )
                                    )
                                    case
                                    (
                                      (
                                        ::
                                          (
                                            h1
                                            t1
                                          )
                                        ::
                                          (
                                            h2
                                            t2
                                          )
                                      )
                                      ifthenelse
                                      (
                                        if
                                        (
                                          >
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  h1
                                                
                                                  h2
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          rev_merge_rev
                                          (
                                            
                                              t1
                                            
                                              l2
                                            
                                              ::
                                                (
                                                  h1
                                                  accu
                                                )
                                          )
                                        )
                                        else
                                        (
                                            rev_merge_rev
                                            (
                                              
                                                l1
                                              
                                                t2
                                              
                                                ::
                                                  (
                                                    h2
                                                    accu
                                                  )
                                            )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sort
                        (
                          case
                          (
                            n
                            (
                              case
                              (
                                l
                                match
                                (
                                  n
                                  l
                                )
                                (
                                  case
                                  (
                                    (
                                      2
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              _
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x1
                                            ::
                                              (
                                                x2
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x1
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      3
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x3
                                                  _
                                                )
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    x2
                                                  
                                                    x3
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x1
                                                ::
                                                  (
                                                    x2
                                                    ::
                                                      (
                                                        x3
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          x1
                                                        
                                                          x3
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        x3
                                                        ::
                                                          (
                                                            x1
                                                            ::
                                                              (
                                                                x2
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      x1
                                                    
                                                      x3
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x2
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            x2
                                                          
                                                            x3
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        x2
                                                        ::
                                                          (
                                                            x3
                                                            ::
                                                              (
                                                                x1
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              ::
                                                                (
                                                                  x1
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      n
                                      l
                                    )
                                    let
                                    (
                                      (
                                        n1
                                          asr
                                          (
                                            
                                              n
                                            
                                              1
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          n2
                                            -
                                            (
                                              
                                                n
                                              
                                                n1
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            l2
                                              chop
                                              (
                                                
                                                  n1
                                                
                                                  l
                                              )
                                          )
                                        in
                                          let
                                          (
                                            (
                                              s1
                                                rev_sort
                                                (
                                                  
                                                    n1
                                                  
                                                    l
                                                )
                                            )
                                          in
                                            let
                                            (
                                              (
                                                s2
                                                  rev_sort
                                                  (
                                                    
                                                      n2
                                                    
                                                      l2
                                                  )
                                              )
                                            in
                                              rev_merge_rev
                                              (
                                                
                                                  s1
                                                
                                                  s2
                                                
                                                  []
                                                                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      rev_sort
                        (
                          case
                          (
                            n
                            (
                              case
                              (
                                l
                                match
                                (
                                  n
                                  l
                                )
                                (
                                  case
                                  (
                                    (
                                      2
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              _
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x1
                                            ::
                                              (
                                                x2
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x1
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      3
                                      ::
                                        (
                                          x1
                                          ::
                                            (
                                              x2
                                              ::
                                                (
                                                  x3
                                                  _
                                                )
                                            )
                                        )
                                    )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x1
                                              
                                                x2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    x2
                                                  
                                                    x3
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x1
                                                ::
                                                  (
                                                    x2
                                                    ::
                                                      (
                                                        x3
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          x1
                                                        
                                                          x3
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        x3
                                                        ::
                                                          (
                                                            x1
                                                            ::
                                                              (
                                                                x2
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      x1
                                                    
                                                      x3
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x2
                                                  ::
                                                    (
                                                      x1
                                                      ::
                                                        (
                                                          x3
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            x2
                                                          
                                                            x3
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        x2
                                                        ::
                                                          (
                                                            x3
                                                            ::
                                                              (
                                                                x1
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          x3
                                                          ::
                                                            (
                                                              x2
                                                              ::
                                                                (
                                                                  x1
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  case
                                  (
                                    (
                                      n
                                      l
                                    )
                                    let
                                    (
                                      (
                                        n1
                                          asr
                                          (
                                            
                                              n
                                            
                                              1
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          n2
                                            -
                                            (
                                              
                                                n
                                              
                                                n1
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            l2
                                              chop
                                              (
                                                
                                                  n1
                                                
                                                  l
                                              )
                                          )
                                        in
                                          let
                                          (
                                            (
                                              s1
                                                sort
                                                (
                                                  
                                                    n1
                                                  
                                                    l
                                                )
                                            )
                                          in
                                            let
                                            (
                                              (
                                                s2
                                                  sort
                                                  (
                                                    
                                                      n2
                                                    
                                                      l2
                                                  )
                                              )
                                            in
                                              rev_merge
                                              (
                                                
                                                  s1
                                                
                                                  s2
                                                
                                                  []
                                                                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        len
                          List.length
                          (
                            
                              l
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <
                          (
                            
                              len
                            
                              2
                          )
                        )
                        then
                        (
                          l
                        )
                        else
                        (
                            sort
                            (
                              
                                len
                              
                                l
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    merge
      (
        case
        (
          cmp
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  match
                  (
                    l1
                    l2
                  )
                  (
                    case
                    (
                      (
                        []
                                                l2
                      )
                      l2
                    )
                    case
                    (
                      (
                        l1
                        []
                                              )
                      l1
                    )
                    case
                    (
                      (
                        ::
                          (
                            h1
                            t1
                          )
                        ::
                          (
                            h2
                            t2
                          )
                      )
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              cmp
                              (
                                
                                  h1
                                
                                  h2
                              )
                            
                              0
                          )
                        )
                        then
                        (
                          ::
                            (
                              h1
                              merge
                              (
                                
                                  cmp
                                
                                  t1
                                
                                  l2
                              )
                            )
                        )
                        else
                        (
                            ::
                              (
                                h2
                                merge
                                (
                                  
                                    cmp
                                  
                                    l1
                                  
                                    t2
                                )
                              )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_5a
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  rem
                    ref
                    (
                      
                        l
                    )
                )
              in
                let
                (
                  (
                    sort_prefix
                      (
                        case
                        (
                          n
                          ifthenelse
                          (
                            if
                            (
                              <=
                              (
                                
                                  n
                                
                                  1
                              )
                            )
                            then
                            (
                              match
                              !
                              (
                                
                                  rem
                              )
                              (
                                case
                                (
                                  []
                                                                    []
                                                                  )
                                case
                                (
                                  alias l
                                  (
                                    ::
                                      (
                                        x
                                        []
                                                                              )
                                  )
                                  sequence
                                  (
                                    :=
                                    (
                                      
                                        rem
                                      
                                        []
                                                                            )
                                  ;
                                    l
                                  )
                                )
                                case
                                (
                                  ::
                                    (
                                      x
                                      ::
                                        (
                                          y
                                          t
                                        )
                                    )
                                  sequence
                                  (
                                    :=
                                    (
                                      
                                        rem
                                      
                                        t
                                    )
                                  ;
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x
                                              
                                                y
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x
                                            ::
                                              (
                                                y
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              y
                                              ::
                                                (
                                                  x
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                            else
                            (
                                ifthenelse
                                (
                                  if
                                  (
                                    =
                                    (
                                      
                                        !
                                        (
                                          
                                            rem
                                        )
                                      
                                        []
                                                                            )
                                  )
                                  then
                                  (
                                    []
                                                                      )
                                  else
                                  (
                                      let
                                      (
                                        (
                                          l1
                                            sort_prefix
                                            (
                                              
                                                -
                                                (
                                                  
                                                    n
                                                  
                                                    1
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            l2
                                              sort_prefix
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      n
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          merge
                                          (
                                            
                                              cmp
                                            
                                              l1
                                            
                                              l2
                                          )
                                        )
                                      )
                                  )
                                )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      len
                        ref
                        (
                          
                            List.length
                            (
                              
                                l
                            )
                        )
                    )
                  in
                    let
                    (
                      (
                        i
                          ref
                          (
                            
                              0
                          )
                      )
                    in
                      sequence
                      (
                        while
                        >
                        (
                          
                            !
                            (
                              
                                len
                            )
                          
                            0
                        )
                        sequence
                        (
                          incr
                          (
                            
                              i
                          )
                        ;
                          :=
                          (
                            
                              len
                            
                              lsr
                              (
                                
                                  !
                                  (
                                    
                                      len
                                  )
                                
                                  1
                              )
                          )
                        )
                      ;
                        sort_prefix
                        (
                          
                            !
                            (
                              
                                i
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    merge
      (
        case
        (
          cmp
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  match
                  (
                    l1
                    l2
                  )
                  (
                    case
                    (
                      (
                        []
                                                l2
                      )
                      l2
                    )
                    case
                    (
                      (
                        l1
                        []
                                              )
                      l1
                    )
                    case
                    (
                      (
                        ::
                          (
                            h1
                            t1
                          )
                        ::
                          (
                            h2
                            t2
                          )
                      )
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              cmp
                              (
                                
                                  h1
                                
                                  h2
                              )
                            
                              0
                          )
                        )
                        then
                        (
                          ::
                            (
                              h1
                              merge
                              (
                                
                                  cmp
                                
                                  t1
                                
                                  l2
                              )
                            )
                        )
                        else
                        (
                            ::
                              (
                                h2
                                merge
                                (
                                  
                                    cmp
                                  
                                    l1
                                  
                                    t2
                                )
                              )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_5b
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  rem
                    ref
                    (
                      
                        l
                    )
                )
              in
                let
                (
                  (
                    sort_prefix
                      (
                        case
                        (
                          n
                          match
                          (
                            n
                            !
                            (
                              
                                rem
                            )
                          )
                          (
                            case
                            (
                              (
                                1
                                ::
                                  (
                                    x
                                    t
                                  )
                              )
                              sequence
                              (
                                :=
                                (
                                  
                                    rem
                                  
                                    t
                                )
                              ;
                                ::
                                  (
                                    x
                                    []
                                                                      )
                              )
                            )
                            case
                            (
                              (
                                2
                                ::
                                  (
                                    x
                                    ::
                                      (
                                        y
                                        t
                                      )
                                  )
                              )
                              sequence
                              (
                                :=
                                (
                                  
                                    rem
                                  
                                    t
                                )
                              ;
                                ifthenelse
                                (
                                  if
                                  (
                                    <=
                                    (
                                      
                                        cmp
                                        (
                                          
                                            x
                                          
                                            y
                                        )
                                      
                                        0
                                    )
                                  )
                                  then
                                  (
                                    ::
                                      (
                                        x
                                        ::
                                          (
                                            y
                                            []
                                                                                      )
                                      )
                                  )
                                  else
                                  (
                                      ::
                                        (
                                          y
                                          ::
                                            (
                                              x
                                              []
                                                                                          )
                                        )
                                  )
                                )
                              )
                            )
                            case
                            (
                              (
                                n
                                _
                              )
                              let
                              (
                                (
                                  n1
                                    /
                                    (
                                      
                                        n
                                      
                                        2
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    n2
                                      -
                                      (
                                        
                                          n
                                        
                                          n1
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      l1
                                        sort_prefix
                                        (
                                          
                                            n1
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        l2
                                          sort_prefix
                                          (
                                            
                                              n2
                                          )
                                      )
                                    in
                                      merge
                                      (
                                        
                                          cmp
                                        
                                          l1
                                        
                                          l2
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      len
                        List.length
                        (
                          
                            l
                        )
                    )
                  in
                    ifthenelse
                    (
                      if
                      (
                        <=
                        (
                          
                            len
                          
                            1
                        )
                      )
                      then
                      (
                        l
                      )
                      else
                      (
                          sort_prefix
                          (
                            
                              len
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    merge
      (
        case
        (
          cmp
          (
            case
            (
              l1
              (
                case
                (
                  l2
                  match
                  (
                    l1
                    l2
                  )
                  (
                    case
                    (
                      (
                        []
                                                l2
                      )
                      l2
                    )
                    case
                    (
                      (
                        l1
                        []
                                              )
                      l1
                    )
                    case
                    (
                      (
                        ::
                          (
                            h1
                            t1
                          )
                        ::
                          (
                            h2
                            t2
                          )
                      )
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              cmp
                              (
                                
                                  h1
                                
                                  h2
                              )
                            
                              0
                          )
                        )
                        then
                        (
                          ::
                            (
                              h1
                              merge
                              (
                                
                                  cmp
                                
                                  t1
                                
                                  l2
                              )
                            )
                        )
                        else
                        (
                            ::
                              (
                                h2
                                merge
                                (
                                  
                                    cmp
                                  
                                    l1
                                  
                                    t2
                                )
                              )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_5c
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  rem
                    ref
                    (
                      
                        l
                    )
                )
              in
                let
                (
                  (
                    sort_prefix
                      (
                        case
                        (
                          n
                          match
                          (
                            n
                            !
                            (
                              
                                rem
                            )
                          )
                          (
                            case
                            (
                              (
                                2
                                ::
                                  (
                                    x
                                    ::
                                      (
                                        y
                                        t
                                      )
                                  )
                              )
                              sequence
                              (
                                :=
                                (
                                  
                                    rem
                                  
                                    t
                                )
                              ;
                                ifthenelse
                                (
                                  if
                                  (
                                    <=
                                    (
                                      
                                        cmp
                                        (
                                          
                                            x
                                          
                                            y
                                        )
                                      
                                        0
                                    )
                                  )
                                  then
                                  (
                                    ::
                                      (
                                        x
                                        ::
                                          (
                                            y
                                            []
                                                                                      )
                                      )
                                  )
                                  else
                                  (
                                      ::
                                        (
                                          y
                                          ::
                                            (
                                              x
                                              []
                                                                                          )
                                        )
                                  )
                                )
                              )
                            )
                            case
                            (
                              (
                                3
                                ::
                                  (
                                    x
                                    ::
                                      (
                                        y
                                        ::
                                          (
                                            z
                                            t
                                          )
                                      )
                                  )
                              )
                              sequence
                              (
                                :=
                                (
                                  
                                    rem
                                  
                                    t
                                )
                              ;
                                ifthenelse
                                (
                                  if
                                  (
                                    <=
                                    (
                                      
                                        cmp
                                        (
                                          
                                            x
                                          
                                            y
                                        )
                                      
                                        0
                                    )
                                  )
                                  then
                                  (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                y
                                              
                                                z
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x
                                            ::
                                              (
                                                y
                                                ::
                                                  (
                                                    z
                                                    []
                                                                                                      )
                                              )
                                          )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      x
                                                    
                                                      z
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  x
                                                  ::
                                                    (
                                                      z
                                                      ::
                                                        (
                                                          y
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ::
                                                  (
                                                    z
                                                    ::
                                                      (
                                                        x
                                                        ::
                                                          (
                                                            y
                                                            []
                                                                                                                      )
                                                      )
                                                  )
                                            )
                                          )
                                      )
                                    )
                                  )
                                  else
                                  (
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  x
                                                
                                                  z
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ::
                                            (
                                              y
                                              ::
                                                (
                                                  x
                                                  ::
                                                    (
                                                      z
                                                      []
                                                                                                          )
                                                )
                                            )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        y
                                                      
                                                        z
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                ::
                                                  (
                                                    y
                                                    ::
                                                      (
                                                        z
                                                        ::
                                                          (
                                                            x
                                                            []
                                                                                                                      )
                                                      )
                                                  )
                                              )
                                              else
                                              (
                                                  ::
                                                    (
                                                      z
                                                      ::
                                                        (
                                                          y
                                                          ::
                                                            (
                                                              x
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                              )
                                            )
                                        )
                                      )
                                  )
                                )
                              )
                            )
                            case
                            (
                              (
                                n
                                _
                              )
                              let
                              (
                                (
                                  n1
                                    /
                                    (
                                      
                                        n
                                      
                                        2
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    n2
                                      -
                                      (
                                        
                                          n
                                        
                                          n1
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      l1
                                        sort_prefix
                                        (
                                          
                                            n1
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        l2
                                          sort_prefix
                                          (
                                            
                                              n2
                                          )
                                      )
                                    in
                                      merge
                                      (
                                        
                                          cmp
                                        
                                          l1
                                        
                                          l2
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      len
                        List.length
                        (
                          
                            l
                        )
                    )
                  in
                    ifthenelse
                    (
                      if
                      (
                        <=
                        (
                          
                            len
                          
                            1
                        )
                      )
                      then
                      (
                        l
                      )
                      else
                      (
                          sort_prefix
                          (
                            
                              len
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_5d
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  merge1
                    (
                      case
                      (
                        h1
                        (
                          case
                          (
                            t1
                            (
                              case
                              (
                                l2
                                match
                                l2
                                (
                                  case
                                  (
                                    []
                                                                        ::
                                      (
                                        h1
                                        t1
                                      )
                                  )
                                  case
                                  (
                                    ::
                                      (
                                        h2
                                        t2
                                      )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                h1
                                              
                                                h2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            h1
                                            merge2
                                            (
                                              
                                                t1
                                              
                                                h2
                                              
                                                t2
                                            )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              h2
                                              merge1
                                              (
                                                
                                                  h1
                                                
                                                  t1
                                                
                                                  t2
                                              )
                                            )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  merge2
                    (
                      case
                      (
                        l1
                        (
                          case
                          (
                            h2
                            (
                              case
                              (
                                t2
                                match
                                l1
                                (
                                  case
                                  (
                                    []
                                                                        ::
                                      (
                                        h2
                                        t2
                                      )
                                  )
                                  case
                                  (
                                    ::
                                      (
                                        h1
                                        t1
                                      )
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                h1
                                              
                                                h2
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            h1
                                            merge2
                                            (
                                              
                                                t1
                                              
                                                h2
                                              
                                                t2
                                            )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              h2
                                              merge1
                                              (
                                                
                                                  h1
                                                
                                                  t1
                                                
                                                  t2
                                              )
                                            )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    sort_prefix
                      (
                        case
                        (
                          n
                          (
                            case
                            (
                              l
                              match
                              (
                                n
                                l
                              )
                              (
                                case
                                (
                                  (
                                    2
                                    ::
                                      (
                                        x
                                        ::
                                          (
                                            y
                                            t
                                          )
                                      )
                                  )
                                  (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x
                                              
                                                y
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ::
                                          (
                                            x
                                            ::
                                              (
                                                y
                                                []
                                                                                              )
                                          )
                                      )
                                      else
                                      (
                                          ::
                                            (
                                              y
                                              ::
                                                (
                                                  x
                                                  []
                                                                                                  )
                                            )
                                      )
                                    )
                                    t
                                  )
                                )
                                case
                                (
                                  (
                                    3
                                    ::
                                      (
                                        x
                                        ::
                                          (
                                            y
                                            ::
                                              (
                                                z
                                                t
                                              )
                                          )
                                      )
                                  )
                                  (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <=
                                        (
                                          
                                            cmp
                                            (
                                              
                                                x
                                              
                                                y
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            ::
                                              (
                                                x
                                                ::
                                                  (
                                                    y
                                                    ::
                                                      (
                                                        z
                                                        []
                                                                                                              )
                                                  )
                                              )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <=
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          x
                                                        
                                                          z
                                                      )
                                                    
                                                      0
                                                  )
                                                )
                                                then
                                                (
                                                  ::
                                                    (
                                                      x
                                                      ::
                                                        (
                                                          z
                                                          ::
                                                            (
                                                              y
                                                              []
                                                                                                                          )
                                                        )
                                                    )
                                                )
                                                else
                                                (
                                                    ::
                                                      (
                                                        z
                                                        ::
                                                          (
                                                            x
                                                            ::
                                                              (
                                                                y
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                )
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      x
                                                    
                                                      z
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              ::
                                                (
                                                  y
                                                  ::
                                                    (
                                                      x
                                                      ::
                                                        (
                                                          z
                                                          []
                                                                                                                  )
                                                    )
                                                )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            y
                                                          
                                                            z
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ::
                                                      (
                                                        y
                                                        ::
                                                          (
                                                            z
                                                            ::
                                                              (
                                                                x
                                                                []
                                                                                                                              )
                                                          )
                                                      )
                                                  )
                                                  else
                                                  (
                                                      ::
                                                        (
                                                          z
                                                          ::
                                                            (
                                                              y
                                                              ::
                                                                (
                                                                  x
                                                                  []
                                                                                                                                  )
                                                            )
                                                        )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                    t
                                  )
                                )
                                case
                                (
                                  (
                                    n
                                    _
                                  )
                                  let
                                  (
                                    (
                                      n1
                                        /
                                        (
                                          
                                            n
                                          
                                            2
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        n2
                                          -
                                          (
                                            
                                              n
                                            
                                              n1
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          (
                                            l1
                                            rest1
                                          )
                                            sort_prefix
                                            (
                                              
                                                n1
                                              
                                                l
                                            )
                                        )
                                      in
                                        match
                                        sort_prefix
                                        (
                                          
                                            n2
                                          
                                            rest1
                                        )
                                        (
                                          case
                                          (
                                            (
                                              ::
                                                (
                                                  h2
                                                  t2
                                                )
                                              rest2
                                            )
                                            (
                                              merge2
                                              (
                                                
                                                  l1
                                                
                                                  h2
                                                
                                                  t2
                                              )
                                              rest2
                                            )
                                          )
                                          case
                                          (
                                            _
                                            assert false
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      len
                        List.length
                        (
                          
                            l
                        )
                    )
                  in
                    ifthenelse
                    (
                      if
                      (
                        <=
                        (
                          
                            len
                          
                            1
                        )
                      )
                      then
                      (
                        l
                      )
                      else
                      (
                          fst
                          (
                            
                              sort_prefix
                              (
                                
                                  len
                                
                                  l
                              )
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    amerge_1a
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    sortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      sequence
                                      (
                                        assert                                        >
                                        (
                                          
                                            len
                                          
                                            0
                                        )
                                        
                                      ;
                                        ifthenelse
                                        (
                                          if
                                          (
                                            =
                                            (
                                              
                                                len
                                              
                                                1
                                            )
                                          )
                                          then
                                          (
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    srcofs
                                                )
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      l
                        Array.length
                        (
                          
                            a
                        )
                    )
                  in
                    ifthenelse
                    (
                      if
                      (
                        <=
                        (
                          
                            l
                          
                            1
                        )
                      )
                      then
                      (
                        ()
                                              )
                      else
                      (
                          let
                          (
                            (
                              l1
                                /
                                (
                                  
                                    l
                                  
                                    2
                                )
                            )
                          in
                            let
                            (
                              (
                                l2
                                  -
                                  (
                                    
                                      l
                                    
                                      l1
                                  )
                              )
                            in
                              let
                              (
                                (
                                  t
                                    Array.make
                                    (
                                      
                                        l2
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                )
                              in
                                sequence
                                (
                                  sortto
                                  (
                                    
                                      l1
                                    
                                      t
                                    
                                      0
                                    
                                      l2
                                  )
                                ;
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        0
                                      
                                        a
                                      
                                        l2
                                      
                                        l1
                                    )
                                  ;
                                    merge
                                    (
                                      
                                        l2
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                      
                                        a
                                      
                                        0
                                    )
                                  )
                                )
                              )
                            )
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    amerge_1b
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    sortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      sequence
                                      (
                                        assert                                        >
                                        (
                                          
                                            len
                                          
                                            0
                                        )
                                        
                                      ;
                                        ifthenelse
                                        (
                                          if
                                          (
                                            =
                                            (
                                              
                                                len
                                              
                                                1
                                            )
                                          )
                                          then
                                          (
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    srcofs
                                                )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  =
                                                  (
                                                    
                                                      len
                                                    
                                                      2
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  srcofs
                                                              )
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  +
                                                                  (
                                                                    
                                                                      srcofs
                                                                    
                                                                      1
                                                                  )
                                                              )
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            dst
                                                          
                                                            dstofs
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                srcofs
                                                            )
                                                        )
                                                      ;
                                                        Array.set
                                                        (
                                                          
                                                            dst
                                                          
                                                            +
                                                            (
                                                              
                                                                dstofs
                                                              
                                                                1
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                +
                                                                (
                                                                  
                                                                    srcofs
                                                                  
                                                                    1
                                                                )
                                                            )
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              dst
                                                            
                                                              dstofs
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  +
                                                                  (
                                                                    
                                                                      srcofs
                                                                    
                                                                      1
                                                                  )
                                                              )
                                                          )
                                                        ;
                                                          Array.set
                                                          (
                                                            
                                                              dst
                                                            
                                                              +
                                                              (
                                                                
                                                                  dstofs
                                                                
                                                                  1
                                                              )
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  srcofs
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    let
                                                    (
                                                      (
                                                        l1
                                                          /
                                                          (
                                                            
                                                              len
                                                            
                                                              2
                                                          )
                                                      )
                                                    in
                                                      let
                                                      (
                                                        (
                                                          l2
                                                            -
                                                            (
                                                              
                                                                len
                                                              
                                                                l1
                                                            )
                                                        )
                                                      in
                                                        sequence
                                                        (
                                                          sortto
                                                          (
                                                            
                                                              +
                                                              (
                                                                
                                                                  srcofs
                                                                
                                                                  l1
                                                              )
                                                            
                                                              dst
                                                            
                                                              +
                                                              (
                                                                
                                                                  dstofs
                                                                
                                                                  l1
                                                              )
                                                            
                                                              l2
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            sortto
                                                            (
                                                              
                                                                srcofs
                                                              
                                                                a
                                                              
                                                                +
                                                                (
                                                                  
                                                                    srcofs
                                                                  
                                                                    l2
                                                                )
                                                              
                                                                l1
                                                            )
                                                          ;
                                                            merge
                                                            (
                                                              
                                                                +
                                                                (
                                                                  
                                                                    srcofs
                                                                  
                                                                    l2
                                                                )
                                                              
                                                                l1
                                                              
                                                                dst
                                                              
                                                                +
                                                                (
                                                                  
                                                                    dstofs
                                                                  
                                                                    l1
                                                                )
                                                              
                                                                l2
                                                              
                                                                dst
                                                              
                                                                dstofs
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      l
                        Array.length
                        (
                          
                            a
                        )
                    )
                  in
                    ifthenelse
                    (
                      if
                      (
                        <=
                        (
                          
                            l
                          
                            1
                        )
                      )
                      then
                      (
                        ()
                                              )
                      else
                      (
                          ifthenelse
                          (
                            if
                            (
                              =
                              (
                                
                                  l
                                
                                  2
                              )
                            )
                            then
                            (
                              ifthenelse
                              (
                                if
                                (
                                  >
                                  (
                                    
                                      cmp
                                      (
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              1
                                          )
                                      )
                                    
                                      0
                                  )
                                )
                                then
                                (
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      Array.set
                                      (
                                        
                                          a
                                        
                                          0
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              1
                                          )
                                      )
                                    ;
                                      Array.set
                                      (
                                        
                                          a
                                        
                                          1
                                        
                                          e
                                      )
                                    )
                                  )
                                )
                                else
                                (
                                                                  )
                              )
                            )
                            else
                            (
                                let
                                (
                                  (
                                    l1
                                      /
                                      (
                                        
                                          l
                                        
                                          2
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      l2
                                        -
                                        (
                                          
                                            l
                                          
                                            l1
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        t
                                          Array.make
                                          (
                                            
                                              l2
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  0
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        sortto
                                        (
                                          
                                            l1
                                          
                                            t
                                          
                                            0
                                          
                                            l2
                                        )
                                      ;
                                        sequence
                                        (
                                          sortto
                                          (
                                            
                                              0
                                            
                                              a
                                            
                                              l2
                                            
                                              l1
                                          )
                                        ;
                                          merge
                                          (
                                            
                                              l2
                                            
                                              l1
                                            
                                              t
                                            
                                              0
                                            
                                              l2
                                            
                                              a
                                            
                                              0
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                            )
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      3
  )
  let
  (
    amerge_1c
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      4
  )
  let
  (
    amerge_1d
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      5
  )
  let
  (
    amerge_1e
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      6
  )
  let
  (
    amerge_1f
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      7
  )
  let
  (
    amerge_1g
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      8
  )
  let
  (
    amerge_1h
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      9
  )
  let
  (
    amerge_1i
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      10
  )
  let
  (
    amerge_1j
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  let
                                                  (
                                                    (
                                                      loop
                                                        (
                                                          case
                                                          (
                                                            i1
                                                            (
                                                              case
                                                              (
                                                                s1
                                                                (
                                                                  case
                                                                  (
                                                                    i2
                                                                    (
                                                                      case
                                                                      (
                                                                        s2
                                                                        (
                                                                          case
                                                                          (
                                                                            d
                                                                            ifthenelse
                                                                            (
                                                                              if
                                                                              (
                                                                                <=
                                                                                (
                                                                                  
                                                                                    cmp
                                                                                    (
                                                                                      
                                                                                        s1
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  
                                                                                    0
                                                                                )
                                                                              )
                                                                              then
                                                                              (
                                                                                sequence
                                                                                (
                                                                                  Array.set
                                                                                  (
                                                                                    
                                                                                      dst
                                                                                    
                                                                                      d
                                                                                    
                                                                                      s1
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      i1
                                                                                        +
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            1
                                                                                        )
                                                                                    )
                                                                                  in
                                                                                    ifthenelse
                                                                                    (
                                                                                      if
                                                                                      (
                                                                                        <
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            src1r
                                                                                        )
                                                                                      )
                                                                                      then
                                                                                      (
                                                                                        loop
                                                                                        (
                                                                                          
                                                                                            i1
                                                                                          
                                                                                            Array.get
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                            )
                                                                                          
                                                                                            i2
                                                                                          
                                                                                            s2
                                                                                          
                                                                                            +
                                                                                            (
                                                                                              
                                                                                                d
                                                                                              
                                                                                                1
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                      else
                                                                                      (
                                                                                          Array.blit
                                                                                          (
                                                                                            
                                                                                              src2
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              dst
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                            
                                                                                              -
                                                                                              (
                                                                                                
                                                                                                  src2r
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                              else
                                                                              (
                                                                                  sequence
                                                                                  (
                                                                                    Array.set
                                                                                    (
                                                                                      
                                                                                        dst
                                                                                      
                                                                                        d
                                                                                      
                                                                                        s2
                                                                                    )
                                                                                  ;
                                                                                    let
                                                                                    (
                                                                                      (
                                                                                        i2
                                                                                          +
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              1
                                                                                          )
                                                                                      )
                                                                                    in
                                                                                      ifthenelse
                                                                                      (
                                                                                        if
                                                                                        (
                                                                                          <
                                                                                          (
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              src2r
                                                                                          )
                                                                                        )
                                                                                        then
                                                                                        (
                                                                                          loop
                                                                                          (
                                                                                            
                                                                                              i1
                                                                                            
                                                                                              s1
                                                                                            
                                                                                              i2
                                                                                            
                                                                                              Array.get
                                                                                              (
                                                                                                
                                                                                                  src2
                                                                                                
                                                                                                  i2
                                                                                              )
                                                                                            
                                                                                              +
                                                                                              (
                                                                                                
                                                                                                  d
                                                                                                
                                                                                                  1
                                                                                              )
                                                                                          )
                                                                                        )
                                                                                        else
                                                                                        (
                                                                                            Array.blit
                                                                                            (
                                                                                              
                                                                                                a
                                                                                              
                                                                                                i1
                                                                                              
                                                                                                dst
                                                                                              
                                                                                                +
                                                                                                (
                                                                                                  
                                                                                                    d
                                                                                                  
                                                                                                    1
                                                                                                )
                                                                                              
                                                                                                -
                                                                                                (
                                                                                                  
                                                                                                    src1r
                                                                                                  
                                                                                                    i1
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                    )
                                                  in
                                                    loop
                                                    (
                                                      
                                                        src1ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            src1ofs
                                                        )
                                                      
                                                        src2ofs
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            src2
                                                          
                                                            src2ofs
                                                        )
                                                      
                                                        dstofs
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    amerge_3a
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    sortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      sequence
                                      (
                                        assert                                        >
                                        (
                                          
                                            len
                                          
                                            0
                                        )
                                        
                                      ;
                                        ifthenelse
                                        (
                                          if
                                          (
                                            =
                                            (
                                              
                                                len
                                              
                                                1
                                            )
                                          )
                                          then
                                          (
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    srcofs
                                                )
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      l
                        Array.length
                        (
                          
                            a
                        )
                    )
                  in
                    ifthenelse
                    (
                      if
                      (
                        <=
                        (
                          
                            l
                          
                            1
                        )
                      )
                      then
                      (
                        ()
                                              )
                      else
                      (
                          let
                          (
                            (
                              l1
                                /
                                (
                                  
                                    l
                                  
                                    2
                                )
                            )
                          in
                            let
                            (
                              (
                                l2
                                  -
                                  (
                                    
                                      l
                                    
                                      l1
                                  )
                              )
                            in
                              let
                              (
                                (
                                  t
                                    Array.make
                                    (
                                      
                                        l2
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                )
                              in
                                sequence
                                (
                                  sortto
                                  (
                                    
                                      l1
                                    
                                      t
                                    
                                      0
                                    
                                      l2
                                  )
                                ;
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        0
                                      
                                        a
                                      
                                        l2
                                      
                                        l1
                                    )
                                  ;
                                    merge
                                    (
                                      
                                        l2
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                      
                                        a
                                      
                                        0
                                    )
                                  )
                                )
                              )
                            )
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    amerge_3b
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    sortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      sequence
                                      (
                                        assert                                        >
                                        (
                                          
                                            len
                                          
                                            0
                                        )
                                        
                                      ;
                                        ifthenelse
                                        (
                                          if
                                          (
                                            =
                                            (
                                              
                                                len
                                              
                                                1
                                            )
                                          )
                                          then
                                          (
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    srcofs
                                                )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  =
                                                  (
                                                    
                                                      len
                                                    
                                                      2
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  srcofs
                                                              )
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  +
                                                                  (
                                                                    
                                                                      srcofs
                                                                    
                                                                      1
                                                                  )
                                                              )
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            dst
                                                          
                                                            dstofs
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                srcofs
                                                            )
                                                        )
                                                      ;
                                                        Array.set
                                                        (
                                                          
                                                            dst
                                                          
                                                            +
                                                            (
                                                              
                                                                dstofs
                                                              
                                                                1
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                +
                                                                (
                                                                  
                                                                    srcofs
                                                                  
                                                                    1
                                                                )
                                                            )
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              dst
                                                            
                                                              dstofs
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  +
                                                                  (
                                                                    
                                                                      srcofs
                                                                    
                                                                      1
                                                                  )
                                                              )
                                                          )
                                                        ;
                                                          Array.set
                                                          (
                                                            
                                                              dst
                                                            
                                                              +
                                                              (
                                                                
                                                                  dstofs
                                                                
                                                                  1
                                                              )
                                                            
                                                              Array.get
                                                              (
                                                                
                                                                  a
                                                                
                                                                  srcofs
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    let
                                                    (
                                                      (
                                                        l1
                                                          /
                                                          (
                                                            
                                                              len
                                                            
                                                              2
                                                          )
                                                      )
                                                    in
                                                      let
                                                      (
                                                        (
                                                          l2
                                                            -
                                                            (
                                                              
                                                                len
                                                              
                                                                l1
                                                            )
                                                        )
                                                      in
                                                        sequence
                                                        (
                                                          sortto
                                                          (
                                                            
                                                              +
                                                              (
                                                                
                                                                  srcofs
                                                                
                                                                  l1
                                                              )
                                                            
                                                              dst
                                                            
                                                              +
                                                              (
                                                                
                                                                  dstofs
                                                                
                                                                  l1
                                                              )
                                                            
                                                              l2
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            sortto
                                                            (
                                                              
                                                                srcofs
                                                              
                                                                a
                                                              
                                                                +
                                                                (
                                                                  
                                                                    srcofs
                                                                  
                                                                    l2
                                                                )
                                                              
                                                                l1
                                                            )
                                                          ;
                                                            merge
                                                            (
                                                              
                                                                +
                                                                (
                                                                  
                                                                    srcofs
                                                                  
                                                                    l2
                                                                )
                                                              
                                                                l1
                                                              
                                                                dst
                                                              
                                                                +
                                                                (
                                                                  
                                                                    dstofs
                                                                  
                                                                    l1
                                                                )
                                                              
                                                                l2
                                                              
                                                                dst
                                                              
                                                                dstofs
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      l
                        Array.length
                        (
                          
                            a
                        )
                    )
                  in
                    ifthenelse
                    (
                      if
                      (
                        <=
                        (
                          
                            l
                          
                            1
                        )
                      )
                      then
                      (
                        ()
                                              )
                      else
                      (
                          ifthenelse
                          (
                            if
                            (
                              =
                              (
                                
                                  l
                                
                                  2
                              )
                            )
                            then
                            (
                              ifthenelse
                              (
                                if
                                (
                                  >
                                  (
                                    
                                      cmp
                                      (
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              1
                                          )
                                      )
                                    
                                      0
                                  )
                                )
                                then
                                (
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      Array.set
                                      (
                                        
                                          a
                                        
                                          0
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              1
                                          )
                                      )
                                    ;
                                      Array.set
                                      (
                                        
                                          a
                                        
                                          1
                                        
                                          e
                                      )
                                    )
                                  )
                                )
                                else
                                (
                                                                  )
                              )
                            )
                            else
                            (
                                let
                                (
                                  (
                                    l1
                                      /
                                      (
                                        
                                          l
                                        
                                          2
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      l2
                                        -
                                        (
                                          
                                            l
                                          
                                            l1
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        t
                                          Array.make
                                          (
                                            
                                              l2
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  0
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        sortto
                                        (
                                          
                                            l1
                                          
                                            t
                                          
                                            0
                                          
                                            l2
                                        )
                                      ;
                                        sequence
                                        (
                                          sortto
                                          (
                                            
                                              0
                                            
                                              a
                                            
                                              l2
                                            
                                              l1
                                          )
                                        ;
                                          merge
                                          (
                                            
                                              l2
                                            
                                              l1
                                            
                                              t
                                            
                                              0
                                            
                                              l2
                                            
                                              a
                                            
                                              0
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                            )
                          )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      3
  )
  let
  (
    amerge_3c
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      4
  )
  let
  (
    amerge_3d
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      5
  )
  let
  (
    amerge_3e
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      6
  )
  let
  (
    amerge_3f
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      7
  )
  let
  (
    amerge_3g
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      8
  )
  let
  (
    amerge_3h
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      9
  )
  let
  (
    amerge_3i
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      10
  )
  let
  (
    amerge_3j
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  merge
                    (
                      case
                      (
                        src1ofs
                        (
                          case
                          (
                            src1len
                            (
                              case
                              (
                                src2
                                (
                                  case
                                  (
                                    src2ofs
                                    (
                                      case
                                      (
                                        src2len
                                        (
                                          case
                                          (
                                            dst
                                            (
                                              case
                                              (
                                                dstofs
                                                let
                                                (
                                                  (
                                                    i1
                                                      ref
                                                      (
                                                        
                                                          src1ofs
                                                      )
                                                    i2
                                                      ref
                                                      (
                                                        
                                                          src2ofs
                                                      )
                                                    d
                                                      ref
                                                      (
                                                        
                                                          dstofs
                                                      )
                                                    src1r
                                                      +
                                                      (
                                                        
                                                          src1ofs
                                                        
                                                          src1len
                                                      )
                                                    src2r
                                                      +
                                                      (
                                                        
                                                          src2ofs
                                                        
                                                          src2len
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    while
                                                    &&
                                                    (
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i2
                                                            )
                                                          
                                                            src2r
                                                        )
                                                    )
                                                    let
                                                    (
                                                      (
                                                        s1
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  i1
                                                              )
                                                          )
                                                        s2
                                                          Array.get
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                          )
                                                      )
                                                    in
                                                      sequence
                                                      (
                                                        ifthenelse
                                                        (
                                                          if
                                                          (
                                                            <=
                                                            (
                                                              
                                                                cmp
                                                                (
                                                                  
                                                                    s1
                                                                  
                                                                    s2
                                                                )
                                                              
                                                                0
                                                            )
                                                          )
                                                          then
                                                          (
                                                            sequence
                                                            (
                                                              Array.set
                                                              (
                                                                
                                                                  dst
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      d
                                                                  )
                                                                
                                                                  s1
                                                              )
                                                            ;
                                                              incr
                                                              (
                                                                
                                                                  i1
                                                              )
                                                            )
                                                          )
                                                          else
                                                          (
                                                              sequence
                                                              (
                                                                Array.set
                                                                (
                                                                  
                                                                    dst
                                                                  
                                                                    !
                                                                    (
                                                                      
                                                                        d
                                                                    )
                                                                  
                                                                    s2
                                                                )
                                                              ;
                                                                incr
                                                                (
                                                                  
                                                                    i2
                                                                )
                                                              )
                                                          )
                                                        )
                                                      ;
                                                        incr
                                                        (
                                                          
                                                            d
                                                        )
                                                      )
                                                    )
                                                  ;
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        <
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            src1r
                                                        )
                                                      )
                                                      then
                                                      (
                                                        Array.blit
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                i1
                                                            )
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                d
                                                            )
                                                          
                                                            -
                                                            (
                                                              
                                                                src1r
                                                              
                                                                !
                                                                (
                                                                  
                                                                    i1
                                                                )
                                                            )
                                                        )
                                                      )
                                                      else
                                                      (
                                                          Array.blit
                                                          (
                                                            
                                                              src2
                                                            
                                                              !
                                                              (
                                                                
                                                                  i2
                                                              )
                                                            
                                                              dst
                                                            
                                                              !
                                                              (
                                                                
                                                                  d
                                                              )
                                                            
                                                              -
                                                              (
                                                                
                                                                  src2r
                                                                
                                                                  !
                                                                  (
                                                                    
                                                                      i2
                                                                  )
                                                              )
                                                          )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    isortto
                      (
                        case
                        (
                          srcofs
                          (
                            case
                            (
                              dst
                              (
                                case
                                (
                                  dstofs
                                  (
                                    case
                                    (
                                      len
                                      for i
                                      0
                                      -
                                      (
                                        
                                          len
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                +
                                                (
                                                  
                                                    srcofs
                                                  
                                                    i
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            j
                                              ref
                                              (
                                                
                                                  -
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          dstofs
                                                        
                                                          i
                                                      )
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        in
                                          sequence
                                          (
                                            while
                                            &&
                                            (
                                              
                                                >=
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    dstofs
                                                )
                                              
                                                >
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            dst
                                                          
                                                            !
                                                            (
                                                              
                                                                j
                                                            )
                                                        )
                                                      
                                                        e
                                                    )
                                                  
                                                    0
                                                )
                                            )
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  dst
                                                
                                                  +
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                    
                                                      1
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      dst
                                                    
                                                      !
                                                      (
                                                        
                                                          j
                                                      )
                                                  )
                                              )
                                            ;
                                              decr
                                              (
                                                
                                                  j
                                              )
                                            )
                                          ;
                                            Array.set
                                            (
                                              
                                                dst
                                              
                                                +
                                                (
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                  
                                                    1
                                                )
                                              
                                                e
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sortto
                        (
                          case
                          (
                            srcofs
                            (
                              case
                              (
                                dst
                                (
                                  case
                                  (
                                    dstofs
                                    (
                                      case
                                      (
                                        len
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                len
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            isortto
                                            (
                                              
                                                srcofs
                                              
                                                dst
                                              
                                                dstofs
                                              
                                                len
                                            )
                                          )
                                          else
                                          (
                                              let
                                              (
                                                (
                                                  l1
                                                    /
                                                    (
                                                      
                                                        len
                                                      
                                                        2
                                                    )
                                                )
                                              in
                                                let
                                                (
                                                  (
                                                    l2
                                                      -
                                                      (
                                                        
                                                          len
                                                        
                                                          l1
                                                      )
                                                  )
                                                in
                                                  sequence
                                                  (
                                                    sortto
                                                    (
                                                      
                                                        +
                                                        (
                                                          
                                                            srcofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        dst
                                                      
                                                        +
                                                        (
                                                          
                                                            dstofs
                                                          
                                                            l1
                                                        )
                                                      
                                                        l2
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      sortto
                                                      (
                                                        
                                                          srcofs
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                      )
                                                    ;
                                                      merge
                                                      (
                                                        
                                                          +
                                                          (
                                                            
                                                              srcofs
                                                            
                                                              l2
                                                          )
                                                        
                                                          l1
                                                        
                                                          dst
                                                        
                                                          +
                                                          (
                                                            
                                                              dstofs
                                                            
                                                              l1
                                                          )
                                                        
                                                          l2
                                                        
                                                          dst
                                                        
                                                          dstofs
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      ifthenelse
                      (
                        if
                        (
                          <=
                          (
                            
                              l
                            
                              cutoff
                          )
                        )
                        then
                        (
                          isortto
                          (
                            
                              0
                            
                              a
                            
                              0
                            
                              l
                          )
                        )
                        else
                        (
                            let
                            (
                              (
                                l1
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  l2
                                    -
                                    (
                                      
                                        l
                                      
                                        l1
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    t
                                      Array.make
                                      (
                                        
                                          l2
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              0
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    sortto
                                    (
                                      
                                        l1
                                      
                                        t
                                      
                                        0
                                      
                                        l2
                                    )
                                  ;
                                    sequence
                                    (
                                      sortto
                                      (
                                        
                                          0
                                        
                                          a
                                        
                                          l2
                                        
                                          l1
                                      )
                                    ;
                                      merge
                                      (
                                        
                                          l2
                                        
                                          l1
                                        
                                          t
                                        
                                          0
                                        
                                          l2
                                        
                                          a
                                        
                                          0
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    ashell_1
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  l
                    Array.length
                    (
                      
                        a
                    )
                )
              in
                let
                (
                  (
                    step
                      ref
                      (
                        
                          1
                      )
                  )
                in
                  sequence
                  (
                    while
                    <
                    (
                      
                        !
                        (
                          
                            step
                        )
                      
                        l
                    )
                    :=
                    (
                      
                        step
                      
                        +
                        (
                          
                            *
                            (
                              
                                !
                                (
                                  
                                    step
                                )
                              
                                3
                            )
                          
                            1
                        )
                    )
                  ;
                    sequence
                    (
                      :=
                      (
                        
                          step
                        
                          /
                          (
                            
                              !
                              (
                                
                                  step
                              )
                            
                              3
                          )
                      )
                    ;
                      while
                      >
                      (
                        
                          !
                          (
                            
                              step
                          )
                        
                          0
                      )
                      sequence
                      (
                        for j
                        !
                        (
                          
                            step
                        )
                        -
                        (
                          
                            l
                          
                            1
                        )
                        let
                        (
                          (
                            e
                              Array.get
                              (
                                
                                  a
                                
                                  j
                              )
                          )
                        in
                          let
                          (
                            (
                              k
                                ref
                                (
                                  
                                    -
                                    (
                                      
                                        j
                                      
                                        !
                                        (
                                          
                                            step
                                        )
                                    )
                                )
                            )
                          in
                            let
                            (
                              (
                                k1
                                  ref
                                  (
                                    
                                      j
                                  )
                              )
                            in
                              sequence
                              (
                                while
                                &&
                                (
                                  
                                    >=
                                    (
                                      
                                        !
                                        (
                                          
                                            k
                                        )
                                      
                                        0
                                    )
                                  
                                    >
                                    (
                                      
                                        cmp
                                        (
                                          
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    k
                                                )
                                            )
                                          
                                            e
                                        )
                                      
                                        0
                                    )
                                )
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          k1
                                      )
                                    
                                      Array.get
                                      (
                                        
                                          a
                                        
                                          !
                                          (
                                            
                                              k
                                          )
                                      )
                                  )
                                ;
                                  sequence
                                  (
                                    :=
                                    (
                                      
                                        k1
                                      
                                        !
                                        (
                                          
                                            k
                                        )
                                    )
                                  ;
                                    :=
                                    (
                                      
                                        k
                                      
                                        -
                                        (
                                          
                                            !
                                            (
                                              
                                                k
                                            )
                                          
                                            !
                                            (
                                              
                                                step
                                            )
                                        )
                                    )
                                  )
                                )
                              ;
                                Array.set
                                (
                                  
                                    a
                                  
                                    !
                                    (
                                      
                                        k1
                                    )
                                  
                                    e
                                )
                              )
                            )
                          )
                        )
                      ;
                        :=
                        (
                          
                            step
                          
                            /
                            (
                              
                                !
                                (
                                  
                                    step
                                )
                              
                                3
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    ashell_2
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  l
                    Array.length
                    (
                      
                        a
                    )
                )
              in
                let
                (
                  (
                    step
                      ref
                      (
                        
                          1
                      )
                  )
                in
                  sequence
                  (
                    while
                    <
                    (
                      
                        !
                        (
                          
                            step
                        )
                      
                        l
                    )
                    :=
                    (
                      
                        step
                      
                        +
                        (
                          
                            *
                            (
                              
                                !
                                (
                                  
                                    step
                                )
                              
                                3
                            )
                          
                            1
                        )
                    )
                  ;
                    sequence
                    (
                      :=
                      (
                        
                          step
                        
                          /
                          (
                            
                              !
                              (
                                
                                  step
                              )
                            
                              3
                          )
                      )
                    ;
                      while
                      >
                      (
                        
                          !
                          (
                            
                              step
                          )
                        
                          0
                      )
                      sequence
                      (
                        for j
                        !
                        (
                          
                            step
                        )
                        -
                        (
                          
                            l
                          
                            1
                        )
                        let
                        (
                          (
                            e
                              Array.get
                              (
                                
                                  a
                                
                                  j
                              )
                          )
                        in
                          let
                          (
                            (
                              k
                                ref
                                (
                                  
                                    -
                                    (
                                      
                                        j
                                      
                                        !
                                        (
                                          
                                            step
                                        )
                                    )
                                )
                            )
                          in
                            sequence
                            (
                              while
                              &&
                              (
                                
                                  >=
                                  (
                                    
                                      !
                                      (
                                        
                                          k
                                      )
                                    
                                      0
                                  )
                                
                                  >
                                  (
                                    
                                      cmp
                                      (
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              !
                                              (
                                                
                                                  k
                                              )
                                          )
                                        
                                          e
                                      )
                                    
                                      0
                                  )
                              )
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    +
                                    (
                                      
                                        !
                                        (
                                          
                                            k
                                        )
                                      
                                        !
                                        (
                                          
                                            step
                                        )
                                    )
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            k
                                        )
                                    )
                                )
                              ;
                                :=
                                (
                                  
                                    k
                                  
                                    -
                                    (
                                      
                                        !
                                        (
                                          
                                            k
                                        )
                                      
                                        !
                                        (
                                          
                                            step
                                        )
                                    )
                                )
                              )
                            ;
                              Array.set
                              (
                                
                                  a
                                
                                  +
                                  (
                                    
                                      !
                                      (
                                        
                                          k
                                      )
                                    
                                      !
                                      (
                                        
                                          step
                                      )
                                  )
                                
                                  e
                              )
                            )
                          )
                        )
                      ;
                        :=
                        (
                          
                            step
                          
                            /
                            (
                              
                                !
                                (
                                  
                                    step
                                )
                              
                                3
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    ashell_3
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  l
                    Array.length
                    (
                      
                        a
                    )
                )
              in
                let
                (
                  (
                    step
                      ref
                      (
                        
                          1
                      )
                  )
                in
                  sequence
                  (
                    while
                    <
                    (
                      
                        !
                        (
                          
                            step
                        )
                      
                        l
                    )
                    :=
                    (
                      
                        step
                      
                        +
                        (
                          
                            *
                            (
                              
                                !
                                (
                                  
                                    step
                                )
                              
                                3
                            )
                          
                            1
                        )
                    )
                  ;
                    sequence
                    (
                      :=
                      (
                        
                          step
                        
                          /
                          (
                            
                              !
                              (
                                
                                  step
                              )
                            
                              3
                          )
                      )
                    ;
                      while
                      >
                      (
                        
                          !
                          (
                            
                              step
                          )
                        
                          0
                      )
                      sequence
                      (
                        for i
                        0
                        -
                        (
                          
                            !
                            (
                              
                                step
                            )
                          
                            1
                        )
                        let
                        (
                          (
                            j
                              ref
                              (
                                
                                  +
                                  (
                                    
                                      i
                                    
                                      !
                                      (
                                        
                                          step
                                      )
                                  )
                              )
                          )
                        in
                          while
                          <
                          (
                            
                              !
                              (
                                
                                  j
                              )
                            
                              l
                          )
                          let
                          (
                            (
                              e
                                ref
                                (
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            j
                                        )
                                    )
                                )
                            )
                          in
                            let
                            (
                              (
                                k
                                  ref
                                  (
                                    
                                      -
                                      (
                                        
                                          !
                                          (
                                            
                                              j
                                          )
                                        
                                          !
                                          (
                                            
                                              step
                                          )
                                      )
                                  )
                              )
                            in
                              sequence
                              (
                                ifthenelse
                                (
                                  if
                                  (
                                    <
                                    (
                                      
                                        cmp
                                        (
                                          
                                            !
                                            (
                                              
                                                e
                                            )
                                          
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                i
                                            )
                                        )
                                      
                                        0
                                    )
                                  )
                                  then
                                  (
                                    let
                                    (
                                      (
                                        x
                                          !
                                          (
                                            
                                              e
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        :=
                                        (
                                          
                                            e
                                          
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                i
                                            )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            i
                                          
                                            x
                                        )
                                      )
                                    )
                                  )
                                  else
                                  (
                                                                      )
                                )
                              ;
                                sequence
                                (
                                  while
                                  >
                                  (
                                    
                                      cmp
                                      (
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              !
                                              (
                                                
                                                  k
                                              )
                                          )
                                        
                                          !
                                          (
                                            
                                              e
                                          )
                                      )
                                    
                                      0
                                  )
                                  sequence
                                  (
                                    Array.set
                                    (
                                      
                                        a
                                      
                                        +
                                        (
                                          
                                            !
                                            (
                                              
                                                k
                                            )
                                          
                                            !
                                            (
                                              
                                                step
                                            )
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                k
                                            )
                                        )
                                    )
                                  ;
                                    :=
                                    (
                                      
                                        k
                                      
                                        -
                                        (
                                          
                                            !
                                            (
                                              
                                                k
                                            )
                                          
                                            !
                                            (
                                              
                                                step
                                            )
                                        )
                                    )
                                  )
                                ;
                                  sequence
                                  (
                                    Array.set
                                    (
                                      
                                        a
                                      
                                        +
                                        (
                                          
                                            !
                                            (
                                              
                                                k
                                            )
                                          
                                            !
                                            (
                                              
                                                step
                                            )
                                        )
                                      
                                        !
                                        (
                                          
                                            e
                                        )
                                    )
                                  ;
                                    :=
                                    (
                                      
                                        j
                                      
                                        +
                                        (
                                          
                                            !
                                            (
                                              
                                                j
                                            )
                                          
                                            !
                                            (
                                              
                                                step
                                            )
                                        )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      ;
                        :=
                        (
                          
                            step
                          
                            /
                            (
                              
                                !
                                (
                                  
                                    step
                                )
                              
                                3
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    force
      Lazy.force
  )
  type
  (
    iilist
      type
        params =
          (
          )
        cstrs =
          (
          )
        kind =
            (
              Cons
                (
                     int
                    (
                    )
                     Lazy.t
                    (
                         iilist
                        (
                        )
                    )
                )
                            )
            )
  let
  (
    mult
      (
        case
        (
          n
          (
            case
            (
              Cons
                (
                  x
                  l
                )
              Cons
                (
                  *
                  (
                    
                      n
                    
                      x
                  )
                  lazy
                  mult
                  (
                    
                      n
                    
                      force
                      (
                        
                          l
                      )
                  )
                )
            )
          )
        )
      )
  )
  let
  (
    merge
      (
        case
        (
          alias l1
          (
            Cons
              (
                x1
                t1
              )
          )
          (
            case
            (
              alias l2
              (
                Cons
                  (
                    x2
                    t2
                  )
              )
              ifthenelse
              (
                if
                (
                  =
                  (
                    
                      x1
                    
                      x2
                  )
                )
                then
                (
                  Cons
                    (
                      x1
                      lazy
                      merge
                      (
                        
                          force
                          (
                            
                              t1
                          )
                        
                          force
                          (
                            
                              t2
                          )
                      )
                    )
                )
                else
                (
                    ifthenelse
                    (
                      if
                      (
                        <
                        (
                          
                            x1
                          
                            x2
                        )
                      )
                      then
                      (
                        Cons
                          (
                            x1
                            lazy
                            merge
                            (
                              
                                force
                                (
                                  
                                    t1
                                )
                              
                                l2
                            )
                          )
                      )
                      else
                      (
                          Cons
                            (
                              x2
                              lazy
                              merge
                              (
                                
                                  l1
                                
                                  force
                                  (
                                    
                                      t2
                                  )
                              )
                            )
                      )
                    )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    scale
      Cons
        (
          1
          lazy
          merge
          (
            
              mult
              (
                
                  2
                
                  scale
              )
            
              mult
              (
                
                  3
                
                  scale
              )
          )
        )
  )
  let
  (
    ashell_4
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  l
                    Array.length
                    (
                      
                        a
                    )
                )
              in
                let
                (
                  (
                    loop1
                      (
                        case
                        (
                          accu
                          (
                            case
                            (
                              Cons
                                (
                                  x
                                  t
                                )
                              ifthenelse
                              (
                                if
                                (
                                  >
                                  (
                                    
                                      x
                                    
                                      l
                                  )
                                )
                                then
                                (
                                  accu
                                )
                                else
                                (
                                    loop1
                                    (
                                      
                                        ::
                                          (
                                            x
                                            accu
                                          )
                                      
                                        force
                                        (
                                          
                                            t
                                        )
                                    )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      sc
                        loop1
                        (
                          
                            []
                                                      
                            scale
                        )
                    )
                  in
                    let
                    (
                      (
                        loop2
                          (
                            case
                            (
                              []
                                                            ()
                                                          )
                            case
                            (
                              ::
                                (
                                  step
                                  t
                                )
                              sequence
                              (
                                for i
                                0
                                -
                                (
                                  
                                    step
                                  
                                    1
                                )
                                let
                                (
                                  (
                                    j
                                      ref
                                      (
                                        
                                          +
                                          (
                                            
                                              i
                                            
                                              step
                                          )
                                      )
                                  )
                                in
                                  while
                                  <
                                  (
                                    
                                      !
                                      (
                                        
                                          j
                                      )
                                    
                                      l
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                j
                                            )
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        k
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  step
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        &&
                                        (
                                          
                                            >=
                                            (
                                              
                                                !
                                                (
                                                  
                                                    k
                                                )
                                              
                                                0
                                            )
                                          
                                            >
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            k
                                                        )
                                                    )
                                                  
                                                    e
                                                )
                                              
                                                0
                                            )
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      k
                                                  )
                                                
                                                  step
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      k
                                                  )
                                              )
                                          )
                                        ;
                                          :=
                                          (
                                            
                                              k
                                            
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      k
                                                  )
                                                
                                                  step
                                              )
                                          )
                                        )
                                      ;
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      k
                                                  )
                                                
                                                  step
                                              )
                                            
                                              e
                                          )
                                        ;
                                          :=
                                          (
                                            
                                              j
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  step
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              ;
                                loop2
                                (
                                  
                                    t
                                )
                              )
                            )
                          )
                      )
                    in
                      loop2
                      (
                        
                          sc
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      1
  )
  let
  (
    aquick_1a
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            -
                                            (
                                              
                                                r
                                              
                                                1
                                            )
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <=
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              decr
                                              (
                                                
                                                  p3
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p2
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        incr
                                        (
                                          
                                            p3
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p1
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p1
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            1
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      2
  )
  let
  (
    aquick_1b
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            -
                                            (
                                              
                                                r
                                              
                                                1
                                            )
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <=
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              decr
                                              (
                                                
                                                  p3
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p2
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        incr
                                        (
                                          
                                            p3
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p1
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p1
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            1
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      3
  )
  let
  (
    aquick_1c
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            -
                                            (
                                              
                                                r
                                              
                                                1
                                            )
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <=
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              decr
                                              (
                                                
                                                  p3
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p2
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        incr
                                        (
                                          
                                            p3
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p1
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p1
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            1
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      4
  )
  let
  (
    aquick_1d
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            -
                                            (
                                              
                                                r
                                              
                                                1
                                            )
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <=
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              decr
                                              (
                                                
                                                  p3
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p2
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        incr
                                        (
                                          
                                            p3
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p1
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p1
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            1
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      5
  )
  let
  (
    aquick_1e
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            -
                                            (
                                              
                                                r
                                              
                                                1
                                            )
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <=
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              decr
                                              (
                                                
                                                  p3
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p2
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        incr
                                        (
                                          
                                            p3
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p1
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p1
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            1
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      6
  )
  let
  (
    aquick_1f
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            -
                                            (
                                              
                                                r
                                              
                                                1
                                            )
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <=
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              decr
                                              (
                                                
                                                  p3
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p2
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        incr
                                        (
                                          
                                            p3
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p1
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p1
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            1
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      7
  )
  let
  (
    aquick_1g
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            -
                                            (
                                              
                                                r
                                              
                                                1
                                            )
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <=
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              decr
                                              (
                                                
                                                  p3
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p2
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        incr
                                        (
                                          
                                            p3
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p1
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p1
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            1
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      1
  )
  let
  (
    aquick_2a
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p2
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                          
                                                            e
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              p1
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      incr
                                                      (
                                                        
                                                          p2
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          len1
                                            -
                                            (
                                              
                                                !
                                                (
                                                  
                                                    p1
                                                )
                                              
                                                l
                                            )
                                          len2
                                            -
                                            (
                                              
                                                r
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                len1
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                >
                                                (
                                                  
                                                    len2
                                                  
                                                    cutoff
                                                )
                                              )
                                              then
                                              (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        len1
                                                      
                                                        len2
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      qsort
                                                      (
                                                        
                                                          l
                                                        
                                                          !
                                                          (
                                                            
                                                              p1
                                                          )
                                                      )
                                                    ;
                                                      qsort
                                                      (
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          r
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      )
                                                  )
                                                )
                                              )
                                              else
                                              (
                                                  qsort
                                                  (
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  qsort
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      r
                                                  )
                                                )
                                                else
                                                (
                                                                                                  )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      2
  )
  let
  (
    aquick_2b
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p2
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                          
                                                            e
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              p1
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      incr
                                                      (
                                                        
                                                          p2
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          len1
                                            -
                                            (
                                              
                                                !
                                                (
                                                  
                                                    p1
                                                )
                                              
                                                l
                                            )
                                          len2
                                            -
                                            (
                                              
                                                r
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                len1
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                >
                                                (
                                                  
                                                    len2
                                                  
                                                    cutoff
                                                )
                                              )
                                              then
                                              (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        len1
                                                      
                                                        len2
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      qsort
                                                      (
                                                        
                                                          l
                                                        
                                                          !
                                                          (
                                                            
                                                              p1
                                                          )
                                                      )
                                                    ;
                                                      qsort
                                                      (
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          r
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      )
                                                  )
                                                )
                                              )
                                              else
                                              (
                                                  qsort
                                                  (
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  qsort
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      r
                                                  )
                                                )
                                                else
                                                (
                                                                                                  )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      3
  )
  let
  (
    aquick_2c
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p2
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                          
                                                            e
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              p1
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      incr
                                                      (
                                                        
                                                          p2
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          len1
                                            -
                                            (
                                              
                                                !
                                                (
                                                  
                                                    p1
                                                )
                                              
                                                l
                                            )
                                          len2
                                            -
                                            (
                                              
                                                r
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                len1
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                >
                                                (
                                                  
                                                    len2
                                                  
                                                    cutoff
                                                )
                                              )
                                              then
                                              (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        len1
                                                      
                                                        len2
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      qsort
                                                      (
                                                        
                                                          l
                                                        
                                                          !
                                                          (
                                                            
                                                              p1
                                                          )
                                                      )
                                                    ;
                                                      qsort
                                                      (
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          r
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      )
                                                  )
                                                )
                                              )
                                              else
                                              (
                                                  qsort
                                                  (
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  qsort
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      r
                                                  )
                                                )
                                                else
                                                (
                                                                                                  )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      4
  )
  let
  (
    aquick_2d
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p2
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                          
                                                            e
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              p1
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      incr
                                                      (
                                                        
                                                          p2
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          len1
                                            -
                                            (
                                              
                                                !
                                                (
                                                  
                                                    p1
                                                )
                                              
                                                l
                                            )
                                          len2
                                            -
                                            (
                                              
                                                r
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                len1
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                >
                                                (
                                                  
                                                    len2
                                                  
                                                    cutoff
                                                )
                                              )
                                              then
                                              (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        len1
                                                      
                                                        len2
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      qsort
                                                      (
                                                        
                                                          l
                                                        
                                                          !
                                                          (
                                                            
                                                              p1
                                                          )
                                                      )
                                                    ;
                                                      qsort
                                                      (
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          r
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      )
                                                  )
                                                )
                                              )
                                              else
                                              (
                                                  qsort
                                                  (
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  qsort
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      r
                                                  )
                                                )
                                                else
                                                (
                                                                                                  )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      5
  )
  let
  (
    aquick_2e
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p2
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                          
                                                            e
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              p1
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      incr
                                                      (
                                                        
                                                          p2
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          len1
                                            -
                                            (
                                              
                                                !
                                                (
                                                  
                                                    p1
                                                )
                                              
                                                l
                                            )
                                          len2
                                            -
                                            (
                                              
                                                r
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                len1
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                >
                                                (
                                                  
                                                    len2
                                                  
                                                    cutoff
                                                )
                                              )
                                              then
                                              (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        len1
                                                      
                                                        len2
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      qsort
                                                      (
                                                        
                                                          l
                                                        
                                                          !
                                                          (
                                                            
                                                              p1
                                                          )
                                                      )
                                                    ;
                                                      qsort
                                                      (
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          r
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      )
                                                  )
                                                )
                                              )
                                              else
                                              (
                                                  qsort
                                                  (
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  qsort
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      r
                                                  )
                                                )
                                                else
                                                (
                                                                                                  )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      6
  )
  let
  (
    aquick_2f
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p2
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                          
                                                            e
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              p1
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      incr
                                                      (
                                                        
                                                          p2
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          len1
                                            -
                                            (
                                              
                                                !
                                                (
                                                  
                                                    p1
                                                )
                                              
                                                l
                                            )
                                          len2
                                            -
                                            (
                                              
                                                r
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                len1
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                >
                                                (
                                                  
                                                    len2
                                                  
                                                    cutoff
                                                )
                                              )
                                              then
                                              (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        len1
                                                      
                                                        len2
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      qsort
                                                      (
                                                        
                                                          l
                                                        
                                                          !
                                                          (
                                                            
                                                              p1
                                                          )
                                                      )
                                                    ;
                                                      qsort
                                                      (
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          r
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      )
                                                  )
                                                )
                                              )
                                              else
                                              (
                                                  qsort
                                                  (
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  qsort
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      r
                                                  )
                                                )
                                                else
                                                (
                                                                                                  )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      7
  )
  let
  (
    aquick_2g
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p2
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                          
                                                            e
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          incr
                                                          (
                                                            
                                                              p1
                                                          )
                                                        ;
                                                          incr
                                                          (
                                                            
                                                              p2
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      incr
                                                      (
                                                        
                                                          p2
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          len1
                                            -
                                            (
                                              
                                                !
                                                (
                                                  
                                                    p1
                                                )
                                              
                                                l
                                            )
                                          len2
                                            -
                                            (
                                              
                                                r
                                              
                                                !
                                                (
                                                  
                                                    p3
                                                )
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                len1
                                              
                                                cutoff
                                            )
                                          )
                                          then
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                >
                                                (
                                                  
                                                    len2
                                                  
                                                    cutoff
                                                )
                                              )
                                              then
                                              (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        len1
                                                      
                                                        len2
                                                    )
                                                  )
                                                  then
                                                  (
                                                    sequence
                                                    (
                                                      qsort
                                                      (
                                                        
                                                          l
                                                        
                                                          !
                                                          (
                                                            
                                                              p1
                                                          )
                                                      )
                                                    ;
                                                      qsort
                                                      (
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                        
                                                          r
                                                      )
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p1
                                                            )
                                                        )
                                                      )
                                                  )
                                                )
                                              )
                                              else
                                              (
                                                  qsort
                                                  (
                                                    
                                                      l
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  qsort
                                                  (
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      r
                                                  )
                                                )
                                                else
                                                (
                                                                                                  )
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      1
  )
  let
  (
    aquick_3a
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      2
  )
  let
  (
    aquick_3b
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      3
  )
  let
  (
    aquick_3c
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      4
  )
  let
  (
    aquick_3d
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      5
  )
  let
  (
    aquick_3e
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      6
  )
  let
  (
    aquick_3f
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      7
  )
  let
  (
    aquick_3g
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      8
  )
  let
  (
    aquick_3h
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      9
  )
  let
  (
    aquick_3i
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    cutoff
      10
  )
  let
  (
    aquick_3j
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  qsort
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            let
                            (
                              (
                                m
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          r
                                      )
                                    
                                      2
                                  )
                              )
                            in
                              let
                              (
                                (
                                  al
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        l
                                    )
                                  am
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        m
                                    )
                                  ar
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        -
                                        (
                                          
                                            r
                                          
                                            1
                                        )
                                    )
                                )
                              in
                                let
                                (
                                  (
                                    pivot
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <=
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  al
                                                
                                                  am
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <=
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      am
                                                    
                                                      ar
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              am
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <=
                                                    (
                                                      
                                                        cmp
                                                        (
                                                          
                                                            al
                                                          
                                                            ar
                                                        )
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    ar
                                                  )
                                                  else
                                                  (
                                                      al
                                                  )
                                                )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <=
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        al
                                                      
                                                        ar
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                al
                                              )
                                              else
                                              (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <=
                                                      (
                                                        
                                                          cmp
                                                          (
                                                            
                                                              am
                                                            
                                                              ar
                                                          )
                                                        
                                                          0
                                                      )
                                                    )
                                                    then
                                                    (
                                                      ar
                                                    )
                                                    else
                                                    (
                                                        am
                                                    )
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      p1
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p2
                                        ref
                                        (
                                          
                                            l
                                        )
                                      p3
                                        ref
                                        (
                                          
                                            r
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      while
                                      <
                                      (
                                        
                                          !
                                          (
                                            
                                              p2
                                          )
                                        
                                          !
                                          (
                                            
                                              p3
                                          )
                                      )
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                !
                                                (
                                                  
                                                    p2
                                                )
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            c
                                              cmp
                                              (
                                                
                                                  e
                                                
                                                  pivot
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  c
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                decr
                                                (
                                                  
                                                    p3
                                                )
                                              ;
                                                sequence
                                                (
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p2
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          !
                                                          (
                                                            
                                                              p3
                                                          )
                                                      )
                                                  )
                                                ;
                                                  Array.set
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p3
                                                      )
                                                    
                                                      e
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        c
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    incr
                                                    (
                                                      
                                                        p2
                                                    )
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                          
                                                            Array.get
                                                            (
                                                              
                                                                a
                                                              
                                                                !
                                                                (
                                                                  
                                                                    p1
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        sequence
                                                        (
                                                          Array.set
                                                          (
                                                            
                                                              a
                                                            
                                                              !
                                                              (
                                                                
                                                                  p1
                                                              )
                                                            
                                                              e
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            incr
                                                            (
                                                              
                                                                p1
                                                            )
                                                          ;
                                                            incr
                                                            (
                                                              
                                                                p2
                                                            )
                                                          )
                                                        )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    ;
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            !
                                            (
                                              
                                                p1
                                            )
                                          
                                            l
                                        )
                                        sequence
                                        (
                                          decr
                                          (
                                            
                                              p1
                                          )
                                        ;
                                          sequence
                                          (
                                            decr
                                            (
                                              
                                                p2
                                            )
                                          ;
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      !
                                                      (
                                                        
                                                          p1
                                                      )
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p1
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        p2
                                                    )
                                                  
                                                    e
                                                )
                                              )
                                            )
                                          )
                                        )
                                      ;
                                        let
                                        (
                                          (
                                            len1
                                              -
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      p2
                                                  )
                                                
                                                  l
                                              )
                                            len2
                                              -
                                              (
                                                
                                                  r
                                                
                                                  !
                                                  (
                                                    
                                                      p3
                                                  )
                                              )
                                          )
                                        in
                                          ifthenelse
                                          (
                                            if
                                            (
                                              >
                                              (
                                                
                                                  len1
                                                
                                                  cutoff
                                              )
                                            )
                                            then
                                            (
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  >
                                                  (
                                                    
                                                      len2
                                                    
                                                      cutoff
                                                  )
                                                )
                                                then
                                                (
                                                  ifthenelse
                                                  (
                                                    if
                                                    (
                                                      <
                                                      (
                                                        
                                                          len1
                                                        
                                                          len2
                                                      )
                                                    )
                                                    then
                                                    (
                                                      sequence
                                                      (
                                                        qsort
                                                        (
                                                          
                                                            l
                                                          
                                                            !
                                                            (
                                                              
                                                                p2
                                                            )
                                                        )
                                                      ;
                                                        qsort
                                                        (
                                                          
                                                            !
                                                            (
                                                              
                                                                p3
                                                            )
                                                          
                                                            r
                                                        )
                                                      )
                                                    )
                                                    else
                                                    (
                                                        sequence
                                                        (
                                                          qsort
                                                          (
                                                            
                                                              !
                                                              (
                                                                
                                                                  p3
                                                              )
                                                            
                                                              r
                                                          )
                                                        ;
                                                          qsort
                                                          (
                                                            
                                                              l
                                                            
                                                              !
                                                              (
                                                                
                                                                  p2
                                                              )
                                                          )
                                                        )
                                                    )
                                                  )
                                                )
                                                else
                                                (
                                                    qsort
                                                    (
                                                      
                                                        l
                                                      
                                                        !
                                                        (
                                                          
                                                            p2
                                                        )
                                                    )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        len2
                                                      
                                                        cutoff
                                                    )
                                                  )
                                                  then
                                                  (
                                                    qsort
                                                    (
                                                      
                                                        !
                                                        (
                                                          
                                                            p3
                                                        )
                                                      
                                                        r
                                                    )
                                                  )
                                                  else
                                                  (
                                                                                                      )
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    l
                      Array.length
                      (
                        
                          a
                      )
                  )
                in
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          l
                        
                          1
                      )
                    )
                    then
                    (
                      sequence
                      (
                        qsort
                        (
                          
                            0
                          
                            l
                        )
                      ;
                        let
                        (
                          (
                            mini
                              ref
                              (
                                
                                  0
                              )
                          )
                        in
                          sequence
                          (
                            for i
                            0
                            -
                            (
                              
                                min
                                (
                                  
                                    l
                                  
                                    cutoff
                                )
                              
                                1
                            )
                            ifthenelse
                            (
                              if
                              (
                                <
                                (
                                  
                                    cmp
                                    (
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            !
                                            (
                                              
                                                mini
                                            )
                                        )
                                    )
                                  
                                    0
                                )
                              )
                              then
                              (
                                :=
                                (
                                  
                                    mini
                                  
                                    i
                                )
                              )
                              else
                              (
                                                              )
                            )
                          ;
                            let
                            (
                              (
                                e
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    0
                                  
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            mini
                                        )
                                    )
                                )
                              ;
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      !
                                      (
                                        
                                          mini
                                      )
                                    
                                      e
                                  )
                                ;
                                  for i
                                  1
                                  -
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      e
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            i
                                        )
                                    )
                                  in
                                    let
                                    (
                                      (
                                        j
                                          ref
                                          (
                                            
                                              -
                                              (
                                                
                                                  i
                                                
                                                  1
                                              )
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        while
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    !
                                                    (
                                                      
                                                        j
                                                    )
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              +
                                              (
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                                
                                                  1
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  !
                                                  (
                                                    
                                                      j
                                                  )
                                              )
                                          )
                                        ;
                                          decr
                                          (
                                            
                                              j
                                          )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            +
                                            (
                                              
                                                !
                                                (
                                                  
                                                    j
                                                )
                                              
                                                1
                                            )
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                    else
                    (
                                          )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    aheap_1
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  l
                    ref
                    (
                      
                        Array.length
                        (
                          
                            a
                        )
                    )
                )
              in
                let
                (
                  (
                    l3
                      ref
                      (
                        
                          /
                          (
                            
                              +
                              (
                                
                                  !
                                  (
                                    
                                      l
                                  )
                                
                                  1
                              )
                            
                              3
                          )
                      )
                  )
                in
                  let
                  (
                    (
                      maxson
                        (
                          case
                          (
                            i
                            let
                            (
                              (
                                i31
                                  +
                                  (
                                    
                                      +
                                      (
                                        
                                          +
                                          (
                                            
                                              i
                                            
                                              i
                                          )
                                        
                                          i
                                      )
                                    
                                      1
                                  )
                              )
                            in
                              let
                              (
                                (
                                  x
                                    ref
                                    (
                                      
                                        i31
                                    )
                                )
                              in
                                ifthenelse
                                (
                                  if
                                  (
                                    <
                                    (
                                      
                                        +
                                        (
                                          
                                            i31
                                          
                                            2
                                        )
                                      
                                        !
                                        (
                                          
                                            l
                                        )
                                    )
                                  )
                                  then
                                  (
                                    sequence
                                    (
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      i31
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      +
                                                      (
                                                        
                                                          i31
                                                        
                                                          1
                                                      )
                                                  )
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          :=
                                          (
                                            
                                              x
                                            
                                              +
                                              (
                                                
                                                  i31
                                                
                                                  1
                                              )
                                          )
                                        )
                                        else
                                        (
                                                                                  )
                                      )
                                    ;
                                      sequence
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            x
                                                        )
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        +
                                                        (
                                                          
                                                            i31
                                                          
                                                            2
                                                        )
                                                    )
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            :=
                                            (
                                              
                                                x
                                              
                                                +
                                                (
                                                  
                                                    i31
                                                  
                                                    2
                                                )
                                            )
                                          )
                                          else
                                          (
                                                                                      )
                                        )
                                      ;
                                        !
                                        (
                                          
                                            x
                                        )
                                      )
                                    )
                                  )
                                  else
                                  (
                                      ifthenelse
                                      (
                                        if
                                        (
                                          &&
                                          (
                                            
                                              <
                                              (
                                                
                                                  +
                                                  (
                                                    
                                                      i31
                                                    
                                                      1
                                                  )
                                                
                                                  !
                                                  (
                                                    
                                                      l
                                                  )
                                              )
                                            
                                              <
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          i31
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              i31
                                                            
                                                              1
                                                          )
                                                      )
                                                  )
                                                
                                                  0
                                              )
                                          )
                                        )
                                        then
                                        (
                                          +
                                          (
                                            
                                              i31
                                            
                                              1
                                          )
                                        )
                                        else
                                        (
                                            i31
                                        )
                                      )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        trickledown
                          (
                            case
                            (
                              i
                              (
                                case
                                (
                                  e
                                  let
                                  (
                                    (
                                      j
                                        maxson
                                        (
                                          
                                            i
                                        )
                                    )
                                  in
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    j
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  j
                                              )
                                          )
                                        ;
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <
                                              (
                                                
                                                  j
                                                
                                                  !
                                                  (
                                                    
                                                      l3
                                                  )
                                              )
                                            )
                                            then
                                            (
                                              trickledown
                                              (
                                                
                                                  j
                                                
                                                  e
                                              )
                                            )
                                            else
                                            (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    j
                                                  
                                                    e
                                                )
                                            )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              e
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                      )
                    in
                      sequence
                      (
                        for i
                        -
                        (
                          
                            !
                            (
                              
                                l3
                            )
                          
                            1
                        )
                        0
                        trickledown
                        (
                          
                            i
                          
                            Array.get
                            (
                              
                                a
                              
                                i
                            )
                        )
                      ;
                        let
                        (
                          (
                            m
                              ref
                              (
                                
                                  -
                                  (
                                    
                                      +
                                      (
                                        
                                          !
                                          (
                                            
                                              l
                                          )
                                        
                                          1
                                      )
                                    
                                      *
                                      (
                                        
                                          3
                                        
                                          !
                                          (
                                            
                                              l3
                                          )
                                      )
                                  )
                              )
                          )
                        in
                          sequence
                          (
                            while
                            >
                            (
                              
                                !
                                (
                                  
                                    l
                                )
                              
                                2
                            )
                            sequence
                            (
                              decr
                              (
                                
                                  l
                              )
                            ;
                              sequence
                              (
                                ifthenelse
                                (
                                  if
                                  (
                                    =
                                    (
                                      
                                        !
                                        (
                                          
                                            m
                                        )
                                      
                                        0
                                    )
                                  )
                                  then
                                  (
                                    sequence
                                    (
                                      :=
                                      (
                                        
                                          m
                                        
                                          2
                                      )
                                    ;
                                      decr
                                      (
                                        
                                          l3
                                      )
                                    )
                                  )
                                  else
                                  (
                                      decr
                                      (
                                        
                                          m
                                      )
                                  )
                                )
                              ;
                                let
                                (
                                  (
                                    e
                                      Array.get
                                      (
                                        
                                          a
                                        
                                          !
                                          (
                                            
                                              l
                                          )
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    Array.set
                                    (
                                      
                                        a
                                      
                                        !
                                        (
                                          
                                            l
                                        )
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                  ;
                                    trickledown
                                    (
                                      
                                        0
                                      
                                        e
                                    )
                                  )
                                )
                              )
                            )
                          ;
                            ifthenelse
                            (
                              if
                              (
                                >
                                (
                                  
                                    !
                                    (
                                      
                                        l
                                    )
                                  
                                    1
                                )
                              )
                              then
                              (
                                let
                                (
                                  (
                                    e
                                      Array.get
                                      (
                                        
                                          a
                                        
                                          1
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    Array.set
                                    (
                                      
                                        a
                                      
                                        1
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                  ;
                                    Array.set
                                    (
                                      
                                        a
                                      
                                        0
                                      
                                        e
                                    )
                                  )
                                )
                              )
                              else
                              (
                                                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    aheap_2
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  maxson
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            i
                            (
                              case
                              (
                                e
                                let
                                (
                                  (
                                    i21
                                      +
                                      (
                                        
                                          +
                                          (
                                            
                                              i
                                            
                                              i
                                          )
                                        
                                          1
                                      )
                                  )
                                in
                                  ifthenelse
                                  (
                                    if
                                    (
                                      &&
                                      (
                                        
                                          <
                                          (
                                            
                                              +
                                              (
                                                
                                                  i21
                                                
                                                  1
                                              )
                                            
                                              l
                                          )
                                        
                                          <
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      i21
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      +
                                                      (
                                                        
                                                          i21
                                                        
                                                          1
                                                      )
                                                  )
                                              )
                                            
                                              0
                                          )
                                      )
                                    )
                                    then
                                    (
                                      +
                                      (
                                        
                                          i21
                                        
                                          1
                                      )
                                    )
                                    else
                                    (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <
                                            (
                                              
                                                i21
                                              
                                                l
                                            )
                                          )
                                          then
                                          (
                                            i21
                                          )
                                          else
                                          (
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    i
                                                  
                                                    e
                                                )
                                              ;
                                                raise
                                                (
                                                  
                                                    Exit
                                                                                                    )
                                              )
                                          )
                                        )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    trickledown
                      (
                        case
                        (
                          l
                          (
                            case
                            (
                              i
                              (
                                case
                                (
                                  e
                                  let
                                  (
                                    (
                                      j
                                        maxson
                                        (
                                          
                                            l
                                          
                                            i
                                          
                                            e
                                        )
                                    )
                                  in
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    j
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  j
                                              )
                                          )
                                        ;
                                          trickledown
                                          (
                                            
                                              l
                                            
                                              j
                                            
                                              e
                                          )
                                        )
                                      )
                                      else
                                      (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              e
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      down
                        (
                          case
                          (
                            l
                            (
                              case
                              (
                                i
                                (
                                  case
                                  (
                                    e
                                    try
                                    trickledown
                                    (
                                      
                                        l
                                      
                                        i
                                      
                                        e
                                    )
                                    (
                                      case
                                      (
                                        Exit
                                                                                ()
                                                                              )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      sequence
                      (
                        for i
                        -
                        (
                          
                            /
                            (
                              
                                l
                              
                                2
                            )
                          
                            1
                        )
                        0
                        down
                        (
                          
                            l
                          
                            i
                          
                            Array.get
                            (
                              
                                a
                              
                                i
                            )
                        )
                      ;
                        for i
                        -
                        (
                          
                            l
                          
                            1
                        )
                        1
                        let
                        (
                          (
                            e
                              Array.get
                              (
                                
                                  a
                                
                                  i
                              )
                          )
                        in
                          sequence
                          (
                            Array.set
                            (
                              
                                a
                              
                                i
                              
                                Array.get
                                (
                                  
                                    a
                                  
                                    0
                                )
                            )
                          ;
                            down
                            (
                              
                                i
                              
                                0
                              
                                e
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  exception Bottom
  (
       int
      (
      )
  )
  let
  (
    aheap_3
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  maxson
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            i
                            let
                            (
                              (
                                i31
                                  +
                                  (
                                    
                                      +
                                      (
                                        
                                          +
                                          (
                                            
                                              i
                                            
                                              i
                                          )
                                        
                                          i
                                      )
                                    
                                      1
                                  )
                              )
                            in
                              let
                              (
                                (
                                  x
                                    ref
                                    (
                                      
                                        i31
                                    )
                                )
                              in
                                ifthenelse
                                (
                                  if
                                  (
                                    <
                                    (
                                      
                                        +
                                        (
                                          
                                            i31
                                          
                                            2
                                        )
                                      
                                        l
                                    )
                                  )
                                  then
                                  (
                                    sequence
                                    (
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      i31
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      +
                                                      (
                                                        
                                                          i31
                                                        
                                                          1
                                                      )
                                                  )
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          :=
                                          (
                                            
                                              x
                                            
                                              +
                                              (
                                                
                                                  i31
                                                
                                                  1
                                              )
                                          )
                                        )
                                        else
                                        (
                                                                                  )
                                      )
                                    ;
                                      sequence
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            x
                                                        )
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        +
                                                        (
                                                          
                                                            i31
                                                          
                                                            2
                                                        )
                                                    )
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            :=
                                            (
                                              
                                                x
                                              
                                                +
                                                (
                                                  
                                                    i31
                                                  
                                                    2
                                                )
                                            )
                                          )
                                          else
                                          (
                                                                                      )
                                        )
                                      ;
                                        !
                                        (
                                          
                                            x
                                        )
                                      )
                                    )
                                  )
                                  else
                                  (
                                      ifthenelse
                                      (
                                        if
                                        (
                                          &&
                                          (
                                            
                                              <
                                              (
                                                
                                                  +
                                                  (
                                                    
                                                      i31
                                                    
                                                      1
                                                  )
                                                
                                                  l
                                              )
                                            
                                              <
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          i31
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              i31
                                                            
                                                              1
                                                          )
                                                      )
                                                  )
                                                
                                                  0
                                              )
                                          )
                                        )
                                        then
                                        (
                                          +
                                          (
                                            
                                              i31
                                            
                                              1
                                          )
                                        )
                                        else
                                        (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <
                                                (
                                                  
                                                    i31
                                                  
                                                    l
                                                )
                                              )
                                              then
                                              (
                                                i31
                                              )
                                              else
                                              (
                                                  raise
                                                  (
                                                    
                                                      Bottom
                                                        i
                                                  )
                                              )
                                            )
                                        )
                                      )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    trickledown
                      (
                        case
                        (
                          l
                          (
                            case
                            (
                              i
                              (
                                case
                                (
                                  e
                                  let
                                  (
                                    (
                                      j
                                        maxson
                                        (
                                          
                                            l
                                          
                                            i
                                        )
                                    )
                                  in
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    j
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  j
                                              )
                                          )
                                        ;
                                          trickledown
                                          (
                                            
                                              l
                                            
                                              j
                                            
                                              e
                                          )
                                        )
                                      )
                                      else
                                      (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              e
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      trickle
                        (
                          case
                          (
                            l
                            (
                              case
                              (
                                i
                                (
                                  case
                                  (
                                    e
                                    try
                                    trickledown
                                    (
                                      
                                        l
                                      
                                        i
                                      
                                        e
                                    )
                                    (
                                      case
                                      (
                                        Bottom
                                          i
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            i
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        bubbledown
                          (
                            case
                            (
                              l
                              (
                                case
                                (
                                  i
                                  let
                                  (
                                    (
                                      j
                                        maxson
                                        (
                                          
                                            l
                                          
                                            i
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      Array.set
                                      (
                                        
                                          a
                                        
                                          i
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              j
                                          )
                                      )
                                    ;
                                      bubbledown
                                      (
                                        
                                          l
                                        
                                          j
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                      )
                    in
                      let
                      (
                        (
                          bubble
                            (
                              case
                              (
                                l
                                (
                                  case
                                  (
                                    i
                                    try
                                    bubbledown
                                    (
                                      
                                        l
                                      
                                        i
                                    )
                                    (
                                      case
                                      (
                                        Bottom
                                          i
                                        i
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      in
                        let
                        (
                          (
                            trickleup
                              (
                                case
                                (
                                  i
                                  (
                                    case
                                    (
                                      e
                                      let
                                      (
                                        (
                                          father
                                            /
                                            (
                                              
                                                -
                                                (
                                                  
                                                    i
                                                  
                                                    1
                                                )
                                              
                                                3
                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          assert                                          <>
                                          (
                                            
                                              i
                                            
                                              father
                                          )
                                          
                                        ;
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          father
                                                      )
                                                    
                                                      e
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    i
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        father
                                                    )
                                                )
                                              ;
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        father
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    trickleup
                                                    (
                                                      
                                                        father
                                                      
                                                        e
                                                    )
                                                  )
                                                  else
                                                  (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          0
                                                        
                                                          e
                                                      )
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    i
                                                  
                                                    e
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                          )
                        in
                          let
                          (
                            (
                              l
                                Array.length
                                (
                                  
                                    a
                                )
                            )
                          in
                            sequence
                            (
                              for i
                              -
                              (
                                
                                  /
                                  (
                                    
                                      +
                                      (
                                        
                                          l
                                        
                                          1
                                      )
                                    
                                      3
                                  )
                                
                                  1
                              )
                              0
                              trickle
                              (
                                
                                  l
                                
                                  i
                                
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      i
                                  )
                              )
                            ;
                              sequence
                              (
                                for i
                                -
                                (
                                  
                                    l
                                  
                                    1
                                )
                                2
                                let
                                (
                                  (
                                    e
                                      Array.get
                                      (
                                        
                                          a
                                        
                                          i
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    Array.set
                                    (
                                      
                                        a
                                      
                                        i
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                  ;
                                    trickleup
                                    (
                                      
                                        bubble
                                        (
                                          
                                            i
                                          
                                            0
                                        )
                                      
                                        e
                                    )
                                  )
                                )
                              ;
                                ifthenelse
                                (
                                  if
                                  (
                                    >
                                    (
                                      
                                        l
                                      
                                        1
                                    )
                                  )
                                  then
                                  (
                                    let
                                    (
                                      (
                                        e
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              1
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            1
                                          
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                0
                                            )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            0
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                  else
                                  (
                                                                      )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    aheap_4
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  maxson
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            i
                            let
                            (
                              (
                                i21
                                  +
                                  (
                                    
                                      +
                                      (
                                        
                                          i
                                        
                                          i
                                      )
                                    
                                      1
                                  )
                              )
                            in
                              ifthenelse
                              (
                                if
                                (
                                  &&
                                  (
                                    
                                      <
                                      (
                                        
                                          +
                                          (
                                            
                                              i21
                                            
                                              1
                                          )
                                        
                                          l
                                      )
                                    
                                      <
                                      (
                                        
                                          cmp
                                          (
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  i21
                                              )
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  +
                                                  (
                                                    
                                                      i21
                                                    
                                                      1
                                                  )
                                              )
                                          )
                                        
                                          0
                                      )
                                  )
                                )
                                then
                                (
                                  +
                                  (
                                    
                                      i21
                                    
                                      1
                                  )
                                )
                                else
                                (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <
                                        (
                                          
                                            i21
                                          
                                            l
                                        )
                                      )
                                      then
                                      (
                                        i21
                                      )
                                      else
                                      (
                                          raise
                                          (
                                            
                                              Bottom
                                                i
                                          )
                                      )
                                    )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    trickledown
                      (
                        case
                        (
                          l
                          (
                            case
                            (
                              i
                              (
                                case
                                (
                                  e
                                  let
                                  (
                                    (
                                      j
                                        maxson
                                        (
                                          
                                            l
                                          
                                            i
                                        )
                                    )
                                  in
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    j
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  j
                                              )
                                          )
                                        ;
                                          trickledown
                                          (
                                            
                                              l
                                            
                                              j
                                            
                                              e
                                          )
                                        )
                                      )
                                      else
                                      (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              e
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      trickle
                        (
                          case
                          (
                            l
                            (
                              case
                              (
                                i
                                (
                                  case
                                  (
                                    e
                                    try
                                    trickledown
                                    (
                                      
                                        l
                                      
                                        i
                                      
                                        e
                                    )
                                    (
                                      case
                                      (
                                        Bottom
                                          i
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            i
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        bubbledown
                          (
                            case
                            (
                              l
                              (
                                case
                                (
                                  i
                                  let
                                  (
                                    (
                                      j
                                        maxson
                                        (
                                          
                                            l
                                          
                                            i
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      Array.set
                                      (
                                        
                                          a
                                        
                                          i
                                        
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              j
                                          )
                                      )
                                    ;
                                      bubbledown
                                      (
                                        
                                          l
                                        
                                          j
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                      )
                    in
                      let
                      (
                        (
                          bubble
                            (
                              case
                              (
                                l
                                (
                                  case
                                  (
                                    i
                                    try
                                    bubbledown
                                    (
                                      
                                        l
                                      
                                        i
                                    )
                                    (
                                      case
                                      (
                                        Bottom
                                          i
                                        i
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      in
                        let
                        (
                          (
                            trickleup
                              (
                                case
                                (
                                  i
                                  (
                                    case
                                    (
                                      e
                                      let
                                      (
                                        (
                                          father
                                            /
                                            (
                                              
                                                -
                                                (
                                                  
                                                    i
                                                  
                                                    1
                                                )
                                              
                                                2
                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          assert                                          <>
                                          (
                                            
                                              i
                                            
                                              father
                                          )
                                          
                                        ;
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          father
                                                      )
                                                    
                                                      e
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    i
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        father
                                                    )
                                                )
                                              ;
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    >
                                                    (
                                                      
                                                        father
                                                      
                                                        0
                                                    )
                                                  )
                                                  then
                                                  (
                                                    trickleup
                                                    (
                                                      
                                                        father
                                                      
                                                        e
                                                    )
                                                  )
                                                  else
                                                  (
                                                      Array.set
                                                      (
                                                        
                                                          a
                                                        
                                                          0
                                                        
                                                          e
                                                      )
                                                  )
                                                )
                                              )
                                            )
                                            else
                                            (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    i
                                                  
                                                    e
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                          )
                        in
                          let
                          (
                            (
                              l
                                Array.length
                                (
                                  
                                    a
                                )
                            )
                          in
                            sequence
                            (
                              for i
                              -
                              (
                                
                                  /
                                  (
                                    
                                      l
                                    
                                      2
                                  )
                                
                                  1
                              )
                              0
                              trickle
                              (
                                
                                  l
                                
                                  i
                                
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      i
                                  )
                              )
                            ;
                              sequence
                              (
                                for i
                                -
                                (
                                  
                                    l
                                  
                                    1
                                )
                                2
                                let
                                (
                                  (
                                    e
                                      Array.get
                                      (
                                        
                                          a
                                        
                                          i
                                      )
                                  )
                                in
                                  sequence
                                  (
                                    Array.set
                                    (
                                      
                                        a
                                      
                                        i
                                      
                                        Array.get
                                        (
                                          
                                            a
                                          
                                            0
                                        )
                                    )
                                  ;
                                    trickleup
                                    (
                                      
                                        bubble
                                        (
                                          
                                            i
                                          
                                            0
                                        )
                                      
                                        e
                                    )
                                  )
                                )
                              ;
                                ifthenelse
                                (
                                  if
                                  (
                                    >
                                    (
                                      
                                        l
                                      
                                        1
                                    )
                                  )
                                  then
                                  (
                                    let
                                    (
                                      (
                                        e
                                          Array.get
                                          (
                                            
                                              a
                                            
                                              1
                                          )
                                      )
                                    in
                                      sequence
                                      (
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            1
                                          
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                0
                                            )
                                        )
                                      ;
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            0
                                          
                                            e
                                        )
                                      )
                                    )
                                  )
                                  else
                                  (
                                                                      )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    aheap_5
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  maxson
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            i
                            let
                            (
                              (
                                i31
                                  +
                                  (
                                    
                                      +
                                      (
                                        
                                          +
                                          (
                                            
                                              i
                                            
                                              i
                                          )
                                        
                                          i
                                      )
                                    
                                      1
                                  )
                              )
                            in
                              let
                              (
                                (
                                  x
                                    ref
                                    (
                                      
                                        i31
                                    )
                                )
                              in
                                ifthenelse
                                (
                                  if
                                  (
                                    <
                                    (
                                      
                                        +
                                        (
                                          
                                            i31
                                          
                                            2
                                        )
                                      
                                        l
                                    )
                                  )
                                  then
                                  (
                                    sequence
                                    (
                                      ifthenelse
                                      (
                                        if
                                        (
                                          <
                                          (
                                            
                                              cmp
                                              (
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      i31
                                                  )
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      +
                                                      (
                                                        
                                                          i31
                                                        
                                                          1
                                                      )
                                                  )
                                              )
                                            
                                              0
                                          )
                                        )
                                        then
                                        (
                                          :=
                                          (
                                            
                                              x
                                            
                                              +
                                              (
                                                
                                                  i31
                                                
                                                  1
                                              )
                                          )
                                        )
                                        else
                                        (
                                                                                  )
                                      )
                                    ;
                                      sequence
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        !
                                                        (
                                                          
                                                            x
                                                        )
                                                    )
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        +
                                                        (
                                                          
                                                            i31
                                                          
                                                            2
                                                        )
                                                    )
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            :=
                                            (
                                              
                                                x
                                              
                                                +
                                                (
                                                  
                                                    i31
                                                  
                                                    2
                                                )
                                            )
                                          )
                                          else
                                          (
                                                                                      )
                                        )
                                      ;
                                        !
                                        (
                                          
                                            x
                                        )
                                      )
                                    )
                                  )
                                  else
                                  (
                                      ifthenelse
                                      (
                                        if
                                        (
                                          &&
                                          (
                                            
                                              <
                                              (
                                                
                                                  +
                                                  (
                                                    
                                                      i31
                                                    
                                                      1
                                                  )
                                                
                                                  l
                                              )
                                            
                                              <
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          i31
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              i31
                                                            
                                                              1
                                                          )
                                                      )
                                                  )
                                                
                                                  0
                                              )
                                          )
                                        )
                                        then
                                        (
                                          +
                                          (
                                            
                                              i31
                                            
                                              1
                                          )
                                        )
                                        else
                                        (
                                            i31
                                        )
                                      )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    trickledown
                      (
                        case
                        (
                          l
                          (
                            case
                            (
                              l3
                              (
                                case
                                (
                                  i
                                  (
                                    case
                                    (
                                      e
                                      let
                                      (
                                        (
                                          j
                                            maxson
                                            (
                                              
                                                l
                                              
                                                i
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            >
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        j
                                                    )
                                                  
                                                    e
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  a
                                                
                                                  i
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      j
                                                  )
                                              )
                                            ;
                                              ifthenelse
                                              (
                                                if
                                                (
                                                  <
                                                  (
                                                    
                                                      j
                                                    
                                                      l3
                                                  )
                                                )
                                                then
                                                (
                                                  trickledown
                                                  (
                                                    
                                                      l
                                                    
                                                      l3
                                                    
                                                      j
                                                    
                                                      e
                                                  )
                                                )
                                                else
                                                (
                                                    Array.set
                                                    (
                                                      
                                                        a
                                                      
                                                        j
                                                      
                                                        e
                                                    )
                                                )
                                              )
                                            )
                                          )
                                          else
                                          (
                                              Array.set
                                              (
                                                
                                                  a
                                                
                                                  i
                                                
                                                  e
                                              )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      l
                        Array.length
                        (
                          
                            a
                        )
                    )
                  in
                    let
                    (
                      (
                        l3
                          /
                          (
                            
                              +
                              (
                                
                                  l
                                
                                  1
                              )
                            
                              3
                          )
                      )
                    in
                      sequence
                      (
                        for i
                        -
                        (
                          
                            l3
                          
                            1
                        )
                        0
                        trickledown
                        (
                          
                            l
                          
                            l3
                          
                            i
                          
                            Array.get
                            (
                              
                                a
                              
                                i
                            )
                        )
                      ;
                        let
                        (
                          (
                            loop0
                              (
                                case
                                (
                                  l
                                  (
                                    case
                                    (
                                      l3
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                l
                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              l
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  0
                                              )
                                          )
                                        ;
                                          sequence
                                          (
                                            trickledown
                                            (
                                              
                                                l
                                              
                                                l3
                                              
                                                0
                                              
                                                e
                                            )
                                          ;
                                            loop2
                                            (
                                              
                                                -
                                                (
                                                  
                                                    l
                                                  
                                                    1
                                                )
                                              
                                                -
                                                (
                                                  
                                                    l3
                                                  
                                                    1
                                                )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            loop1
                              (
                                case
                                (
                                  l
                                  (
                                    case
                                    (
                                      l3
                                      let
                                      (
                                        (
                                          e
                                            Array.get
                                            (
                                              
                                                a
                                              
                                                l
                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              l
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  0
                                              )
                                          )
                                        ;
                                          sequence
                                          (
                                            trickledown
                                            (
                                              
                                                l
                                              
                                                l3
                                              
                                                0
                                              
                                                e
                                            )
                                          ;
                                            loop0
                                            (
                                              
                                                -
                                                (
                                                  
                                                    l
                                                  
                                                    1
                                                )
                                              
                                                l3
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            loop2
                              (
                                case
                                (
                                  l
                                  (
                                    case
                                    (
                                      l3
                                      ifthenelse
                                      (
                                        if
                                        (
                                          >
                                          (
                                            
                                              l
                                            
                                              1
                                          )
                                        )
                                        then
                                        (
                                          let
                                          (
                                            (
                                              e
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    l
                                                )
                                            )
                                          in
                                            sequence
                                            (
                                              Array.set
                                              (
                                                
                                                  a
                                                
                                                  l
                                                
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      0
                                                  )
                                              )
                                            ;
                                              sequence
                                              (
                                                trickledown
                                                (
                                                  
                                                    l
                                                  
                                                    l3
                                                  
                                                    0
                                                  
                                                    e
                                                )
                                              ;
                                                loop1
                                                (
                                                  
                                                    -
                                                    (
                                                      
                                                        l
                                                      
                                                        1
                                                    )
                                                  
                                                    l3
                                                )
                                              )
                                            )
                                          )
                                        )
                                        else
                                        (
                                            let
                                            (
                                              (
                                                e
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      1
                                                  )
                                              )
                                            in
                                              sequence
                                              (
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    1
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        0
                                                    )
                                                )
                                              ;
                                                Array.set
                                                (
                                                  
                                                    a
                                                  
                                                    0
                                                  
                                                    e
                                                )
                                              )
                                            )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                          )
                        in
                          ifthenelse
                          (
                            if
                            (
                              >
                              (
                                
                                  l
                                
                                  1
                              )
                            )
                            then
                            (
                              match
                              -
                              (
                                
                                  +
                                  (
                                    
                                      l
                                    
                                      1
                                  )
                                
                                  *
                                  (
                                    
                                      3
                                    
                                      l3
                                  )
                              )
                              (
                                case
                                (
                                  0
                                  loop2
                                  (
                                    
                                      -
                                      (
                                        
                                          l
                                        
                                          1
                                      )
                                    
                                      -
                                      (
                                        
                                          l3
                                        
                                          1
                                      )
                                  )
                                )
                                case
                                (
                                  1
                                  loop0
                                  (
                                    
                                      -
                                      (
                                        
                                          l
                                        
                                          1
                                      )
                                    
                                      l3
                                  )
                                )
                                case
                                (
                                  2
                                  loop1
                                  (
                                    
                                      -
                                      (
                                        
                                          l
                                        
                                          1
                                      )
                                    
                                      l3
                                  )
                                )
                                case
                                (
                                  _
                                  assert false
                                )
                              )
                            )
                            else
                            (
                                                          )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    aheap_6
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  maxson
                    (
                      case
                      (
                        e
                        (
                          case
                          (
                            l
                            (
                              case
                              (
                                i
                                let
                                (
                                  (
                                    i31
                                      +
                                      (
                                        
                                          +
                                          (
                                            
                                              +
                                              (
                                                
                                                  i
                                                
                                                  i
                                              )
                                            
                                              i
                                          )
                                        
                                          1
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      x
                                        ref
                                        (
                                          
                                            i31
                                        )
                                    )
                                  in
                                    ifthenelse
                                    (
                                      if
                                      (
                                        <
                                        (
                                          
                                            +
                                            (
                                              
                                                i31
                                              
                                                2
                                            )
                                          
                                            l
                                        )
                                      )
                                      then
                                      (
                                        sequence
                                        (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              <
                                              (
                                                
                                                  cmp
                                                  (
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          i31
                                                      )
                                                    
                                                      Array.get
                                                      (
                                                        
                                                          a
                                                        
                                                          +
                                                          (
                                                            
                                                              i31
                                                            
                                                              1
                                                          )
                                                      )
                                                  )
                                                
                                                  0
                                              )
                                            )
                                            then
                                            (
                                              :=
                                              (
                                                
                                                  x
                                                
                                                  +
                                                  (
                                                    
                                                      i31
                                                    
                                                      1
                                                  )
                                              )
                                            )
                                            else
                                            (
                                                                                          )
                                          )
                                        ;
                                          sequence
                                          (
                                            ifthenelse
                                            (
                                              if
                                              (
                                                <
                                                (
                                                  
                                                    cmp
                                                    (
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            !
                                                            (
                                                              
                                                                x
                                                            )
                                                        )
                                                      
                                                        Array.get
                                                        (
                                                          
                                                            a
                                                          
                                                            +
                                                            (
                                                              
                                                                i31
                                                              
                                                                2
                                                            )
                                                        )
                                                    )
                                                  
                                                    0
                                                )
                                              )
                                              then
                                              (
                                                :=
                                                (
                                                  
                                                    x
                                                  
                                                    +
                                                    (
                                                      
                                                        i31
                                                      
                                                        2
                                                    )
                                                )
                                              )
                                              else
                                              (
                                                                                              )
                                            )
                                          ;
                                            !
                                            (
                                              
                                                x
                                            )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          ifthenelse
                                          (
                                            if
                                            (
                                              &&
                                              (
                                                
                                                  <
                                                  (
                                                    
                                                      +
                                                      (
                                                        
                                                          i31
                                                        
                                                          1
                                                      )
                                                    
                                                      l
                                                  )
                                                
                                                  <
                                                  (
                                                    
                                                      cmp
                                                      (
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              i31
                                                          )
                                                        
                                                          Array.get
                                                          (
                                                            
                                                              a
                                                            
                                                              +
                                                              (
                                                                
                                                                  i31
                                                                
                                                                  1
                                                              )
                                                          )
                                                      )
                                                    
                                                      0
                                                  )
                                              )
                                            )
                                            then
                                            (
                                              +
                                              (
                                                
                                                  i31
                                                
                                                  1
                                              )
                                            )
                                            else
                                            (
                                                ifthenelse
                                                (
                                                  if
                                                  (
                                                    <
                                                    (
                                                      
                                                        i31
                                                      
                                                        l
                                                    )
                                                  )
                                                  then
                                                  (
                                                    i31
                                                  )
                                                  else
                                                  (
                                                      sequence
                                                      (
                                                        Array.set
                                                        (
                                                          
                                                            a
                                                          
                                                            i
                                                          
                                                            e
                                                        )
                                                      ;
                                                        raise
                                                        (
                                                          
                                                            Exit
                                                                                                                    )
                                                      )
                                                  )
                                                )
                                            )
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                let
                (
                  (
                    trickledown
                      (
                        case
                        (
                          e
                          (
                            case
                            (
                              l
                              (
                                case
                                (
                                  i
                                  let
                                  (
                                    (
                                      j
                                        maxson
                                        (
                                          
                                            e
                                          
                                            l
                                          
                                            i
                                        )
                                    )
                                  in
                                    ifthenelse
                                    (
                                      if
                                      (
                                        >
                                        (
                                          
                                            cmp
                                            (
                                              
                                                Array.get
                                                (
                                                  
                                                    a
                                                  
                                                    j
                                                )
                                              
                                                e
                                            )
                                          
                                            0
                                        )
                                      )
                                      then
                                      (
                                        sequence
                                        (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              Array.get
                                              (
                                                
                                                  a
                                                
                                                  j
                                              )
                                          )
                                        ;
                                          trickledown
                                          (
                                            
                                              e
                                            
                                              l
                                            
                                              j
                                          )
                                        )
                                      )
                                      else
                                      (
                                          Array.set
                                          (
                                            
                                              a
                                            
                                              i
                                            
                                              e
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  let
                  (
                    (
                      down
                        (
                          case
                          (
                            e
                            (
                              case
                              (
                                l
                                (
                                  case
                                  (
                                    i
                                    try
                                    trickledown
                                    (
                                      
                                        e
                                      
                                        l
                                      
                                        i
                                    )
                                    (
                                      case
                                      (
                                        Exit
                                                                                ()
                                                                              )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        l
                          Array.length
                          (
                            
                              a
                          )
                      )
                    in
                      sequence
                      (
                        for i
                        -
                        (
                          
                            /
                            (
                              
                                +
                                (
                                  
                                    l
                                  
                                    1
                                )
                              
                                3
                            )
                          
                            1
                        )
                        0
                        down
                        (
                          
                            Array.get
                            (
                              
                                a
                              
                                i
                            )
                          
                            l
                          
                            i
                        )
                      ;
                        sequence
                        (
                          for i
                          -
                          (
                            
                              l
                            
                              1
                          )
                          2
                          let
                          (
                            (
                              e
                                Array.get
                                (
                                  
                                    a
                                  
                                    i
                                )
                            )
                          in
                            sequence
                            (
                              Array.set
                              (
                                
                                  a
                                
                                  i
                                
                                  Array.get
                                  (
                                    
                                      a
                                    
                                      0
                                  )
                              )
                            ;
                              down
                              (
                                
                                  e
                                
                                  i
                                
                                  0
                              )
                            )
                          )
                        ;
                          ifthenelse
                          (
                            if
                            (
                              >
                              (
                                
                                  l
                                
                                  1
                              )
                            )
                            then
                            (
                              let
                              (
                                (
                                  e
                                    Array.get
                                    (
                                      
                                        a
                                      
                                        1
                                    )
                                )
                              in
                                sequence
                                (
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      1
                                    
                                      Array.get
                                      (
                                        
                                          a
                                        
                                          0
                                      )
                                  )
                                ;
                                  Array.set
                                  (
                                    
                                      a
                                    
                                      0
                                    
                                      e
                                  )
                                )
                              )
                            )
                            else
                            (
                                                          )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    ainsertion_1
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  dicho
                    (
                      case
                      (
                        l
                        (
                          case
                          (
                            r
                            (
                              case
                              (
                                e
                                ifthenelse
                                (
                                  if
                                  (
                                    =
                                    (
                                      
                                        l
                                      
                                        r
                                    )
                                  )
                                  then
                                  (
                                    l
                                  )
                                  else
                                  (
                                      let
                                      (
                                        (
                                          m
                                            /
                                            (
                                              
                                                +
                                                (
                                                  
                                                    l
                                                  
                                                    r
                                                )
                                              
                                                2
                                            )
                                        )
                                      in
                                        ifthenelse
                                        (
                                          if
                                          (
                                            <=
                                            (
                                              
                                                cmp
                                                (
                                                  
                                                    Array.get
                                                    (
                                                      
                                                        a
                                                      
                                                        m
                                                    )
                                                  
                                                    e
                                                )
                                              
                                                0
                                            )
                                          )
                                          then
                                          (
                                            dicho
                                            (
                                              
                                                +
                                                (
                                                  
                                                    m
                                                  
                                                    1
                                                )
                                              
                                                r
                                              
                                                e
                                            )
                                          )
                                          else
                                          (
                                              dicho
                                              (
                                                
                                                  l
                                                
                                                  m
                                                
                                                  e
                                              )
                                          )
                                        )
                                      )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                )
              in
                for i
                1
                -
                (
                  
                    Array.length
                    (
                      
                        a
                    )
                  
                    1
                )
                let
                (
                  (
                    e
                      Array.get
                      (
                        
                          a
                        
                          i
                      )
                  )
                in
                  let
                  (
                    (
                      j
                        dicho
                        (
                          
                            0
                          
                            i
                          
                            e
                        )
                    )
                  in
                    sequence
                    (
                      Array.blit
                      (
                        
                          a
                        
                          j
                        
                          a
                        
                          +
                          (
                            
                              j
                            
                              1
                          )
                        
                          -
                          (
                            
                              i
                            
                              j
                          )
                      )
                    ;
                      Array.set
                      (
                        
                          a
                        
                          j
                        
                          e
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    array_to_list_in_place
      (
        case
        (
          a
          let
          (
            (
              l
                Array.length
                (
                  
                    a
                )
            )
          in
            let
            (
              (
                loop
                  (
                    case
                    (
                      accu
                      (
                        case
                        (
                          n
                          (
                            case
                            (
                              p
                              ifthenelse
                              (
                                if
                                (
                                  <=
                                  (
                                    
                                      p
                                    
                                      0
                                  )
                                )
                                then
                                (
                                  accu
                                )
                                else
                                (
                                    ifthenelse
                                    (
                                      if
                                      (
                                        =
                                        (
                                          
                                            p
                                          
                                            n
                                        )
                                      )
                                      then
                                      (
                                        sequence
                                        (
                                          Obj.truncate
                                          (
                                            
                                              Obj.repr
                                              (
                                                
                                                  a
                                              )
                                            
                                              p
                                          )
                                        ;
                                          loop
                                          (
                                            
                                              ::
                                                (
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      -
                                                      (
                                                        
                                                          p
                                                        
                                                          1
                                                      )
                                                  )
                                                  accu
                                                )
                                            
                                              -
                                              (
                                                
                                                  n
                                                
                                                  1000
                                              )
                                            
                                              -
                                              (
                                                
                                                  p
                                                
                                                  1
                                              )
                                          )
                                        )
                                      )
                                      else
                                      (
                                          loop
                                          (
                                            
                                              ::
                                                (
                                                  Array.get
                                                  (
                                                    
                                                      a
                                                    
                                                      -
                                                      (
                                                        
                                                          p
                                                        
                                                          1
                                                      )
                                                  )
                                                  accu
                                                )
                                            
                                              n
                                            
                                              -
                                              (
                                                
                                                  p
                                                
                                                  1
                                              )
                                          )
                                      )
                                    )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
              )
            in
              loop
              (
                
                  []
                                  
                  l
                
                  l
              )
            )
          )
        )
      )
  )
  let
  (
    array_of_list
      (
        case
        (
          l
          (
            case
            (
              len
              match
              l
              (
                case
                (
                  []
                                    array
                  (
                  )
                )
                case
                (
                  ::
                    (
                      h
                      t
                    )
                  let
                  (
                    (
                      a
                        Array.make
                        (
                          
                            len
                          
                            h
                        )
                    )
                  in
                    let
                    (
                      (
                        loop
                          (
                            case
                            (
                              i
                              (
                                case
                                (
                                  l
                                  match
                                  l
                                  (
                                    case
                                    (
                                      []
                                                                            ()
                                                                          )
                                    case
                                    (
                                      ::
                                        (
                                          h
                                          t
                                        )
                                      sequence
                                      (
                                        Array.set
                                        (
                                          
                                            a
                                          
                                            i
                                          
                                            h
                                        )
                                      ;
                                        loop
                                        (
                                          
                                            +
                                            (
                                              
                                                i
                                              
                                                1
                                            )
                                          
                                            t
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                      )
                    in
                      sequence
                      (
                        loop
                        (
                          
                            1
                          
                            t
                        )
                      ;
                        a
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_0a
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  a
                    Array.of_list
                    (
                      
                        l
                    )
                )
              in
                sequence
                (
                  amerge_1e
                  (
                    
                      cmp
                    
                      a
                  )
                ;
                  array_to_list_in_place
                  (
                    
                      a
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lmerge_0b
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  len
                    List.length
                    (
                      
                        l
                    )
                )
              in
                sequence
                (
                  ifthenelse
                  (
                    if
                    (
                      >
                      (
                        
                          len
                        
                          256
                      )
                    )
                    then
                    (
                      Gc.minor
                      (
                        
                          ()
                                                )
                    )
                    else
                    (
                                          )
                  )
                ;
                  let
                  (
                    (
                      a
                        array_of_list
                        (
                          
                            l
                          
                            len
                        )
                    )
                  in
                    sequence
                    (
                      amerge_1e
                      (
                        
                          cmp
                        
                          a
                      )
                    ;
                      array_to_list_in_place
                      (
                        
                          a
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lshell_0
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  a
                    Array.of_list
                    (
                      
                        l
                    )
                )
              in
                sequence
                (
                  ashell_2
                  (
                    
                      cmp
                    
                      a
                  )
                ;
                  array_to_list_in_place
                  (
                    
                      a
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lquick_0
      (
        case
        (
          cmp
          (
            case
            (
              l
              let
              (
                (
                  a
                    Array.of_list
                    (
                      
                        l
                    )
                )
              in
                sequence
                (
                  aquick_3f
                  (
                    
                      cmp
                    
                      a
                  )
                ;
                  array_to_list_in_place
                  (
                    
                      a
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    amerge_0
      (
        case
        (
          cmp
          (
            case
            (
              a
              let
              (
                (
                  l
                    lmerge_4e
                    (
                      
                        cmp
                      
                        Array.to_list
                        (
                          
                            a
                        )
                    )
                )
              in
                let
                (
                  (
                    loop
                      (
                        case
                        (
                          i
                          (
                            case
                            (
                              []
                                                            ()
                                                          )
                            case
                            (
                              ::
                                (
                                  h
                                  t
                                )
                              sequence
                              (
                                Array.set
                                (
                                  
                                    a
                                  
                                    i
                                  
                                    h
                                )
                              ;
                                loop
                                (
                                  
                                    +
                                    (
                                      
                                        i
                                      
                                        1
                                    )
                                  
                                    t
                                )
                              )
                            )
                          )
                        )
                      )
                  )
                in
                  loop
                  (
                    
                      0
                    
                      l
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    lold
      ::
        (
          (
            "Sort.list"
            Sort.list
            true
                      )
          ::
            (
              (
                "lmerge_3"
                lmerge_3
                false
                              )
              ::
                (
                  (
                    "lmerge_4a"
                    lmerge_4a
                    true
                                      )
                  []
                                  )
            )
        )
  )
  let
  (
    lnew
      ::
        (
          (
            "List.stable_sort"
            List.stable_sort
            true
                      )
          ::
            (
              (
                "lmerge_0a"
                lmerge_0a
                true
                              )
              ::
                (
                  (
                    "lmerge_0b"
                    lmerge_0b
                    true
                                      )
                  ::
                    (
                      (
                        "lshell_0"
                        lshell_0
                        false
                                              )
                      ::
                        (
                          (
                            "lquick_0"
                            lquick_0
                            false
                                                      )
                          ::
                            (
                              (
                                "lmerge_1a"
                                lmerge_1a
                                true
                                                              )
                              ::
                                (
                                  (
                                    "lmerge_1b"
                                    lmerge_1b
                                    true
                                                                      )
                                  ::
                                    (
                                      (
                                        "lmerge_1c"
                                        lmerge_1c
                                        true
                                                                              )
                                      ::
                                        (
                                          (
                                            "lmerge_1d"
                                            lmerge_1d
                                            true
                                                                                      )
                                          ::
                                            (
                                              (
                                                "lmerge_4b"
                                                lmerge_4b
                                                true
                                                                                              )
                                              ::
                                                (
                                                  (
                                                    "lmerge_4c"
                                                    lmerge_4c
                                                    true
                                                                                                      )
                                                  ::
                                                    (
                                                      (
                                                        "lmerge_4d"
                                                        lmerge_4d
                                                        true
                                                                                                              )
                                                      ::
                                                        (
                                                          (
                                                            "lmerge_4e"
                                                            lmerge_4e
                                                            true
                                                                                                                      )
                                                          ::
                                                            (
                                                              (
                                                                "lmerge_5a"
                                                                lmerge_5a
                                                                true
                                                                                                                              )
                                                              ::
                                                                (
                                                                  (
                                                                    "lmerge_5b"
                                                                    lmerge_5b
                                                                    true
                                                                                                                                      )
                                                                  ::
                                                                    (
                                                                      (
                                                                        "lmerge_5c"
                                                                        lmerge_5c
                                                                        true
                                                                                                                                              )
                                                                      ::
                                                                        (
                                                                          (
                                                                            "lmerge_5d"
                                                                            lmerge_5d
                                                                            true
                                                                                                                                                      )
                                                                          []
                                                                                                                                                  )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
        )
  )
  let
  (
    anew
      ::
        (
          (
            "Array.stable_sort"
            Array.stable_sort
            true
                      )
          ::
            (
              (
                "Array.sort"
                Array.sort
                false
                              )
              ::
                (
                  (
                    "amerge_0"
                    amerge_0
                    true
                                      )
                  ::
                    (
                      (
                        "amerge_1a"
                        amerge_1a
                        true
                                              )
                      ::
                        (
                          (
                            "amerge_1b"
                            amerge_1b
                            true
                                                      )
                          ::
                            (
                              (
                                "amerge_1c"
                                amerge_1c
                                true
                                                              )
                              ::
                                (
                                  (
                                    "amerge_1d"
                                    amerge_1d
                                    true
                                                                      )
                                  ::
                                    (
                                      (
                                        "amerge_1e"
                                        amerge_1e
                                        true
                                                                              )
                                      ::
                                        (
                                          (
                                            "amerge_1f"
                                            amerge_1f
                                            true
                                                                                      )
                                          ::
                                            (
                                              (
                                                "amerge_1g"
                                                amerge_1g
                                                true
                                                                                              )
                                              ::
                                                (
                                                  (
                                                    "amerge_1h"
                                                    amerge_1h
                                                    true
                                                                                                      )
                                                  ::
                                                    (
                                                      (
                                                        "amerge_1i"
                                                        amerge_1i
                                                        true
                                                                                                              )
                                                      ::
                                                        (
                                                          (
                                                            "amerge_1j"
                                                            amerge_1j
                                                            true
                                                                                                                      )
                                                          ::
                                                            (
                                                              (
                                                                "amerge_3a"
                                                                amerge_3a
                                                                true
                                                                                                                              )
                                                              ::
                                                                (
                                                                  (
                                                                    "amerge_3b"
                                                                    amerge_3b
                                                                    true
                                                                                                                                      )
                                                                  ::
                                                                    (
                                                                      (
                                                                        "amerge_3c"
                                                                        amerge_3c
                                                                        true
                                                                                                                                              )
                                                                      ::
                                                                        (
                                                                          (
                                                                            "amerge_3d"
                                                                            amerge_3d
                                                                            true
                                                                                                                                                      )
                                                                          ::
                                                                            (
                                                                              (
                                                                                "amerge_3e"
                                                                                amerge_3e
                                                                                true
                                                                                                                                                              )
                                                                              ::
                                                                                (
                                                                                  (
                                                                                    "amerge_3f"
                                                                                    amerge_3f
                                                                                    true
                                                                                                                                                                      )
                                                                                  ::
                                                                                    (
                                                                                      (
                                                                                        "amerge_3g"
                                                                                        amerge_3g
                                                                                        true
                                                                                                                                                                              )
                                                                                      ::
                                                                                        (
                                                                                          (
                                                                                            "amerge_3h"
                                                                                            amerge_3h
                                                                                            true
                                                                                                                                                                                      )
                                                                                          ::
                                                                                            (
                                                                                              (
                                                                                                "amerge_3i"
                                                                                                amerge_3i
                                                                                                true
                                                                                                                                                                                              )
                                                                                              ::
                                                                                                (
                                                                                                  (
                                                                                                    "amerge_3j"
                                                                                                    amerge_3j
                                                                                                    true
                                                                                                                                                                                                      )
                                                                                                  ::
                                                                                                    (
                                                                                                      (
                                                                                                        "ashell_1"
                                                                                                        ashell_1
                                                                                                        false
                                                                                                                                                                                                              )
                                                                                                      ::
                                                                                                        (
                                                                                                          (
                                                                                                            "ashell_2"
                                                                                                            ashell_2
                                                                                                            false
                                                                                                                                                                                                                      )
                                                                                                          ::
                                                                                                            (
                                                                                                              (
                                                                                                                "ashell_3"
                                                                                                                ashell_3
                                                                                                                false
                                                                                                                                                                                                                              )
                                                                                                              ::
                                                                                                                (
                                                                                                                  (
                                                                                                                    "ashell_4"
                                                                                                                    ashell_4
                                                                                                                    false
                                                                                                                                                                                                                                      )
                                                                                                                  ::
                                                                                                                    (
                                                                                                                      (
                                                                                                                        "aquick_1a"
                                                                                                                        aquick_1a
                                                                                                                        false
                                                                                                                                                                                                                                              )
                                                                                                                      ::
                                                                                                                        (
                                                                                                                          (
                                                                                                                            "aquick_1b"
                                                                                                                            aquick_1b
                                                                                                                            false
                                                                                                                                                                                                                                                      )
                                                                                                                          ::
                                                                                                                            (
                                                                                                                              (
                                                                                                                                "aquick_1c"
                                                                                                                                aquick_1c
                                                                                                                                false
                                                                                                                                                                                                                                                              )
                                                                                                                              ::
                                                                                                                                (
                                                                                                                                  (
                                                                                                                                    "aquick_1d"
                                                                                                                                    aquick_1d
                                                                                                                                    false
                                                                                                                                                                                                                                                                      )
                                                                                                                                  ::
                                                                                                                                    (
                                                                                                                                      (
                                                                                                                                        "aquick_1e"
                                                                                                                                        aquick_1e
                                                                                                                                        false
                                                                                                                                                                                                                                                                              )
                                                                                                                                      ::
                                                                                                                                        (
                                                                                                                                          (
                                                                                                                                            "aquick_1f"
                                                                                                                                            aquick_1f
                                                                                                                                            false
                                                                                                                                                                                                                                                                                      )
                                                                                                                                          ::
                                                                                                                                            (
                                                                                                                                              (
                                                                                                                                                "aquick_1g"
                                                                                                                                                aquick_1g
                                                                                                                                                false
                                                                                                                                                                                                                                                                                              )
                                                                                                                                              ::
                                                                                                                                                (
                                                                                                                                                  (
                                                                                                                                                    "aquick_2a"
                                                                                                                                                    aquick_2a
                                                                                                                                                    false
                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                  ::
                                                                                                                                                    (
                                                                                                                                                      (
                                                                                                                                                        "aquick_2b"
                                                                                                                                                        aquick_2b
                                                                                                                                                        false
                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                      ::
                                                                                                                                                        (
                                                                                                                                                          (
                                                                                                                                                            "aquick_2c"
                                                                                                                                                            aquick_2c
                                                                                                                                                            false
                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                          ::
                                                                                                                                                            (
                                                                                                                                                              (
                                                                                                                                                                "aquick_2d"
                                                                                                                                                                aquick_2d
                                                                                                                                                                false
                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                              ::
                                                                                                                                                                (
                                                                                                                                                                  (
                                                                                                                                                                    "aquick_2e"
                                                                                                                                                                    aquick_2e
                                                                                                                                                                    false
                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                  ::
                                                                                                                                                                    (
                                                                                                                                                                      (
                                                                                                                                                                        "aquick_2f"
                                                                                                                                                                        aquick_2f
                                                                                                                                                                        false
                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                      ::
                                                                                                                                                                        (
                                                                                                                                                                          (
                                                                                                                                                                            "aquick_2g"
                                                                                                                                                                            aquick_2g
                                                                                                                                                                            false
                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                          ::
                                                                                                                                                                            (
                                                                                                                                                                              (
                                                                                                                                                                                "aquick_3a"
                                                                                                                                                                                aquick_3a
                                                                                                                                                                                false
                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                              ::
                                                                                                                                                                                (
                                                                                                                                                                                  (
                                                                                                                                                                                    "aquick_3b"
                                                                                                                                                                                    aquick_3b
                                                                                                                                                                                    false
                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                  ::
                                                                                                                                                                                    (
                                                                                                                                                                                      (
                                                                                                                                                                                        "aquick_3c"
                                                                                                                                                                                        aquick_3c
                                                                                                                                                                                        false
                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                      ::
                                                                                                                                                                                        (
                                                                                                                                                                                          (
                                                                                                                                                                                            "aquick_3d"
                                                                                                                                                                                            aquick_3d
                                                                                                                                                                                            false
                                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                          ::
                                                                                                                                                                                            (
                                                                                                                                                                                              (
                                                                                                                                                                                                "aquick_3e"
                                                                                                                                                                                                aquick_3e
                                                                                                                                                                                                false
                                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                              ::
                                                                                                                                                                                                (
                                                                                                                                                                                                  (
                                                                                                                                                                                                    "aquick_3f"
                                                                                                                                                                                                    aquick_3f
                                                                                                                                                                                                    false
                                                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                                  ::
                                                                                                                                                                                                    (
                                                                                                                                                                                                      (
                                                                                                                                                                                                        "aquick_3g"
                                                                                                                                                                                                        aquick_3g
                                                                                                                                                                                                        false
                                                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                                      ::
                                                                                                                                                                                                        (
                                                                                                                                                                                                          (
                                                                                                                                                                                                            "aquick_3h"
                                                                                                                                                                                                            aquick_3h
                                                                                                                                                                                                            false
                                                                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                                          ::
                                                                                                                                                                                                            (
                                                                                                                                                                                                              (
                                                                                                                                                                                                                "aquick_3i"
                                                                                                                                                                                                                aquick_3i
                                                                                                                                                                                                                false
                                                                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                                              ::
                                                                                                                                                                                                                (
                                                                                                                                                                                                                  (
                                                                                                                                                                                                                    "aquick_3j"
                                                                                                                                                                                                                    aquick_3j
                                                                                                                                                                                                                    false
                                                                                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                                                  ::
                                                                                                                                                                                                                    (
                                                                                                                                                                                                                      (
                                                                                                                                                                                                                        "aheap_1"
                                                                                                                                                                                                                        aheap_1
                                                                                                                                                                                                                        false
                                                                                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                                                      ::
                                                                                                                                                                                                                        (
                                                                                                                                                                                                                          (
                                                                                                                                                                                                                            "aheap_2"
                                                                                                                                                                                                                            aheap_2
                                                                                                                                                                                                                            false
                                                                                                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                                                          ::
                                                                                                                                                                                                                            (
                                                                                                                                                                                                                              (
                                                                                                                                                                                                                                "aheap_3"
                                                                                                                                                                                                                                aheap_3
                                                                                                                                                                                                                                false
                                                                                                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                                                              ::
                                                                                                                                                                                                                                (
                                                                                                                                                                                                                                  (
                                                                                                                                                                                                                                    "aheap_4"
                                                                                                                                                                                                                                    aheap_4
                                                                                                                                                                                                                                    false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                                                                  ::
                                                                                                                                                                                                                                    (
                                                                                                                                                                                                                                      (
                                                                                                                                                                                                                                        "aheap_5"
                                                                                                                                                                                                                                        aheap_5
                                                                                                                                                                                                                                        false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                                                                      ::
                                                                                                                                                                                                                                        (
                                                                                                                                                                                                                                          (
                                                                                                                                                                                                                                            "aheap_6"
                                                                                                                                                                                                                                            aheap_6
                                                                                                                                                                                                                                            false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      )
                                                                                                                                                                                                                                          ::
                                                                                                                                                                                                                                            (
                                                                                                                                                                                                                                              (
                                                                                                                                                                                                                                                "ainsertion_1"
                                                                                                                                                                                                                                                ainsertion_1
                                                                                                                                                                                                                                                true
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              )
                                                                                                                                                                                                                                              []
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          )
                                                                                                                                                                                                                                        )
                                                                                                                                                                                                                                    )
                                                                                                                                                                                                                                )
                                                                                                                                                                                                                            )
                                                                                                                                                                                                                        )
                                                                                                                                                                                                                    )
                                                                                                                                                                                                                )
                                                                                                                                                                                                            )
                                                                                                                                                                                                        )
                                                                                                                                                                                                    )
                                                                                                                                                                                                )
                                                                                                                                                                                            )
                                                                                                                                                                                        )
                                                                                                                                                                                    )
                                                                                                                                                                                )
                                                                                                                                                                            )
                                                                                                                                                                        )
                                                                                                                                                                    )
                                                                                                                                                                )
                                                                                                                                                            )
                                                                                                                                                        )
                                                                                                                                                    )
                                                                                                                                                )
                                                                                                                                            )
                                                                                                                                        )
                                                                                                                                    )
                                                                                                                                )
                                                                                                                            )
                                                                                                                        )
                                                                                                                    )
                                                                                                                )
                                                                                                            )
                                                                                                        )
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
        )
  )
  type
  (
    mode
      type
        params =
          (
          )
        cstrs =
          (
          )
        kind =
            (
              Test_std
                (
                )
                              Test
                (
                )
                              Bench1
                (
                )
                              Bench2
                (
                )
                              Bench3
                (
                )
                            )
            )
  let
  (
    size
      ref
      (
        
          22
      )
    mem
      ref
      (
        
          0
      )
    mode
      ref
      (
        
          Test_std
                )
    only
      ref
      (
        
          []
                )
  )
  let
  (
    usage
      "Usage: sorts [-size <table size>] [-mem <memory size>]\n             [-seed <random seed>] [-test|-bench]"
  )
  let
  (
    options
      ::
        (
          (
            "-size"
            Arg.Int
              :=
              (
                
                  size
              )
            "   Maximum size for benchmarks (default 22)"
          )
          ::
            (
              (
                "-meg"
                Arg.Int
                  :=
                  (
                    
                      mem
                  )
                "    How many megabytes to preallocate (default 0)"
              )
              ::
                (
                  (
                    "-seed"
                    Arg.Int
                      :=
                      (
                        
                          seed
                      )
                    "   PRNG seed (default 0)"
                  )
                  ::
                    (
                      (
                        "-teststd"
                        Arg.Unit
                          (
                            case
                            (
                              ()
                                                            :=
                              (
                                
                                  mode
                                
                                  Test_std
                                                                )
                            )
                          )
                        "   Test stdlib (default)"
                      )
                      ::
                        (
                          (
                            "-test"
                            Arg.Unit
                              (
                                case
                                (
                                  ()
                                                                    :=
                                  (
                                    
                                      mode
                                    
                                      Test
                                                                        )
                                )
                              )
                            "   Select test mode"
                          )
                          ::
                            (
                              (
                                "-bench1"
                                Arg.Unit
                                  (
                                    case
                                    (
                                      ()
                                                                            :=
                                      (
                                        
                                          mode
                                        
                                          Bench1
                                                                                )
                                    )
                                  )
                                "  Select bench mode 1"
                              )
                              ::
                                (
                                  (
                                    "-bench2"
                                    Arg.Unit
                                      (
                                        case
                                        (
                                          ()
                                                                                    :=
                                          (
                                            
                                              mode
                                            
                                              Bench2
                                                                                        )
                                        )
                                      )
                                    "  Select bench mode 2"
                                  )
                                  ::
                                    (
                                      (
                                        "-bench3"
                                        Arg.Unit
                                          (
                                            case
                                            (
                                              ()
                                                                                            :=
                                              (
                                                
                                                  mode
                                                
                                                  Bench3
                                                                                                )
                                            )
                                          )
                                        "  Select bench mode 3"
                                      )
                                      ::
                                        (
                                          (
                                            "-fn"
                                            Arg.String
                                              (
                                                case
                                                (
                                                  x
                                                  :=
                                                  (
                                                    
                                                      only
                                                    
                                                      ::
                                                        (
                                                          x
                                                          !
                                                          (
                                                            
                                                              only
                                                          )
                                                        )
                                                  )
                                                )
                                              )
                                            " <function>  Test/Bench this function (default all)"
                                          )
                                          []
                                                                                  )
                                    )
                                )
                            )
                        )
                    )
                )
            )
        )
  )
  let
  (
    anonymous
      (
        case
        (
          x
          raise
          (
            
              Arg.Bad
                ^
                (
                  
                    "unrecognised option "
                  
                    x
                )
          )
        )
      )
  )
  let
  (
    main
      (
        case
        (
          ()
                    sequence
          (
            Arg.parse
            (
              
                options
              
                anonymous
              
                usage
            )
          ;
            sequence
            (
              Printf.printf
              (
                
                  "Command line arguments are:"
              )
            ;
              sequence
              (
                for i
                1
                -
                (
                  
                    Array.length
                    (
                      
                        Sys.argv
                    )
                  
                    1
                )
                Printf.printf
                (
                  
                    " %s"
                  
                    Array.get
                    (
                      
                        Sys.argv
                      
                        i
                    )
                )
              ;
                sequence
                (
                  Printf.printf
                  (
                    
                      "\n"
                  )
                ;
                  sequence
                  (
                    ignore
                    (
                      
                        String.create
                        (
                          
                            *
                            (
                              
                                1048576
                              
                                !
                                (
                                  
                                    mem
                                )
                            )
                        )
                    )
                  ;
                    sequence
                    (
                      Gc.full_major
                      (
                        
                          ()
                                                )
                    ;
                      let
                      (
                        (
                          benchonly
                            (
                              case
                              (
                                f
                                (
                                  case
                                  (
                                    x
                                    (
                                      case
                                      (
                                        y
                                        (
                                          case
                                          (
                                            z
                                            (
                                              case
                                              (
                                                t
                                                match
                                                !
                                                (
                                                  
                                                    only
                                                )
                                                (
                                                  case
                                                  (
                                                    []
                                                                                                        f
                                                    (
                                                      
                                                        x
                                                      
                                                        y
                                                      
                                                        z
                                                      
                                                        t
                                                    )
                                                  )
                                                  case
                                                  (
                                                    l
                                                    ifthenelse
                                                    (
                                                      if
                                                      (
                                                        List.mem
                                                        (
                                                          
                                                            y
                                                          
                                                            l
                                                        )
                                                      )
                                                      then
                                                      (
                                                        f
                                                        (
                                                          
                                                            x
                                                          
                                                            y
                                                          
                                                            z
                                                          
                                                            t
                                                        )
                                                      )
                                                      else
                                                      (
                                                                                                              )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                        )
                      in
                        let
                        (
                          (
                            testonly
                              (
                                case
                                (
                                  x1
                                  (
                                    case
                                    (
                                      x2
                                      (
                                        case
                                        (
                                          x3
                                          (
                                            case
                                            (
                                              x4
                                              (
                                                case
                                                (
                                                  x5
                                                  (
                                                    case
                                                    (
                                                      x6
                                                      match
                                                      !
                                                      (
                                                        
                                                          only
                                                      )
                                                      (
                                                        case
                                                        (
                                                          []
                                                                                                                    test
                                                          (
                                                            
                                                              x1
                                                            
                                                              x2
                                                            
                                                              x3
                                                            
                                                              x4
                                                            
                                                              x5
                                                            
                                                              x6
                                                          )
                                                        )
                                                        case
                                                        (
                                                          l
                                                          ifthenelse
                                                          (
                                                            if
                                                            (
                                                              List.mem
                                                              (
                                                                
                                                                  x1
                                                                
                                                                  l
                                                              )
                                                            )
                                                            then
                                                            (
                                                              test
                                                              (
                                                                
                                                                  x1
                                                                
                                                                  x2
                                                                
                                                                  x3
                                                                
                                                                  x4
                                                                
                                                                  x5
                                                                
                                                                  x6
                                                              )
                                                            )
                                                            else
                                                            (
                                                                                                                          )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                          )
                        in
                          match
                          !
                          (
                            
                              mode
                          )
                          (
                            case
                            (
                              Test_std
                                                            sequence
                              (
                                testonly
                                (
                                  
                                    "List.sort"
                                  
                                    false
                                                                      
                                    List.sort
                                  
                                    List.sort
                                  
                                    lc
                                  
                                    lc
                                )
                              ;
                                sequence
                                (
                                  testonly
                                  (
                                    
                                      "List.stable_sort"
                                    
                                      true
                                                                          
                                      List.stable_sort
                                    
                                      List.stable_sort
                                    
                                      lc
                                    
                                      lc
                                  )
                                ;
                                  sequence
                                  (
                                    testonly
                                    (
                                      
                                        "Array.sort"
                                      
                                        false
                                                                              
                                        Array.sort
                                      
                                        Array.sort
                                      
                                        ac
                                      
                                        ac
                                    )
                                  ;
                                    sequence
                                    (
                                      testonly
                                      (
                                        
                                          "Array.stable_sort"
                                        
                                          true
                                                                                  
                                          Array.stable_sort
                                        
                                          Array.stable_sort
                                        
                                          ac
                                        
                                          ac
                                      )
                                    ;
                                      printf
                                      (
                                        
                                          "Number of tests failed: %d\n"
                                        
                                          !
                                          (
                                            
                                              numfailed
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                            case
                            (
                              Test
                                                            sequence
                              (
                                for i
                                0
                                -
                                (
                                  
                                    List.length
                                    (
                                      
                                        lold
                                    )
                                  
                                    1
                                )
                                let
                                (
                                  (
                                    (
                                      name
                                      f1
                                      stable
                                    )
                                      List.nth
                                      (
                                        
                                          lold
                                        
                                          i
                                      )
                                  )
                                in
                                  let
                                  (
                                    (
                                      (
                                        _
                                        f2
                                        _
                                      )
                                        List.nth
                                        (
                                          
                                            lold
                                          
                                            i
                                        )
                                    )
                                  in
                                    testonly
                                    (
                                      
                                        name
                                      
                                        stable
                                      
                                        f1
                                      
                                        f2
                                      
                                        ll
                                      
                                        ll
                                    )
                                  )
                                )
                              ;
                                sequence
                                (
                                  testonly
                                  (
                                    
                                      "Sort.array"
                                    
                                      false
                                                                          
                                      Sort.array
                                    
                                      Sort.array
                                    
                                      al
                                    
                                      al
                                  )
                                ;
                                  sequence
                                  (
                                    for i
                                    0
                                    -
                                    (
                                      
                                        List.length
                                        (
                                          
                                            lnew
                                        )
                                      
                                        1
                                    )
                                    let
                                    (
                                      (
                                        (
                                          name
                                          f1
                                          stable
                                        )
                                          List.nth
                                          (
                                            
                                              lnew
                                            
                                              i
                                          )
                                      )
                                    in
                                      let
                                      (
                                        (
                                          (
                                            _
                                            f2
                                            _
                                          )
                                            List.nth
                                            (
                                              
                                                lnew
                                              
                                                i
                                            )
                                        )
                                      in
                                        testonly
                                        (
                                          
                                            name
                                          
                                            stable
                                          
                                            f1
                                          
                                            f2
                                          
                                            lc
                                          
                                            lc
                                        )
                                      )
                                    )
                                  ;
                                    sequence
                                    (
                                      for i
                                      0
                                      -
                                      (
                                        
                                          List.length
                                          (
                                            
                                              anew
                                          )
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          (
                                            name
                                            f1
                                            stable
                                          )
                                            List.nth
                                            (
                                              
                                                anew
                                              
                                                i
                                            )
                                        )
                                      in
                                        let
                                        (
                                          (
                                            (
                                              _
                                              f2
                                              _
                                            )
                                              List.nth
                                              (
                                                
                                                  anew
                                                
                                                  i
                                              )
                                          )
                                        in
                                          testonly
                                          (
                                            
                                              name
                                            
                                              stable
                                            
                                              f1
                                            
                                              f2
                                            
                                              ac
                                            
                                              ac
                                          )
                                        )
                                      )
                                    ;
                                      printf
                                      (
                                        
                                          "Number of tests failed: %d\n"
                                        
                                          !
                                          (
                                            
                                              numfailed
                                          )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                            case
                            (
                              Bench1
                                                            let
                              (
                                (
                                  ba
                                    (
                                      case
                                      (
                                        x
                                        (
                                          case
                                          (
                                            y
                                            (
                                              case
                                              (
                                                z
                                                benchonly
                                                (
                                                  
                                                    bench1a
                                                  
                                                    !
                                                    (
                                                      
                                                        size
                                                    )
                                                  
                                                    x
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  bb
                                    (
                                      case
                                      (
                                        x
                                        (
                                          case
                                          (
                                            y
                                            (
                                              case
                                              (
                                                z
                                                benchonly
                                                (
                                                  
                                                    bench1b
                                                  
                                                    !
                                                    (
                                                      
                                                        size
                                                    )
                                                  
                                                    x
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  bc
                                    (
                                      case
                                      (
                                        x
                                        (
                                          case
                                          (
                                            y
                                            (
                                              case
                                              (
                                                z
                                                benchonly
                                                (
                                                  
                                                    bench1c
                                                  
                                                    !
                                                    (
                                                      
                                                        size
                                                    )
                                                  
                                                    x
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                )
                              in
                                sequence
                                (
                                  for i
                                  0
                                  -
                                  (
                                    
                                      List.length
                                      (
                                        
                                          lold
                                      )
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      (
                                        name
                                        f
                                        stable
                                      )
                                        List.nth
                                        (
                                          
                                            lold
                                          
                                            i
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      ba
                                      (
                                        
                                          name
                                        
                                          f
                                        
                                          ll
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          (
                                            name
                                            f
                                            stable
                                          )
                                            List.nth
                                            (
                                              
                                                lold
                                              
                                                i
                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          bb
                                          (
                                            
                                              name
                                            
                                              f
                                            
                                              ll
                                          )
                                        ;
                                          let
                                          (
                                            (
                                              (
                                                name
                                                f
                                                stable
                                              )
                                                List.nth
                                                (
                                                  
                                                    lold
                                                  
                                                    i
                                                )
                                            )
                                          in
                                            bc
                                            (
                                              
                                                name
                                              
                                                f
                                              
                                                ll
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ;
                                  sequence
                                  (
                                    ba
                                    (
                                      
                                        "Sort.array"
                                      
                                        Sort.array
                                      
                                        al
                                    )
                                  ;
                                    sequence
                                    (
                                      bb
                                      (
                                        
                                          "Sort.array"
                                        
                                          Sort.array
                                        
                                          al
                                      )
                                    ;
                                      sequence
                                      (
                                        bc
                                        (
                                          
                                            "Sort.array"
                                          
                                            Sort.array
                                          
                                            al
                                        )
                                      ;
                                        sequence
                                        (
                                          for i
                                          0
                                          -
                                          (
                                            
                                              List.length
                                              (
                                                
                                                  lnew
                                              )
                                            
                                              1
                                          )
                                          let
                                          (
                                            (
                                              (
                                                name
                                                f
                                                stable
                                              )
                                                List.nth
                                                (
                                                  
                                                    lnew
                                                  
                                                    i
                                                )
                                            )
                                          in
                                            sequence
                                            (
                                              ba
                                              (
                                                
                                                  name
                                                
                                                  f
                                                
                                                  lc
                                              )
                                            ;
                                              let
                                              (
                                                (
                                                  (
                                                    name
                                                    f
                                                    stable
                                                  )
                                                    List.nth
                                                    (
                                                      
                                                        lnew
                                                      
                                                        i
                                                    )
                                                )
                                              in
                                                sequence
                                                (
                                                  bb
                                                  (
                                                    
                                                      name
                                                    
                                                      f
                                                    
                                                      lc
                                                  )
                                                ;
                                                  let
                                                  (
                                                    (
                                                      (
                                                        name
                                                        f
                                                        stable
                                                      )
                                                        List.nth
                                                        (
                                                          
                                                            lnew
                                                          
                                                            i
                                                        )
                                                    )
                                                  in
                                                    bc
                                                    (
                                                      
                                                        name
                                                      
                                                        f
                                                      
                                                        lc
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        ;
                                          for i
                                          0
                                          -
                                          (
                                            
                                              List.length
                                              (
                                                
                                                  anew
                                              )
                                            
                                              1
                                          )
                                          let
                                          (
                                            (
                                              (
                                                name
                                                f
                                                stable
                                              )
                                                List.nth
                                                (
                                                  
                                                    anew
                                                  
                                                    i
                                                )
                                            )
                                          in
                                            sequence
                                            (
                                              ba
                                              (
                                                
                                                  name
                                                
                                                  f
                                                
                                                  ac
                                              )
                                            ;
                                              let
                                              (
                                                (
                                                  (
                                                    name
                                                    f
                                                    stable
                                                  )
                                                    List.nth
                                                    (
                                                      
                                                        anew
                                                      
                                                        i
                                                    )
                                                )
                                              in
                                                sequence
                                                (
                                                  bb
                                                  (
                                                    
                                                      name
                                                    
                                                      f
                                                    
                                                      ac
                                                  )
                                                ;
                                                  let
                                                  (
                                                    (
                                                      (
                                                        name
                                                        f
                                                        stable
                                                      )
                                                        List.nth
                                                        (
                                                          
                                                            anew
                                                          
                                                            i
                                                        )
                                                    )
                                                  in
                                                    bc
                                                    (
                                                      
                                                        name
                                                      
                                                        f
                                                      
                                                        ac
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                            case
                            (
                              Bench2
                                                            let
                              (
                                (
                                  b
                                    (
                                      case
                                      (
                                        x
                                        (
                                          case
                                          (
                                            y
                                            (
                                              case
                                              (
                                                z
                                                benchonly
                                                (
                                                  
                                                    bench2
                                                  
                                                    !
                                                    (
                                                      
                                                        size
                                                    )
                                                  
                                                    x
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                )
                              in
                                sequence
                                (
                                  for i
                                  0
                                  -
                                  (
                                    
                                      List.length
                                      (
                                        
                                          lold
                                      )
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      (
                                        name
                                        f
                                        stable
                                      )
                                        List.nth
                                        (
                                          
                                            lold
                                          
                                            i
                                        )
                                    )
                                  in
                                    b
                                    (
                                      
                                        name
                                      
                                        f
                                      
                                        ll
                                    )
                                  )
                                ;
                                  sequence
                                  (
                                    b
                                    (
                                      
                                        "Sort.array"
                                      
                                        Sort.array
                                      
                                        al
                                    )
                                  ;
                                    sequence
                                    (
                                      for i
                                      0
                                      -
                                      (
                                        
                                          List.length
                                          (
                                            
                                              lnew
                                          )
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          (
                                            name
                                            f
                                            stable
                                          )
                                            List.nth
                                            (
                                              
                                                lnew
                                              
                                                i
                                            )
                                        )
                                      in
                                        b
                                        (
                                          
                                            name
                                          
                                            f
                                          
                                            lc
                                        )
                                      )
                                    ;
                                      for i
                                      0
                                      -
                                      (
                                        
                                          List.length
                                          (
                                            
                                              anew
                                          )
                                        
                                          1
                                      )
                                      let
                                      (
                                        (
                                          (
                                            name
                                            f
                                            stable
                                          )
                                            List.nth
                                            (
                                              
                                                anew
                                              
                                                i
                                            )
                                        )
                                      in
                                        b
                                        (
                                          
                                            name
                                          
                                            f
                                          
                                            ac
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                            case
                            (
                              Bench3
                                                            let
                              (
                                (
                                  ba
                                    (
                                      case
                                      (
                                        x
                                        (
                                          case
                                          (
                                            y
                                            (
                                              case
                                              (
                                                z
                                                benchonly
                                                (
                                                  
                                                    bench3a
                                                  
                                                    !
                                                    (
                                                      
                                                        size
                                                    )
                                                  
                                                    x
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  bb
                                    (
                                      case
                                      (
                                        x
                                        (
                                          case
                                          (
                                            y
                                            (
                                              case
                                              (
                                                z
                                                benchonly
                                                (
                                                  
                                                    bench3b
                                                  
                                                    !
                                                    (
                                                      
                                                        size
                                                    )
                                                  
                                                    x
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  bc
                                    (
                                      case
                                      (
                                        x
                                        (
                                          case
                                          (
                                            y
                                            (
                                              case
                                              (
                                                z
                                                benchonly
                                                (
                                                  
                                                    bench3c
                                                  
                                                    !
                                                    (
                                                      
                                                        size
                                                    )
                                                  
                                                    x
                                                  
                                                    y
                                                  
                                                    z
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                )
                              in
                                sequence
                                (
                                  for i
                                  0
                                  -
                                  (
                                    
                                      List.length
                                      (
                                        
                                          lold
                                      )
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      (
                                        name
                                        f
                                        stable
                                      )
                                        List.nth
                                        (
                                          
                                            lold
                                          
                                            i
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      ba
                                      (
                                        
                                          name
                                        
                                          f
                                        
                                          ll
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          (
                                            name
                                            f
                                            stable
                                          )
                                            List.nth
                                            (
                                              
                                                lold
                                              
                                                i
                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          bb
                                          (
                                            
                                              name
                                            
                                              f
                                            
                                              ll
                                          )
                                        ;
                                          let
                                          (
                                            (
                                              (
                                                name
                                                f
                                                stable
                                              )
                                                List.nth
                                                (
                                                  
                                                    lold
                                                  
                                                    i
                                                )
                                            )
                                          in
                                            bc
                                            (
                                              
                                                name
                                              
                                                f
                                              
                                                ll
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ;
                                  for i
                                  0
                                  -
                                  (
                                    
                                      List.length
                                      (
                                        
                                          lnew
                                      )
                                    
                                      1
                                  )
                                  let
                                  (
                                    (
                                      (
                                        name
                                        f
                                        stable
                                      )
                                        List.nth
                                        (
                                          
                                            lnew
                                          
                                            i
                                        )
                                    )
                                  in
                                    sequence
                                    (
                                      ba
                                      (
                                        
                                          name
                                        
                                          f
                                        
                                          lc
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          (
                                            name
                                            f
                                            stable
                                          )
                                            List.nth
                                            (
                                              
                                                lnew
                                              
                                                i
                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          bb
                                          (
                                            
                                              name
                                            
                                              f
                                            
                                              lc
                                          )
                                        ;
                                          let
                                          (
                                            (
                                              (
                                                name
                                                f
                                                stable
                                              )
                                                List.nth
                                                (
                                                  
                                                    lnew
                                                  
                                                    i
                                                )
                                            )
                                          in
                                            bc
                                            (
                                              
                                                name
                                              
                                                f
                                              
                                                lc
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  ifthenelse
  (
    if
    (
      not
      (
        
          !
          (
            
              Sys.interactive
          )
      )
    )
    then
    (
      Printexc.catch
      (
        
          main
        
          ()
                )
    )
    else
    (
          )
  )
)

