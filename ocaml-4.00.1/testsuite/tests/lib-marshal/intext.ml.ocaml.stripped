(
  let
  (
    max_data_depth
      500000
  )
  type
  (
    t
      type
        params =
          (
          )
        cstrs =
          (
          )
        kind =
            (
              A
                (
                )
                              B
                (
                     int
                    (
                    )
                )
                              C
                (
                     float
                    (
                    )
                )
                              D
                (
                     string
                    (
                    )
                )
                              E
                (
                     char
                    (
                    )
                )
                              F
                (
                     t
                    (
                    )
                )
                              G
                (
                     t
                    (
                    )
                     t
                    (
                    )
                )
                              H
                (
                     int
                    (
                    )
                     t
                    (
                    )
                )
                              I
                (
                     t
                    (
                    )
                     float
                    (
                    )
                )
                              J
                (
                )
                            )
            )
  let
  (
    longstring
      "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
  )
  let
  (
    verylongstring
      "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
  )
  let
  (
    bigint
      Int64.to_int
      (
          1311768467463790320
      )
  )
  let
  (
    fib
      (
        case
        (
          n
          ifthenelse
          (
            if
            (
              <
              (
                  n
                  2
              )
            )
            then
            (
              1
            )
            else
            (
                +
                (
                    fib
                    (
                        -
                        (
                            n
                            1
                        )
                    )
                    fib
                    (
                        -
                        (
                            n
                            2
                        )
                    )
                )
            )
          )
        )
      )
  )
  let
  (
    test_out
      (
        case
        (
          filename
          let
          (
            (
              oc
                open_out_bin
                (
                    filename
                )
            )
          in
            sequence
            (
              output_value
              (
                  oc
                  1
              )
            ;
              sequence
              (
                output_value
                (
                    oc
                    -1
                )
              ;
                sequence
                (
                  output_value
                  (
                      oc
                      258
                  )
                ;
                  sequence
                  (
                    output_value
                    (
                        oc
                        20000
                    )
                  ;
                    sequence
                    (
                      output_value
                      (
                          oc
                          305419896
                      )
                    ;
                      sequence
                      (
                        output_value
                        (
                            oc
                            bigint
                        )
                      ;
                        sequence
                        (
                          output_value
                          (
                              oc
                              "foobargeebuz"
                          )
                        ;
                          sequence
                          (
                            output_value
                            (
                                oc
                                longstring
                            )
                          ;
                            sequence
                            (
                              output_value
                              (
                                  oc
                                  verylongstring
                              )
                            ;
                              sequence
                              (
                                output_value
                                (
                                    oc
                                    3.141592654
                                )
                              ;
                                sequence
                                (
                                  output_value
                                  (
                                      oc
                                      ()
                                                                        )
                                ;
                                  sequence
                                  (
                                    output_value
                                    (
                                        oc
                                        A
                                                                            )
                                  ;
                                    sequence
                                    (
                                      output_value
                                      (
                                          oc
                                          B
                                            1
                                      )
                                    ;
                                      sequence
                                      (
                                        output_value
                                        (
                                            oc
                                            C
                                              2.718
                                        )
                                      ;
                                        sequence
                                        (
                                          output_value
                                          (
                                              oc
                                              D
                                                "hello, world!"
                                          )
                                        ;
                                          sequence
                                          (
                                            output_value
                                            (
                                                oc
                                                E
                                                  6c
                                            )
                                          ;
                                            sequence
                                            (
                                              output_value
                                              (
                                                  oc
                                                  F
                                                    B
                                                      1
                                              )
                                            ;
                                              sequence
                                              (
                                                output_value
                                                (
                                                    oc
                                                    G
                                                      (
                                                        A
                                                                                                                G
                                                          (
                                                            B
                                                              2
                                                            G
                                                              (
                                                                C
                                                                  3.14
                                                                G
                                                                  (
                                                                    D
                                                                      "glop"
                                                                    E
                                                                      65
                                                                  )
                                                              )
                                                          )
                                                      )
                                                )
                                              ;
                                                sequence
                                                (
                                                  output_value
                                                  (
                                                      oc
                                                      H
                                                        (
                                                          1
                                                          A
                                                                                                                  )
                                                  )
                                                ;
                                                  sequence
                                                  (
                                                    output_value
                                                    (
                                                        oc
                                                        I
                                                          (
                                                            B
                                                              2
                                                            1e-6
                                                          )
                                                    )
                                                  ;
                                                    let
                                                    (
                                                      (
                                                        x
                                                          D
                                                            "sharing"
                                                      )
                                                    in
                                                      let
                                                      (
                                                        (
                                                          y
                                                            G
                                                              (
                                                                x
                                                                x
                                                              )
                                                        )
                                                      in
                                                        let
                                                        (
                                                          (
                                                            z
                                                              G
                                                                (
                                                                  y
                                                                  G
                                                                    (
                                                                      x
                                                                      y
                                                                    )
                                                                )
                                                          )
                                                        in
                                                          sequence
                                                          (
                                                            output_value
                                                            (
                                                                oc
                                                                z
                                                            )
                                                          ;
                                                            sequence
                                                            (
                                                              output_value
                                                              (
                                                                  oc
                                                                  array
                                                                  (
                                                                    1
                                                                    2
                                                                    3
                                                                    4
                                                                    5
                                                                    6
                                                                    7
                                                                    8
                                                                    9
                                                                    10
                                                                    11
                                                                    12
                                                                    13
                                                                    14
                                                                    15
                                                                    16
                                                                  )
                                                              )
                                                            ;
                                                              let
                                                              (
                                                                (
                                                                  big
                                                                    (
                                                                      case
                                                                      (
                                                                        n
                                                                        ifthenelse
                                                                        (
                                                                          if
                                                                          (
                                                                            <=
                                                                            (
                                                                                n
                                                                                0
                                                                            )
                                                                          )
                                                                          then
                                                                          (
                                                                            A
                                                                                                                                                      )
                                                                          else
                                                                          (
                                                                              H
                                                                                (
                                                                                  n
                                                                                  big
                                                                                  (
                                                                                      -
                                                                                      (
                                                                                          n
                                                                                          1
                                                                                      )
                                                                                  )
                                                                                )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                )
                                                              in
                                                                sequence
                                                                (
                                                                  output_value
                                                                  (
                                                                      oc
                                                                      big
                                                                      (
                                                                          1000
                                                                      )
                                                                  )
                                                                ;
                                                                  sequence
                                                                  (
                                                                    Marshal.to_channel
                                                                    (
                                                                        oc
                                                                        y
                                                                        ::
                                                                          (
                                                                            Marshal.No_sharing
                                                                                                                                                        []
                                                                                                                                                      )
                                                                    )
                                                                  ;
                                                                    sequence
                                                                    (
                                                                      Marshal.to_channel
                                                                      (
                                                                          oc
                                                                          fib
                                                                          ::
                                                                            (
                                                                              Marshal.Closures
                                                                                                                                                            []
                                                                                                                                                          )
                                                                      )
                                                                    ;
                                                                      sequence
                                                                      (
                                                                        output_value
                                                                        (
                                                                            oc
                                                                            Int32.of_string
                                                                            (
                                                                                "0"
                                                                            )
                                                                        )
                                                                      ;
                                                                        sequence
                                                                        (
                                                                          output_value
                                                                          (
                                                                              oc
                                                                              Int32.of_string
                                                                              (
                                                                                  "123456"
                                                                              )
                                                                          )
                                                                        ;
                                                                          sequence
                                                                          (
                                                                            output_value
                                                                            (
                                                                                oc
                                                                                Int32.of_string
                                                                                (
                                                                                    "-123456"
                                                                                )
                                                                            )
                                                                          ;
                                                                            sequence
                                                                            (
                                                                              output_value
                                                                              (
                                                                                  oc
                                                                                  Int64.of_string
                                                                                  (
                                                                                      "0"
                                                                                  )
                                                                              )
                                                                            ;
                                                                              sequence
                                                                              (
                                                                                output_value
                                                                                (
                                                                                    oc
                                                                                    Int64.of_string
                                                                                    (
                                                                                        "123456789123456"
                                                                                    )
                                                                                )
                                                                              ;
                                                                                sequence
                                                                                (
                                                                                  output_value
                                                                                  (
                                                                                      oc
                                                                                      Int64.of_string
                                                                                      (
                                                                                          "-123456789123456"
                                                                                      )
                                                                                  )
                                                                                ;
                                                                                  sequence
                                                                                  (
                                                                                    output_value
                                                                                    (
                                                                                        oc
                                                                                        Nativeint.of_string
                                                                                        (
                                                                                            "0"
                                                                                        )
                                                                                    )
                                                                                  ;
                                                                                    sequence
                                                                                    (
                                                                                      output_value
                                                                                      (
                                                                                          oc
                                                                                          Nativeint.of_string
                                                                                          (
                                                                                              "123456"
                                                                                          )
                                                                                      )
                                                                                    ;
                                                                                      sequence
                                                                                      (
                                                                                        output_value
                                                                                        (
                                                                                            oc
                                                                                            Nativeint.of_string
                                                                                            (
                                                                                                "-123456"
                                                                                            )
                                                                                        )
                                                                                      ;
                                                                                        sequence
                                                                                        (
                                                                                          output_value
                                                                                          (
                                                                                              oc
                                                                                              Nativeint.shift_left
                                                                                              (
                                                                                                  Nativeint.of_string
                                                                                                  (
                                                                                                      "123456789"
                                                                                                  )
                                                                                                  32
                                                                                              )
                                                                                          )
                                                                                        ;
                                                                                          sequence
                                                                                          (
                                                                                            output_value
                                                                                            (
                                                                                                oc
                                                                                                Nativeint.shift_left
                                                                                                (
                                                                                                    Nativeint.of_string
                                                                                                    (
                                                                                                        "-123456789"
                                                                                                    )
                                                                                                    32
                                                                                                )
                                                                                            )
                                                                                          ;
                                                                                            let
                                                                                            (
                                                                                              (
                                                                                                i
                                                                                                  Int64.of_string
                                                                                                  (
                                                                                                      "123456789123456"
                                                                                                  )
                                                                                              )
                                                                                            in
                                                                                              sequence
                                                                                              (
                                                                                                output_value
                                                                                                (
                                                                                                    oc
                                                                                                    (
                                                                                                      i
                                                                                                      i
                                                                                                    )
                                                                                                )
                                                                                              ;
                                                                                                close_out
                                                                                                (
                                                                                                    oc
                                                                                                )
                                                                                              )
                                                                                            )
                                                                                          )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test
      (
        case
        (
          n
          (
            case
            (
              b
              sequence
              (
                print_string
                (
                    "Test "
                )
              ;
                sequence
                (
                  print_int
                  (
                      n
                  )
                ;
                  sequence
                  (
                    ifthenelse
                    (
                      if
                      (
                        b
                      )
                      then
                      (
                        print_string
                        (
                            " passed.\n"
                        )
                      )
                      else
                      (
                          print_string
                          (
                              " FAILED.\n"
                          )
                      )
                    )
                  ;
                    flush
                    (
                        stderr
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test_in
      (
        case
        (
          filename
          let
          (
            (
              ic
                open_in_bin
                (
                    filename
                )
            )
          in
            sequence
            (
              test
              (
                  1
                  =
                  (
                      input_value
                      (
                          ic
                      )
                      1
                  )
              )
            ;
              sequence
              (
                test
                (
                    2
                    =
                    (
                        input_value
                        (
                            ic
                        )
                        -1
                    )
                )
              ;
                sequence
                (
                  test
                  (
                      3
                      =
                      (
                          input_value
                          (
                              ic
                          )
                          258
                      )
                  )
                ;
                  sequence
                  (
                    test
                    (
                        4
                        =
                        (
                            input_value
                            (
                                ic
                            )
                            20000
                        )
                    )
                  ;
                    sequence
                    (
                      test
                      (
                          5
                          =
                          (
                              input_value
                              (
                                  ic
                              )
                              305419896
                          )
                      )
                    ;
                      sequence
                      (
                        test
                        (
                            6
                            =
                            (
                                input_value
                                (
                                    ic
                                )
                                bigint
                            )
                        )
                      ;
                        sequence
                        (
                          test
                          (
                              7
                              =
                              (
                                  input_value
                                  (
                                      ic
                                  )
                                  "foobargeebuz"
                              )
                          )
                        ;
                          sequence
                          (
                            test
                            (
                                8
                                =
                                (
                                    input_value
                                    (
                                        ic
                                    )
                                    longstring
                                )
                            )
                          ;
                            sequence
                            (
                              test
                              (
                                  9
                                  =
                                  (
                                      input_value
                                      (
                                          ic
                                      )
                                      verylongstring
                                  )
                              )
                            ;
                              sequence
                              (
                                test
                                (
                                    10
                                    =
                                    (
                                        input_value
                                        (
                                            ic
                                        )
                                        3.141592654
                                    )
                                )
                              ;
                                sequence
                                (
                                  test
                                  (
                                      11
                                      =
                                      (
                                          input_value
                                          (
                                              ic
                                          )
                                          ()
                                                                                )
                                  )
                                ;
                                  sequence
                                  (
                                    test
                                    (
                                        12
                                        match
                                        input_value
                                        (
                                            ic
                                        )
                                        (
                                          case
                                          (
                                            A
                                                                                        true
                                                                                      )
                                          case
                                          (
                                            _
                                            false
                                                                                      )
                                        )
                                    )
                                  ;
                                    sequence
                                    (
                                      test
                                      (
                                          13
                                          match
                                          input_value
                                          (
                                              ic
                                          )
                                          (
                                            case
                                            (
                                              B
                                                1
                                              true
                                                                                          )
                                            case
                                            (
                                              _
                                              false
                                                                                          )
                                          )
                                      )
                                    ;
                                      sequence
                                      (
                                        test
                                        (
                                            14
                                            match
                                            input_value
                                            (
                                                ic
                                            )
                                            (
                                              case
                                              (
                                                C
                                                  f
                                                =
                                                (
                                                    f
                                                    2.718
                                                )
                                              )
                                              case
                                              (
                                                _
                                                false
                                                                                              )
                                            )
                                        )
                                      ;
                                        sequence
                                        (
                                          test
                                          (
                                              15
                                              match
                                              input_value
                                              (
                                                  ic
                                              )
                                              (
                                                case
                                                (
                                                  D
                                                    "hello, world!"
                                                  true
                                                                                                  )
                                                case
                                                (
                                                  _
                                                  false
                                                                                                  )
                                              )
                                          )
                                        ;
                                          sequence
                                          (
                                            test
                                            (
                                                16
                                                match
                                                input_value
                                                (
                                                    ic
                                                )
                                                (
                                                  case
                                                  (
                                                    E
                                                      6c
                                                    true
                                                                                                      )
                                                  case
                                                  (
                                                    _
                                                    false
                                                                                                      )
                                                )
                                            )
                                          ;
                                            sequence
                                            (
                                              test
                                              (
                                                  17
                                                  match
                                                  input_value
                                                  (
                                                      ic
                                                  )
                                                  (
                                                    case
                                                    (
                                                      F
                                                        B
                                                          1
                                                      true
                                                                                                          )
                                                    case
                                                    (
                                                      _
                                                      false
                                                                                                          )
                                                  )
                                              )
                                            ;
                                              sequence
                                              (
                                                test
                                                (
                                                    18
                                                    match
                                                    input_value
                                                    (
                                                        ic
                                                    )
                                                    (
                                                      case
                                                      (
                                                        G
                                                          (
                                                            A
                                                                                                                        G
                                                              (
                                                                B
                                                                  2
                                                                G
                                                                  (
                                                                    C
                                                                      3.14
                                                                    G
                                                                      (
                                                                        D
                                                                          "glop"
                                                                        E
                                                                          65
                                                                      )
                                                                  )
                                                              )
                                                          )
                                                        true
                                                                                                              )
                                                      case
                                                      (
                                                        _
                                                        false
                                                                                                              )
                                                    )
                                                )
                                              ;
                                                sequence
                                                (
                                                  test
                                                  (
                                                      19
                                                      match
                                                      input_value
                                                      (
                                                          ic
                                                      )
                                                      (
                                                        case
                                                        (
                                                          H
                                                            (
                                                              1
                                                              A
                                                                                                                          )
                                                          true
                                                                                                                  )
                                                        case
                                                        (
                                                          _
                                                          false
                                                                                                                  )
                                                      )
                                                  )
                                                ;
                                                  sequence
                                                  (
                                                    test
                                                    (
                                                        20
                                                        match
                                                        input_value
                                                        (
                                                            ic
                                                        )
                                                        (
                                                          case
                                                          (
                                                            I
                                                              (
                                                                B
                                                                  2
                                                                1e-6
                                                              )
                                                            true
                                                                                                                      )
                                                          case
                                                          (
                                                            _
                                                            false
                                                                                                                      )
                                                        )
                                                    )
                                                  ;
                                                    sequence
                                                    (
                                                      test
                                                      (
                                                          21
                                                          match
                                                          input_value
                                                          (
                                                              ic
                                                          )
                                                          (
                                                            case
                                                            (
                                                              G
                                                                (
                                                                  alias t3
                                                                  (
                                                                    G
                                                                      (
                                                                        alias t1
                                                                        (
                                                                          D
                                                                            "sharing"
                                                                        )
                                                                        t2
                                                                      )
                                                                  )
                                                                  G
                                                                    (
                                                                      t4
                                                                      t5
                                                                    )
                                                                )
                                                              &&
                                                              (
                                                                  ==
                                                                  (
                                                                      t1
                                                                      t2
                                                                  )
                                                                  &&
                                                                  (
                                                                      ==
                                                                      (
                                                                          t3
                                                                          t5
                                                                      )
                                                                      ==
                                                                      (
                                                                          t4
                                                                          t1
                                                                      )
                                                                  )
                                                              )
                                                            )
                                                            case
                                                            (
                                                              _
                                                              false
                                                                                                                          )
                                                          )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        test
                                                        (
                                                            22
                                                            =
                                                            (
                                                                input_value
                                                                (
                                                                    ic
                                                                )
                                                                array
                                                                (
                                                                  1
                                                                  2
                                                                  3
                                                                  4
                                                                  5
                                                                  6
                                                                  7
                                                                  8
                                                                  9
                                                                  10
                                                                  11
                                                                  12
                                                                  13
                                                                  14
                                                                  15
                                                                  16
                                                                )
                                                            )
                                                        )
                                                      ;
                                                        let
                                                        (
                                                          (
                                                            check_big
                                                              (
                                                                case
                                                                (
                                                                  n
                                                                  (
                                                                    case
                                                                    (
                                                                      t
                                                                      ifthenelse
                                                                      (
                                                                        if
                                                                        (
                                                                          <=
                                                                          (
                                                                              n
                                                                              0
                                                                          )
                                                                        )
                                                                        then
                                                                        (
                                                                          test
                                                                          (
                                                                              23
                                                                              match
                                                                              t
                                                                              (
                                                                                case
                                                                                (
                                                                                  A
                                                                                                                                                                    true
                                                                                                                                                                  )
                                                                                case
                                                                                (
                                                                                  _
                                                                                  false
                                                                                                                                                                  )
                                                                              )
                                                                          )
                                                                        )
                                                                        else
                                                                        (
                                                                            match
                                                                            t
                                                                            (
                                                                              case
                                                                              (
                                                                                H
                                                                                  (
                                                                                    m
                                                                                    s
                                                                                  )
                                                                                ifthenelse
                                                                                (
                                                                                  if
                                                                                  (
                                                                                    =
                                                                                    (
                                                                                        m
                                                                                        n
                                                                                    )
                                                                                  )
                                                                                  then
                                                                                  (
                                                                                    check_big
                                                                                    (
                                                                                        -
                                                                                        (
                                                                                            n
                                                                                            1
                                                                                        )
                                                                                        s
                                                                                    )
                                                                                  )
                                                                                  else
                                                                                  (
                                                                                      test
                                                                                      (
                                                                                          23
                                                                                          false
                                                                                                                                                                                )
                                                                                  )
                                                                                )
                                                                              )
                                                                              case
                                                                              (
                                                                                _
                                                                                test
                                                                                (
                                                                                    23
                                                                                    false
                                                                                                                                                                    )
                                                                              )
                                                                            )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                          )
                                                        in
                                                          sequence
                                                          (
                                                            check_big
                                                            (
                                                                1000
                                                                input_value
                                                                (
                                                                    ic
                                                                )
                                                            )
                                                          ;
                                                            sequence
                                                            (
                                                              test
                                                              (
                                                                  24
                                                                  match
                                                                  input_value
                                                                  (
                                                                      ic
                                                                  )
                                                                  (
                                                                    case
                                                                    (
                                                                      G
                                                                        (
                                                                          alias t1
                                                                          (
                                                                            D
                                                                              "sharing"
                                                                          )
                                                                          alias t2
                                                                          (
                                                                            D
                                                                              "sharing"
                                                                          )
                                                                        )
                                                                      !=
                                                                      (
                                                                          t1
                                                                          t2
                                                                      )
                                                                    )
                                                                    case
                                                                    (
                                                                      _
                                                                      false
                                                                                                                                          )
                                                                  )
                                                              )
                                                            ;
                                                              sequence
                                                              (
                                                                test
                                                                (
                                                                    25
                                                                    let
                                                                    (
                                                                      (
                                                                        fib
                                                                          (
                                                                          input_value
                                                                          (
                                                                              ic
                                                                          )
                                                                          :
                                                                              arrow
                                                                                 int
                                                                                (
                                                                                )
                                                                                 int
                                                                                (
                                                                                )
                                                                                                                                                    )
                                                                      )
                                                                    in
                                                                      &&
                                                                      (
                                                                          =
                                                                          (
                                                                              fib
                                                                              (
                                                                                  5
                                                                              )
                                                                              8
                                                                          )
                                                                          =
                                                                          (
                                                                              fib
                                                                              (
                                                                                  10
                                                                              )
                                                                              89
                                                                          )
                                                                      )
                                                                    )
                                                                )
                                                              ;
                                                                sequence
                                                                (
                                                                  test
                                                                  (
                                                                      26
                                                                      =
                                                                      (
                                                                          input_value
                                                                          (
                                                                              ic
                                                                          )
                                                                          Int32.of_string
                                                                          (
                                                                              "0"
                                                                          )
                                                                      )
                                                                  )
                                                                ;
                                                                  sequence
                                                                  (
                                                                    test
                                                                    (
                                                                        27
                                                                        =
                                                                        (
                                                                            input_value
                                                                            (
                                                                                ic
                                                                            )
                                                                            Int32.of_string
                                                                            (
                                                                                "123456"
                                                                            )
                                                                        )
                                                                    )
                                                                  ;
                                                                    sequence
                                                                    (
                                                                      test
                                                                      (
                                                                          28
                                                                          =
                                                                          (
                                                                              input_value
                                                                              (
                                                                                  ic
                                                                              )
                                                                              Int32.of_string
                                                                              (
                                                                                  "-123456"
                                                                              )
                                                                          )
                                                                      )
                                                                    ;
                                                                      sequence
                                                                      (
                                                                        test
                                                                        (
                                                                            29
                                                                            =
                                                                            (
                                                                                input_value
                                                                                (
                                                                                    ic
                                                                                )
                                                                                Int64.of_string
                                                                                (
                                                                                    "0"
                                                                                )
                                                                            )
                                                                        )
                                                                      ;
                                                                        sequence
                                                                        (
                                                                          test
                                                                          (
                                                                              30
                                                                              =
                                                                              (
                                                                                  input_value
                                                                                  (
                                                                                      ic
                                                                                  )
                                                                                  Int64.of_string
                                                                                  (
                                                                                      "123456789123456"
                                                                                  )
                                                                              )
                                                                          )
                                                                        ;
                                                                          sequence
                                                                          (
                                                                            test
                                                                            (
                                                                                31
                                                                                =
                                                                                (
                                                                                    input_value
                                                                                    (
                                                                                        ic
                                                                                    )
                                                                                    Int64.of_string
                                                                                    (
                                                                                        "-123456789123456"
                                                                                    )
                                                                                )
                                                                            )
                                                                          ;
                                                                            sequence
                                                                            (
                                                                              test
                                                                              (
                                                                                  32
                                                                                  =
                                                                                  (
                                                                                      input_value
                                                                                      (
                                                                                          ic
                                                                                      )
                                                                                      Nativeint.of_string
                                                                                      (
                                                                                          "0"
                                                                                      )
                                                                                  )
                                                                              )
                                                                            ;
                                                                              sequence
                                                                              (
                                                                                test
                                                                                (
                                                                                    33
                                                                                    =
                                                                                    (
                                                                                        input_value
                                                                                        (
                                                                                            ic
                                                                                        )
                                                                                        Nativeint.of_string
                                                                                        (
                                                                                            "123456"
                                                                                        )
                                                                                    )
                                                                                )
                                                                              ;
                                                                                sequence
                                                                                (
                                                                                  test
                                                                                  (
                                                                                      34
                                                                                      =
                                                                                      (
                                                                                          input_value
                                                                                          (
                                                                                              ic
                                                                                          )
                                                                                          Nativeint.of_string
                                                                                          (
                                                                                              "-123456"
                                                                                          )
                                                                                      )
                                                                                  )
                                                                                ;
                                                                                  sequence
                                                                                  (
                                                                                    test
                                                                                    (
                                                                                        35
                                                                                        =
                                                                                        (
                                                                                            input_value
                                                                                            (
                                                                                                ic
                                                                                            )
                                                                                            Nativeint.shift_left
                                                                                            (
                                                                                                Nativeint.of_string
                                                                                                (
                                                                                                    "123456789"
                                                                                                )
                                                                                                32
                                                                                            )
                                                                                        )
                                                                                    )
                                                                                  ;
                                                                                    sequence
                                                                                    (
                                                                                      test
                                                                                      (
                                                                                          36
                                                                                          =
                                                                                          (
                                                                                              input_value
                                                                                              (
                                                                                                  ic
                                                                                              )
                                                                                              Nativeint.shift_left
                                                                                              (
                                                                                                  Nativeint.of_string
                                                                                                  (
                                                                                                      "-123456789"
                                                                                                  )
                                                                                                  32
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    ;
                                                                                      let
                                                                                      (
                                                                                        (
                                                                                          (
                                                                                            i
                                                                                            j
                                                                                          )
                                                                                            tuple
                                                                                            (
                                                                                                 int64
                                                                                                (
                                                                                                )
                                                                                                 int64
                                                                                                (
                                                                                                )
                                                                                            )
                                                                                            input_value
                                                                                            (
                                                                                                ic
                                                                                            )
                                                                                        )
                                                                                      in
                                                                                        sequence
                                                                                        (
                                                                                          test
                                                                                          (
                                                                                              37
                                                                                              =
                                                                                              (
                                                                                                  i
                                                                                                  Int64.of_string
                                                                                                  (
                                                                                                      "123456789123456"
                                                                                                  )
                                                                                              )
                                                                                          )
                                                                                        ;
                                                                                          sequence
                                                                                          (
                                                                                            test
                                                                                            (
                                                                                                38
                                                                                                =
                                                                                                (
                                                                                                    j
                                                                                                    Int64.of_string
                                                                                                    (
                                                                                                        "123456789123456"
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                          ;
                                                                                            sequence
                                                                                            (
                                                                                              test
                                                                                              (
                                                                                                  39
                                                                                                  ==
                                                                                                  (
                                                                                                      i
                                                                                                      j
                                                                                                  )
                                                                                              )
                                                                                            ;
                                                                                              close_in
                                                                                              (
                                                                                                  ic
                                                                                              )
                                                                                            )
                                                                                          )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test_string
      (
        case
        (
          ()
                    let
          (
            (
              s
                Marshal.to_string
                (
                    1
                    []
                                    )
            )
          in
            sequence
            (
              test
              (
                  101
                  =
                  (
                      Marshal.from_string
                      (
                          s
                          0
                      )
                      1
                  )
              )
            ;
              let
              (
                (
                  s
                    Marshal.to_string
                    (
                        -1
                        []
                                            )
                )
              in
                sequence
                (
                  test
                  (
                      102
                      =
                      (
                          Marshal.from_string
                          (
                              s
                              0
                          )
                          -1
                      )
                  )
                ;
                  let
                  (
                    (
                      s
                        Marshal.to_string
                        (
                            258
                            []
                                                    )
                    )
                  in
                    sequence
                    (
                      test
                      (
                          103
                          =
                          (
                              Marshal.from_string
                              (
                                  s
                                  0
                              )
                              258
                          )
                      )
                    ;
                      let
                      (
                        (
                          s
                            Marshal.to_string
                            (
                                20000
                                []
                                                            )
                        )
                      in
                        sequence
                        (
                          test
                          (
                              104
                              =
                              (
                                  Marshal.from_string
                                  (
                                      s
                                      0
                                  )
                                  20000
                              )
                          )
                        ;
                          let
                          (
                            (
                              s
                                Marshal.to_string
                                (
                                    305419896
                                    []
                                                                    )
                            )
                          in
                            sequence
                            (
                              test
                              (
                                  105
                                  =
                                  (
                                      Marshal.from_string
                                      (
                                          s
                                          0
                                      )
                                      305419896
                                  )
                              )
                            ;
                              let
                              (
                                (
                                  s
                                    Marshal.to_string
                                    (
                                        bigint
                                        []
                                                                            )
                                )
                              in
                                sequence
                                (
                                  test
                                  (
                                      106
                                      =
                                      (
                                          Marshal.from_string
                                          (
                                              s
                                              0
                                          )
                                          bigint
                                      )
                                  )
                                ;
                                  let
                                  (
                                    (
                                      s
                                        Marshal.to_string
                                        (
                                            "foobargeebuz"
                                            []
                                                                                    )
                                    )
                                  in
                                    sequence
                                    (
                                      test
                                      (
                                          107
                                          =
                                          (
                                              Marshal.from_string
                                              (
                                                  s
                                                  0
                                              )
                                              "foobargeebuz"
                                          )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          s
                                            Marshal.to_string
                                            (
                                                longstring
                                                []
                                                                                            )
                                        )
                                      in
                                        sequence
                                        (
                                          test
                                          (
                                              108
                                              =
                                              (
                                                  Marshal.from_string
                                                  (
                                                      s
                                                      0
                                                  )
                                                  longstring
                                              )
                                          )
                                        ;
                                          let
                                          (
                                            (
                                              s
                                                Marshal.to_string
                                                (
                                                    verylongstring
                                                    []
                                                                                                    )
                                            )
                                          in
                                            sequence
                                            (
                                              test
                                              (
                                                  109
                                                  =
                                                  (
                                                      Marshal.from_string
                                                      (
                                                          s
                                                          0
                                                      )
                                                      verylongstring
                                                  )
                                              )
                                            ;
                                              let
                                              (
                                                (
                                                  s
                                                    Marshal.to_string
                                                    (
                                                        3.141592654
                                                        []
                                                                                                            )
                                                )
                                              in
                                                sequence
                                                (
                                                  test
                                                  (
                                                      110
                                                      =
                                                      (
                                                          Marshal.from_string
                                                          (
                                                              s
                                                              0
                                                          )
                                                          3.141592654
                                                      )
                                                  )
                                                ;
                                                  let
                                                  (
                                                    (
                                                      s
                                                        Marshal.to_string
                                                        (
                                                            ()
                                                                                                                        []
                                                                                                                    )
                                                    )
                                                  in
                                                    sequence
                                                    (
                                                      test
                                                      (
                                                          111
                                                          =
                                                          (
                                                              Marshal.from_string
                                                              (
                                                                  s
                                                                  0
                                                              )
                                                              ()
                                                                                                                        )
                                                      )
                                                    ;
                                                      let
                                                      (
                                                        (
                                                          s
                                                            Marshal.to_string
                                                            (
                                                                A
                                                                                                                                []
                                                                                                                            )
                                                        )
                                                      in
                                                        sequence
                                                        (
                                                          test
                                                          (
                                                              112
                                                              match
                                                              Marshal.from_string
                                                              (
                                                                  s
                                                                  0
                                                              )
                                                              (
                                                                case
                                                                (
                                                                  A
                                                                                                                                    true
                                                                                                                                  )
                                                                case
                                                                (
                                                                  _
                                                                  false
                                                                                                                                  )
                                                              )
                                                          )
                                                        ;
                                                          let
                                                          (
                                                            (
                                                              s
                                                                Marshal.to_string
                                                                (
                                                                    B
                                                                      1
                                                                    []
                                                                                                                                    )
                                                            )
                                                          in
                                                            sequence
                                                            (
                                                              test
                                                              (
                                                                  113
                                                                  match
                                                                  Marshal.from_string
                                                                  (
                                                                      s
                                                                      0
                                                                  )
                                                                  (
                                                                    case
                                                                    (
                                                                      B
                                                                        1
                                                                      true
                                                                                                                                          )
                                                                    case
                                                                    (
                                                                      _
                                                                      false
                                                                                                                                          )
                                                                  )
                                                              )
                                                            ;
                                                              let
                                                              (
                                                                (
                                                                  s
                                                                    Marshal.to_string
                                                                    (
                                                                        C
                                                                          2.718
                                                                        []
                                                                                                                                            )
                                                                )
                                                              in
                                                                sequence
                                                                (
                                                                  test
                                                                  (
                                                                      114
                                                                      match
                                                                      Marshal.from_string
                                                                      (
                                                                          s
                                                                          0
                                                                      )
                                                                      (
                                                                        case
                                                                        (
                                                                          C
                                                                            f
                                                                          =
                                                                          (
                                                                              f
                                                                              2.718
                                                                          )
                                                                        )
                                                                        case
                                                                        (
                                                                          _
                                                                          false
                                                                                                                                                  )
                                                                      )
                                                                  )
                                                                ;
                                                                  let
                                                                  (
                                                                    (
                                                                      s
                                                                        Marshal.to_string
                                                                        (
                                                                            D
                                                                              "hello, world!"
                                                                            []
                                                                                                                                                    )
                                                                    )
                                                                  in
                                                                    sequence
                                                                    (
                                                                      test
                                                                      (
                                                                          115
                                                                          match
                                                                          Marshal.from_string
                                                                          (
                                                                              s
                                                                              0
                                                                          )
                                                                          (
                                                                            case
                                                                            (
                                                                              D
                                                                                "hello, world!"
                                                                              true
                                                                                                                                                          )
                                                                            case
                                                                            (
                                                                              _
                                                                              false
                                                                                                                                                          )
                                                                          )
                                                                      )
                                                                    ;
                                                                      let
                                                                      (
                                                                        (
                                                                          s
                                                                            Marshal.to_string
                                                                            (
                                                                                E
                                                                                  6c
                                                                                []
                                                                                                                                                            )
                                                                        )
                                                                      in
                                                                        sequence
                                                                        (
                                                                          test
                                                                          (
                                                                              116
                                                                              match
                                                                              Marshal.from_string
                                                                              (
                                                                                  s
                                                                                  0
                                                                              )
                                                                              (
                                                                                case
                                                                                (
                                                                                  E
                                                                                    6c
                                                                                  true
                                                                                                                                                                  )
                                                                                case
                                                                                (
                                                                                  _
                                                                                  false
                                                                                                                                                                  )
                                                                              )
                                                                          )
                                                                        ;
                                                                          let
                                                                          (
                                                                            (
                                                                              s
                                                                                Marshal.to_string
                                                                                (
                                                                                    F
                                                                                      B
                                                                                        1
                                                                                    []
                                                                                                                                                                    )
                                                                            )
                                                                          in
                                                                            sequence
                                                                            (
                                                                              test
                                                                              (
                                                                                  117
                                                                                  match
                                                                                  Marshal.from_string
                                                                                  (
                                                                                      s
                                                                                      0
                                                                                  )
                                                                                  (
                                                                                    case
                                                                                    (
                                                                                      F
                                                                                        B
                                                                                          1
                                                                                      true
                                                                                                                                                                          )
                                                                                    case
                                                                                    (
                                                                                      _
                                                                                      false
                                                                                                                                                                          )
                                                                                  )
                                                                              )
                                                                            ;
                                                                              let
                                                                              (
                                                                                (
                                                                                  s
                                                                                    Marshal.to_string
                                                                                    (
                                                                                        G
                                                                                          (
                                                                                            A
                                                                                                                                                                                        G
                                                                                              (
                                                                                                B
                                                                                                  2
                                                                                                G
                                                                                                  (
                                                                                                    C
                                                                                                      3.14
                                                                                                    G
                                                                                                      (
                                                                                                        D
                                                                                                          "glop"
                                                                                                        E
                                                                                                          65
                                                                                                      )
                                                                                                  )
                                                                                              )
                                                                                          )
                                                                                        []
                                                                                                                                                                            )
                                                                                )
                                                                              in
                                                                                sequence
                                                                                (
                                                                                  test
                                                                                  (
                                                                                      118
                                                                                      match
                                                                                      Marshal.from_string
                                                                                      (
                                                                                          s
                                                                                          0
                                                                                      )
                                                                                      (
                                                                                        case
                                                                                        (
                                                                                          G
                                                                                            (
                                                                                              A
                                                                                                                                                                                            G
                                                                                                (
                                                                                                  B
                                                                                                    2
                                                                                                  G
                                                                                                    (
                                                                                                      C
                                                                                                        3.14
                                                                                                      G
                                                                                                        (
                                                                                                          D
                                                                                                            "glop"
                                                                                                          E
                                                                                                            65
                                                                                                        )
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                          true
                                                                                                                                                                                  )
                                                                                        case
                                                                                        (
                                                                                          _
                                                                                          false
                                                                                                                                                                                  )
                                                                                      )
                                                                                  )
                                                                                ;
                                                                                  let
                                                                                  (
                                                                                    (
                                                                                      s
                                                                                        Marshal.to_string
                                                                                        (
                                                                                            H
                                                                                              (
                                                                                                1
                                                                                                A
                                                                                                                                                                                              )
                                                                                            []
                                                                                                                                                                                    )
                                                                                    )
                                                                                  in
                                                                                    sequence
                                                                                    (
                                                                                      test
                                                                                      (
                                                                                          119
                                                                                          match
                                                                                          Marshal.from_string
                                                                                          (
                                                                                              s
                                                                                              0
                                                                                          )
                                                                                          (
                                                                                            case
                                                                                            (
                                                                                              H
                                                                                                (
                                                                                                  1
                                                                                                  A
                                                                                                                                                                                                  )
                                                                                              true
                                                                                                                                                                                          )
                                                                                            case
                                                                                            (
                                                                                              _
                                                                                              false
                                                                                                                                                                                          )
                                                                                          )
                                                                                      )
                                                                                    ;
                                                                                      let
                                                                                      (
                                                                                        (
                                                                                          s
                                                                                            Marshal.to_string
                                                                                            (
                                                                                                I
                                                                                                  (
                                                                                                    B
                                                                                                      2
                                                                                                    1e-6
                                                                                                  )
                                                                                                []
                                                                                                                                                                                            )
                                                                                        )
                                                                                      in
                                                                                        sequence
                                                                                        (
                                                                                          test
                                                                                          (
                                                                                              120
                                                                                              match
                                                                                              Marshal.from_string
                                                                                              (
                                                                                                  s
                                                                                                  0
                                                                                              )
                                                                                              (
                                                                                                case
                                                                                                (
                                                                                                  I
                                                                                                    (
                                                                                                      B
                                                                                                        2
                                                                                                      1e-6
                                                                                                    )
                                                                                                  true
                                                                                                                                                                                                  )
                                                                                                case
                                                                                                (
                                                                                                  _
                                                                                                  false
                                                                                                                                                                                                  )
                                                                                              )
                                                                                          )
                                                                                        ;
                                                                                          let
                                                                                          (
                                                                                            (
                                                                                              x
                                                                                                D
                                                                                                  "sharing"
                                                                                            )
                                                                                          in
                                                                                            let
                                                                                            (
                                                                                              (
                                                                                                y
                                                                                                  G
                                                                                                    (
                                                                                                      x
                                                                                                      x
                                                                                                    )
                                                                                              )
                                                                                            in
                                                                                              let
                                                                                              (
                                                                                                (
                                                                                                  z
                                                                                                    G
                                                                                                      (
                                                                                                        y
                                                                                                        G
                                                                                                          (
                                                                                                            x
                                                                                                            y
                                                                                                          )
                                                                                                      )
                                                                                                )
                                                                                              in
                                                                                                let
                                                                                                (
                                                                                                  (
                                                                                                    s
                                                                                                      Marshal.to_string
                                                                                                      (
                                                                                                          z
                                                                                                          []
                                                                                                                                                                                                                )
                                                                                                  )
                                                                                                in
                                                                                                  sequence
                                                                                                  (
                                                                                                    test
                                                                                                    (
                                                                                                        121
                                                                                                        match
                                                                                                        Marshal.from_string
                                                                                                        (
                                                                                                            s
                                                                                                            0
                                                                                                        )
                                                                                                        (
                                                                                                          case
                                                                                                          (
                                                                                                            G
                                                                                                              (
                                                                                                                alias t3
                                                                                                                (
                                                                                                                  G
                                                                                                                    (
                                                                                                                      alias t1
                                                                                                                      (
                                                                                                                        D
                                                                                                                          "sharing"
                                                                                                                      )
                                                                                                                      t2
                                                                                                                    )
                                                                                                                )
                                                                                                                G
                                                                                                                  (
                                                                                                                    t4
                                                                                                                    t5
                                                                                                                  )
                                                                                                              )
                                                                                                            &&
                                                                                                            (
                                                                                                                ==
                                                                                                                (
                                                                                                                    t1
                                                                                                                    t2
                                                                                                                )
                                                                                                                &&
                                                                                                                (
                                                                                                                    ==
                                                                                                                    (
                                                                                                                        t3
                                                                                                                        t5
                                                                                                                    )
                                                                                                                    ==
                                                                                                                    (
                                                                                                                        t4
                                                                                                                        t1
                                                                                                                    )
                                                                                                                )
                                                                                                            )
                                                                                                          )
                                                                                                          case
                                                                                                          (
                                                                                                            _
                                                                                                            false
                                                                                                                                                                                                                      )
                                                                                                        )
                                                                                                    )
                                                                                                  ;
                                                                                                    let
                                                                                                    (
                                                                                                      (
                                                                                                        s
                                                                                                          Marshal.to_string
                                                                                                          (
                                                                                                              array
                                                                                                              (
                                                                                                                1
                                                                                                                2
                                                                                                                3
                                                                                                                4
                                                                                                                5
                                                                                                                6
                                                                                                                7
                                                                                                                8
                                                                                                                9
                                                                                                                10
                                                                                                                11
                                                                                                                12
                                                                                                                13
                                                                                                                14
                                                                                                                15
                                                                                                                16
                                                                                                              )
                                                                                                              []
                                                                                                                                                                                                                        )
                                                                                                      )
                                                                                                    in
                                                                                                      sequence
                                                                                                      (
                                                                                                        test
                                                                                                        (
                                                                                                            122
                                                                                                            =
                                                                                                            (
                                                                                                                Marshal.from_string
                                                                                                                (
                                                                                                                    s
                                                                                                                    0
                                                                                                                )
                                                                                                                array
                                                                                                                (
                                                                                                                  1
                                                                                                                  2
                                                                                                                  3
                                                                                                                  4
                                                                                                                  5
                                                                                                                  6
                                                                                                                  7
                                                                                                                  8
                                                                                                                  9
                                                                                                                  10
                                                                                                                  11
                                                                                                                  12
                                                                                                                  13
                                                                                                                  14
                                                                                                                  15
                                                                                                                  16
                                                                                                                )
                                                                                                            )
                                                                                                        )
                                                                                                      ;
                                                                                                        let
                                                                                                        (
                                                                                                          (
                                                                                                            big
                                                                                                              (
                                                                                                                case
                                                                                                                (
                                                                                                                  n
                                                                                                                  ifthenelse
                                                                                                                  (
                                                                                                                    if
                                                                                                                    (
                                                                                                                      <=
                                                                                                                      (
                                                                                                                          n
                                                                                                                          0
                                                                                                                      )
                                                                                                                    )
                                                                                                                    then
                                                                                                                    (
                                                                                                                      A
                                                                                                                                                                                                                                          )
                                                                                                                    else
                                                                                                                    (
                                                                                                                        H
                                                                                                                          (
                                                                                                                            n
                                                                                                                            big
                                                                                                                            (
                                                                                                                                -
                                                                                                                                (
                                                                                                                                    n
                                                                                                                                    1
                                                                                                                                )
                                                                                                                            )
                                                                                                                          )
                                                                                                                    )
                                                                                                                  )
                                                                                                                )
                                                                                                              )
                                                                                                          )
                                                                                                        in
                                                                                                          let
                                                                                                          (
                                                                                                            (
                                                                                                              s
                                                                                                                Marshal.to_string
                                                                                                                (
                                                                                                                    big
                                                                                                                    (
                                                                                                                        1000
                                                                                                                    )
                                                                                                                    []
                                                                                                                                                                                                                                    )
                                                                                                            )
                                                                                                          in
                                                                                                            let
                                                                                                            (
                                                                                                              (
                                                                                                                check_big
                                                                                                                  (
                                                                                                                    case
                                                                                                                    (
                                                                                                                      n
                                                                                                                      (
                                                                                                                        case
                                                                                                                        (
                                                                                                                          t
                                                                                                                          ifthenelse
                                                                                                                          (
                                                                                                                            if
                                                                                                                            (
                                                                                                                              <=
                                                                                                                              (
                                                                                                                                  n
                                                                                                                                  0
                                                                                                                              )
                                                                                                                            )
                                                                                                                            then
                                                                                                                            (
                                                                                                                              test
                                                                                                                              (
                                                                                                                                  123
                                                                                                                                  match
                                                                                                                                  t
                                                                                                                                  (
                                                                                                                                    case
                                                                                                                                    (
                                                                                                                                      A
                                                                                                                                                                                                                                                                            true
                                                                                                                                                                                                                                                                          )
                                                                                                                                    case
                                                                                                                                    (
                                                                                                                                      _
                                                                                                                                      false
                                                                                                                                                                                                                                                                          )
                                                                                                                                  )
                                                                                                                              )
                                                                                                                            )
                                                                                                                            else
                                                                                                                            (
                                                                                                                                match
                                                                                                                                t
                                                                                                                                (
                                                                                                                                  case
                                                                                                                                  (
                                                                                                                                    H
                                                                                                                                      (
                                                                                                                                        m
                                                                                                                                        s
                                                                                                                                      )
                                                                                                                                    ifthenelse
                                                                                                                                    (
                                                                                                                                      if
                                                                                                                                      (
                                                                                                                                        =
                                                                                                                                        (
                                                                                                                                            m
                                                                                                                                            n
                                                                                                                                        )
                                                                                                                                      )
                                                                                                                                      then
                                                                                                                                      (
                                                                                                                                        check_big
                                                                                                                                        (
                                                                                                                                            -
                                                                                                                                            (
                                                                                                                                                n
                                                                                                                                                1
                                                                                                                                            )
                                                                                                                                            s
                                                                                                                                        )
                                                                                                                                      )
                                                                                                                                      else
                                                                                                                                      (
                                                                                                                                          test
                                                                                                                                          (
                                                                                                                                              123
                                                                                                                                              false
                                                                                                                                                                                                                                                                                        )
                                                                                                                                      )
                                                                                                                                    )
                                                                                                                                  )
                                                                                                                                  case
                                                                                                                                  (
                                                                                                                                    _
                                                                                                                                    test
                                                                                                                                    (
                                                                                                                                        123
                                                                                                                                        false
                                                                                                                                                                                                                                                                            )
                                                                                                                                  )
                                                                                                                                )
                                                                                                                            )
                                                                                                                          )
                                                                                                                        )
                                                                                                                      )
                                                                                                                    )
                                                                                                                  )
                                                                                                              )
                                                                                                            in
                                                                                                              check_big
                                                                                                              (
                                                                                                                  1000
                                                                                                                  Marshal.from_string
                                                                                                                  (
                                                                                                                      s
                                                                                                                      0
                                                                                                                  )
                                                                                                              )
                                                                                                            )
                                                                                                          )
                                                                                                        )
                                                                                                      )
                                                                                                    )
                                                                                                  )
                                                                                                )
                                                                                              )
                                                                                            )
                                                                                          )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    marshal_to_buffer
      (
        case
        (
          s
          (
            case
            (
              start
              (
                case
                (
                  len
                  (
                    case
                    (
                      v
                      (
                        case
                        (
                          flags
                          ignore
                          (
                              Marshal.to_buffer
                              (
                                  s
                                  start
                                  len
                                  v
                                  flags
                              )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test_buffer
      (
        case
        (
          ()
                    let
          (
            (
              s
                String.create
                (
                    512
                )
            )
          in
            sequence
            (
              marshal_to_buffer
              (
                  s
                  0
                  512
                  1
                  []
                                )
            ;
              sequence
              (
                test
                (
                    201
                    =
                    (
                        Marshal.from_string
                        (
                            s
                            0
                        )
                        1
                    )
                )
              ;
                sequence
                (
                  marshal_to_buffer
                  (
                      s
                      0
                      512
                      -1
                      []
                                        )
                ;
                  sequence
                  (
                    test
                    (
                        202
                        =
                        (
                            Marshal.from_string
                            (
                                s
                                0
                            )
                            -1
                        )
                    )
                  ;
                    sequence
                    (
                      marshal_to_buffer
                      (
                          s
                          0
                          512
                          258
                          []
                                                )
                    ;
                      sequence
                      (
                        test
                        (
                            203
                            =
                            (
                                Marshal.from_string
                                (
                                    s
                                    0
                                )
                                258
                            )
                        )
                      ;
                        sequence
                        (
                          marshal_to_buffer
                          (
                              s
                              0
                              512
                              20000
                              []
                                                        )
                        ;
                          sequence
                          (
                            test
                            (
                                204
                                =
                                (
                                    Marshal.from_string
                                    (
                                        s
                                        0
                                    )
                                    20000
                                )
                            )
                          ;
                            sequence
                            (
                              marshal_to_buffer
                              (
                                  s
                                  0
                                  512
                                  305419896
                                  []
                                                                )
                            ;
                              sequence
                              (
                                test
                                (
                                    205
                                    =
                                    (
                                        Marshal.from_string
                                        (
                                            s
                                            0
                                        )
                                        305419896
                                    )
                                )
                              ;
                                sequence
                                (
                                  marshal_to_buffer
                                  (
                                      s
                                      0
                                      512
                                      bigint
                                      []
                                                                        )
                                ;
                                  sequence
                                  (
                                    test
                                    (
                                        206
                                        =
                                        (
                                            Marshal.from_string
                                            (
                                                s
                                                0
                                            )
                                            bigint
                                        )
                                    )
                                  ;
                                    sequence
                                    (
                                      marshal_to_buffer
                                      (
                                          s
                                          0
                                          512
                                          "foobargeebuz"
                                          []
                                                                                )
                                    ;
                                      sequence
                                      (
                                        test
                                        (
                                            207
                                            =
                                            (
                                                Marshal.from_string
                                                (
                                                    s
                                                    0
                                                )
                                                "foobargeebuz"
                                            )
                                        )
                                      ;
                                        sequence
                                        (
                                          marshal_to_buffer
                                          (
                                              s
                                              0
                                              512
                                              longstring
                                              []
                                                                                        )
                                        ;
                                          sequence
                                          (
                                            test
                                            (
                                                208
                                                =
                                                (
                                                    Marshal.from_string
                                                    (
                                                        s
                                                        0
                                                    )
                                                    longstring
                                                )
                                            )
                                          ;
                                            sequence
                                            (
                                              test
                                              (
                                                  209
                                                  try
                                                  sequence
                                                  (
                                                    marshal_to_buffer
                                                    (
                                                        s
                                                        0
                                                        512
                                                        verylongstring
                                                        []
                                                                                                            )
                                                  ;
                                                    false
                                                                                                      )
                                                  (
                                                    case
                                                    (
                                                      Failure
                                                        "Marshal.to_buffer: buffer overflow"
                                                      true
                                                                                                          )
                                                  )
                                              )
                                            ;
                                              sequence
                                              (
                                                marshal_to_buffer
                                                (
                                                    s
                                                    0
                                                    512
                                                    3.141592654
                                                    []
                                                                                                    )
                                              ;
                                                sequence
                                                (
                                                  test
                                                  (
                                                      210
                                                      =
                                                      (
                                                          Marshal.from_string
                                                          (
                                                              s
                                                              0
                                                          )
                                                          3.141592654
                                                      )
                                                  )
                                                ;
                                                  sequence
                                                  (
                                                    marshal_to_buffer
                                                    (
                                                        s
                                                        0
                                                        512
                                                        ()
                                                                                                                []
                                                                                                            )
                                                  ;
                                                    sequence
                                                    (
                                                      test
                                                      (
                                                          211
                                                          =
                                                          (
                                                              Marshal.from_string
                                                              (
                                                                  s
                                                                  0
                                                              )
                                                              ()
                                                                                                                        )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        marshal_to_buffer
                                                        (
                                                            s
                                                            0
                                                            512
                                                            A
                                                                                                                        []
                                                                                                                    )
                                                      ;
                                                        sequence
                                                        (
                                                          test
                                                          (
                                                              212
                                                              match
                                                              Marshal.from_string
                                                              (
                                                                  s
                                                                  0
                                                              )
                                                              (
                                                                case
                                                                (
                                                                  A
                                                                                                                                    true
                                                                                                                                  )
                                                                case
                                                                (
                                                                  _
                                                                  false
                                                                                                                                  )
                                                              )
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            marshal_to_buffer
                                                            (
                                                                s
                                                                0
                                                                512
                                                                B
                                                                  1
                                                                []
                                                                                                                            )
                                                          ;
                                                            sequence
                                                            (
                                                              test
                                                              (
                                                                  213
                                                                  match
                                                                  Marshal.from_string
                                                                  (
                                                                      s
                                                                      0
                                                                  )
                                                                  (
                                                                    case
                                                                    (
                                                                      B
                                                                        1
                                                                      true
                                                                                                                                          )
                                                                    case
                                                                    (
                                                                      _
                                                                      false
                                                                                                                                          )
                                                                  )
                                                              )
                                                            ;
                                                              sequence
                                                              (
                                                                marshal_to_buffer
                                                                (
                                                                    s
                                                                    0
                                                                    512
                                                                    C
                                                                      2.718
                                                                    []
                                                                                                                                    )
                                                              ;
                                                                sequence
                                                                (
                                                                  test
                                                                  (
                                                                      214
                                                                      match
                                                                      Marshal.from_string
                                                                      (
                                                                          s
                                                                          0
                                                                      )
                                                                      (
                                                                        case
                                                                        (
                                                                          C
                                                                            f
                                                                          =
                                                                          (
                                                                              f
                                                                              2.718
                                                                          )
                                                                        )
                                                                        case
                                                                        (
                                                                          _
                                                                          false
                                                                                                                                                  )
                                                                      )
                                                                  )
                                                                ;
                                                                  sequence
                                                                  (
                                                                    marshal_to_buffer
                                                                    (
                                                                        s
                                                                        0
                                                                        512
                                                                        D
                                                                          "hello, world!"
                                                                        []
                                                                                                                                            )
                                                                  ;
                                                                    sequence
                                                                    (
                                                                      test
                                                                      (
                                                                          215
                                                                          match
                                                                          Marshal.from_string
                                                                          (
                                                                              s
                                                                              0
                                                                          )
                                                                          (
                                                                            case
                                                                            (
                                                                              D
                                                                                "hello, world!"
                                                                              true
                                                                                                                                                          )
                                                                            case
                                                                            (
                                                                              _
                                                                              false
                                                                                                                                                          )
                                                                          )
                                                                      )
                                                                    ;
                                                                      sequence
                                                                      (
                                                                        marshal_to_buffer
                                                                        (
                                                                            s
                                                                            0
                                                                            512
                                                                            E
                                                                              6c
                                                                            []
                                                                                                                                                    )
                                                                      ;
                                                                        sequence
                                                                        (
                                                                          test
                                                                          (
                                                                              216
                                                                              match
                                                                              Marshal.from_string
                                                                              (
                                                                                  s
                                                                                  0
                                                                              )
                                                                              (
                                                                                case
                                                                                (
                                                                                  E
                                                                                    6c
                                                                                  true
                                                                                                                                                                  )
                                                                                case
                                                                                (
                                                                                  _
                                                                                  false
                                                                                                                                                                  )
                                                                              )
                                                                          )
                                                                        ;
                                                                          sequence
                                                                          (
                                                                            marshal_to_buffer
                                                                            (
                                                                                s
                                                                                0
                                                                                512
                                                                                F
                                                                                  B
                                                                                    1
                                                                                []
                                                                                                                                                            )
                                                                          ;
                                                                            sequence
                                                                            (
                                                                              test
                                                                              (
                                                                                  217
                                                                                  match
                                                                                  Marshal.from_string
                                                                                  (
                                                                                      s
                                                                                      0
                                                                                  )
                                                                                  (
                                                                                    case
                                                                                    (
                                                                                      F
                                                                                        B
                                                                                          1
                                                                                      true
                                                                                                                                                                          )
                                                                                    case
                                                                                    (
                                                                                      _
                                                                                      false
                                                                                                                                                                          )
                                                                                  )
                                                                              )
                                                                            ;
                                                                              sequence
                                                                              (
                                                                                marshal_to_buffer
                                                                                (
                                                                                    s
                                                                                    0
                                                                                    512
                                                                                    G
                                                                                      (
                                                                                        A
                                                                                                                                                                                G
                                                                                          (
                                                                                            B
                                                                                              2
                                                                                            G
                                                                                              (
                                                                                                C
                                                                                                  3.14
                                                                                                G
                                                                                                  (
                                                                                                    D
                                                                                                      "glop"
                                                                                                    E
                                                                                                      65
                                                                                                  )
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    []
                                                                                                                                                                    )
                                                                              ;
                                                                                sequence
                                                                                (
                                                                                  test
                                                                                  (
                                                                                      218
                                                                                      match
                                                                                      Marshal.from_string
                                                                                      (
                                                                                          s
                                                                                          0
                                                                                      )
                                                                                      (
                                                                                        case
                                                                                        (
                                                                                          G
                                                                                            (
                                                                                              A
                                                                                                                                                                                            G
                                                                                                (
                                                                                                  B
                                                                                                    2
                                                                                                  G
                                                                                                    (
                                                                                                      C
                                                                                                        3.14
                                                                                                      G
                                                                                                        (
                                                                                                          D
                                                                                                            "glop"
                                                                                                          E
                                                                                                            65
                                                                                                        )
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                          true
                                                                                                                                                                                  )
                                                                                        case
                                                                                        (
                                                                                          _
                                                                                          false
                                                                                                                                                                                  )
                                                                                      )
                                                                                  )
                                                                                ;
                                                                                  sequence
                                                                                  (
                                                                                    marshal_to_buffer
                                                                                    (
                                                                                        s
                                                                                        0
                                                                                        512
                                                                                        H
                                                                                          (
                                                                                            1
                                                                                            A
                                                                                                                                                                                      )
                                                                                        []
                                                                                                                                                                            )
                                                                                  ;
                                                                                    sequence
                                                                                    (
                                                                                      test
                                                                                      (
                                                                                          219
                                                                                          match
                                                                                          Marshal.from_string
                                                                                          (
                                                                                              s
                                                                                              0
                                                                                          )
                                                                                          (
                                                                                            case
                                                                                            (
                                                                                              H
                                                                                                (
                                                                                                  1
                                                                                                  A
                                                                                                                                                                                                  )
                                                                                              true
                                                                                                                                                                                          )
                                                                                            case
                                                                                            (
                                                                                              _
                                                                                              false
                                                                                                                                                                                          )
                                                                                          )
                                                                                      )
                                                                                    ;
                                                                                      sequence
                                                                                      (
                                                                                        marshal_to_buffer
                                                                                        (
                                                                                            s
                                                                                            0
                                                                                            512
                                                                                            I
                                                                                              (
                                                                                                B
                                                                                                  2
                                                                                                1e-6
                                                                                              )
                                                                                            []
                                                                                                                                                                                    )
                                                                                      ;
                                                                                        sequence
                                                                                        (
                                                                                          test
                                                                                          (
                                                                                              220
                                                                                              match
                                                                                              Marshal.from_string
                                                                                              (
                                                                                                  s
                                                                                                  0
                                                                                              )
                                                                                              (
                                                                                                case
                                                                                                (
                                                                                                  I
                                                                                                    (
                                                                                                      B
                                                                                                        2
                                                                                                      1e-6
                                                                                                    )
                                                                                                  true
                                                                                                                                                                                                  )
                                                                                                case
                                                                                                (
                                                                                                  _
                                                                                                  false
                                                                                                                                                                                                  )
                                                                                              )
                                                                                          )
                                                                                        ;
                                                                                          let
                                                                                          (
                                                                                            (
                                                                                              x
                                                                                                D
                                                                                                  "sharing"
                                                                                            )
                                                                                          in
                                                                                            let
                                                                                            (
                                                                                              (
                                                                                                y
                                                                                                  G
                                                                                                    (
                                                                                                      x
                                                                                                      x
                                                                                                    )
                                                                                              )
                                                                                            in
                                                                                              let
                                                                                              (
                                                                                                (
                                                                                                  z
                                                                                                    G
                                                                                                      (
                                                                                                        y
                                                                                                        G
                                                                                                          (
                                                                                                            x
                                                                                                            y
                                                                                                          )
                                                                                                      )
                                                                                                )
                                                                                              in
                                                                                                sequence
                                                                                                (
                                                                                                  marshal_to_buffer
                                                                                                  (
                                                                                                      s
                                                                                                      0
                                                                                                      512
                                                                                                      z
                                                                                                      []
                                                                                                                                                                                                        )
                                                                                                ;
                                                                                                  sequence
                                                                                                  (
                                                                                                    test
                                                                                                    (
                                                                                                        221
                                                                                                        match
                                                                                                        Marshal.from_string
                                                                                                        (
                                                                                                            s
                                                                                                            0
                                                                                                        )
                                                                                                        (
                                                                                                          case
                                                                                                          (
                                                                                                            G
                                                                                                              (
                                                                                                                alias t3
                                                                                                                (
                                                                                                                  G
                                                                                                                    (
                                                                                                                      alias t1
                                                                                                                      (
                                                                                                                        D
                                                                                                                          "sharing"
                                                                                                                      )
                                                                                                                      t2
                                                                                                                    )
                                                                                                                )
                                                                                                                G
                                                                                                                  (
                                                                                                                    t4
                                                                                                                    t5
                                                                                                                  )
                                                                                                              )
                                                                                                            &&
                                                                                                            (
                                                                                                                ==
                                                                                                                (
                                                                                                                    t1
                                                                                                                    t2
                                                                                                                )
                                                                                                                &&
                                                                                                                (
                                                                                                                    ==
                                                                                                                    (
                                                                                                                        t3
                                                                                                                        t5
                                                                                                                    )
                                                                                                                    ==
                                                                                                                    (
                                                                                                                        t4
                                                                                                                        t1
                                                                                                                    )
                                                                                                                )
                                                                                                            )
                                                                                                          )
                                                                                                          case
                                                                                                          (
                                                                                                            _
                                                                                                            false
                                                                                                                                                                                                                      )
                                                                                                        )
                                                                                                    )
                                                                                                  ;
                                                                                                    sequence
                                                                                                    (
                                                                                                      marshal_to_buffer
                                                                                                      (
                                                                                                          s
                                                                                                          0
                                                                                                          512
                                                                                                          array
                                                                                                          (
                                                                                                            1
                                                                                                            2
                                                                                                            3
                                                                                                            4
                                                                                                            5
                                                                                                            6
                                                                                                            7
                                                                                                            8
                                                                                                            9
                                                                                                            10
                                                                                                            11
                                                                                                            12
                                                                                                            13
                                                                                                            14
                                                                                                            15
                                                                                                            16
                                                                                                          )
                                                                                                          []
                                                                                                                                                                                                                )
                                                                                                    ;
                                                                                                      sequence
                                                                                                      (
                                                                                                        test
                                                                                                        (
                                                                                                            222
                                                                                                            =
                                                                                                            (
                                                                                                                Marshal.from_string
                                                                                                                (
                                                                                                                    s
                                                                                                                    0
                                                                                                                )
                                                                                                                array
                                                                                                                (
                                                                                                                  1
                                                                                                                  2
                                                                                                                  3
                                                                                                                  4
                                                                                                                  5
                                                                                                                  6
                                                                                                                  7
                                                                                                                  8
                                                                                                                  9
                                                                                                                  10
                                                                                                                  11
                                                                                                                  12
                                                                                                                  13
                                                                                                                  14
                                                                                                                  15
                                                                                                                  16
                                                                                                                )
                                                                                                            )
                                                                                                        )
                                                                                                      ;
                                                                                                        let
                                                                                                        (
                                                                                                          (
                                                                                                            big
                                                                                                              (
                                                                                                                case
                                                                                                                (
                                                                                                                  n
                                                                                                                  ifthenelse
                                                                                                                  (
                                                                                                                    if
                                                                                                                    (
                                                                                                                      <=
                                                                                                                      (
                                                                                                                          n
                                                                                                                          0
                                                                                                                      )
                                                                                                                    )
                                                                                                                    then
                                                                                                                    (
                                                                                                                      A
                                                                                                                                                                                                                                          )
                                                                                                                    else
                                                                                                                    (
                                                                                                                        H
                                                                                                                          (
                                                                                                                            n
                                                                                                                            big
                                                                                                                            (
                                                                                                                                -
                                                                                                                                (
                                                                                                                                    n
                                                                                                                                    1
                                                                                                                                )
                                                                                                                            )
                                                                                                                          )
                                                                                                                    )
                                                                                                                  )
                                                                                                                )
                                                                                                              )
                                                                                                          )
                                                                                                        in
                                                                                                          test
                                                                                                          (
                                                                                                              223
                                                                                                              try
                                                                                                              sequence
                                                                                                              (
                                                                                                                marshal_to_buffer
                                                                                                                (
                                                                                                                    s
                                                                                                                    0
                                                                                                                    512
                                                                                                                    big
                                                                                                                    (
                                                                                                                        1000
                                                                                                                    )
                                                                                                                    []
                                                                                                                                                                                                                                    )
                                                                                                              ;
                                                                                                                false
                                                                                                                                                                                                                              )
                                                                                                              (
                                                                                                                case
                                                                                                                (
                                                                                                                  Failure
                                                                                                                    "Marshal.to_buffer: buffer overflow"
                                                                                                                  true
                                                                                                                                                                                                                                  )
                                                                                                              )
                                                                                                          )
                                                                                                        )
                                                                                                      )
                                                                                                    )
                                                                                                  )
                                                                                                )
                                                                                              )
                                                                                            )
                                                                                          )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test_size
      (
        case
        (
          ()
                    let
          (
            (
              s
                Marshal.to_string
                (
                    G
                      (
                        A
                                                G
                          (
                            B
                              2
                            G
                              (
                                C
                                  3.14
                                G
                                  (
                                    D
                                      "glop"
                                    E
                                      65
                                  )
                              )
                          )
                      )
                    []
                                    )
            )
          in
            test
            (
                300
                =
                (
                    +
                    (
                        Marshal.header_size
                        Marshal.data_size
                        (
                            s
                            0
                        )
                    )
                    String.length
                    (
                        s
                    )
                )
            )
          )
        )
      )
  )
  external marshal_to_block
  (
  value_description
      arrow
         string
        (
        )
        arrow
           int
          (
          )
          arrow
            a
            arrow
               list
              (
                   Marshal.extern_flags
                  (
                  )
              )
               unit
              (
              )
    (
      "marshal_to_block"
    )
  )
  external marshal_from_block
  (
  value_description
      arrow
         string
        (
        )
        arrow
           int
          (
          )
          a
    (
      "marshal_from_block"
    )
  )
  external static_alloc
  (
  value_description
      arrow
         int
        (
        )
         string
        (
        )
    (
      "caml_static_alloc"
    )
  )
  let
  (
    test_block
      (
        case
        (
          ()
                    let
          (
            (
              s
                static_alloc
                (
                    512
                )
            )
          in
            sequence
            (
              marshal_to_block
              (
                  s
                  512
                  1
                  []
                                )
            ;
              sequence
              (
                test
                (
                    401
                    =
                    (
                        marshal_from_block
                        (
                            s
                            512
                        )
                        1
                    )
                )
              ;
                sequence
                (
                  marshal_to_block
                  (
                      s
                      512
                      -1
                      []
                                        )
                ;
                  sequence
                  (
                    test
                    (
                        402
                        =
                        (
                            marshal_from_block
                            (
                                s
                                512
                            )
                            -1
                        )
                    )
                  ;
                    sequence
                    (
                      marshal_to_block
                      (
                          s
                          512
                          258
                          []
                                                )
                    ;
                      sequence
                      (
                        test
                        (
                            403
                            =
                            (
                                marshal_from_block
                                (
                                    s
                                    512
                                )
                                258
                            )
                        )
                      ;
                        sequence
                        (
                          marshal_to_block
                          (
                              s
                              512
                              20000
                              []
                                                        )
                        ;
                          sequence
                          (
                            test
                            (
                                404
                                =
                                (
                                    marshal_from_block
                                    (
                                        s
                                        512
                                    )
                                    20000
                                )
                            )
                          ;
                            sequence
                            (
                              marshal_to_block
                              (
                                  s
                                  512
                                  305419896
                                  []
                                                                )
                            ;
                              sequence
                              (
                                test
                                (
                                    405
                                    =
                                    (
                                        marshal_from_block
                                        (
                                            s
                                            512
                                        )
                                        305419896
                                    )
                                )
                              ;
                                sequence
                                (
                                  marshal_to_block
                                  (
                                      s
                                      512
                                      bigint
                                      []
                                                                        )
                                ;
                                  sequence
                                  (
                                    test
                                    (
                                        406
                                        =
                                        (
                                            marshal_from_block
                                            (
                                                s
                                                512
                                            )
                                            bigint
                                        )
                                    )
                                  ;
                                    sequence
                                    (
                                      marshal_to_block
                                      (
                                          s
                                          512
                                          "foobargeebuz"
                                          []
                                                                                )
                                    ;
                                      sequence
                                      (
                                        test
                                        (
                                            407
                                            =
                                            (
                                                marshal_from_block
                                                (
                                                    s
                                                    512
                                                )
                                                "foobargeebuz"
                                            )
                                        )
                                      ;
                                        sequence
                                        (
                                          marshal_to_block
                                          (
                                              s
                                              512
                                              longstring
                                              []
                                                                                        )
                                        ;
                                          sequence
                                          (
                                            test
                                            (
                                                408
                                                =
                                                (
                                                    marshal_from_block
                                                    (
                                                        s
                                                        512
                                                    )
                                                    longstring
                                                )
                                            )
                                          ;
                                            sequence
                                            (
                                              test
                                              (
                                                  409
                                                  try
                                                  sequence
                                                  (
                                                    marshal_to_block
                                                    (
                                                        s
                                                        512
                                                        verylongstring
                                                        []
                                                                                                            )
                                                  ;
                                                    false
                                                                                                      )
                                                  (
                                                    case
                                                    (
                                                      Failure
                                                        "Marshal.to_buffer: buffer overflow"
                                                      true
                                                                                                          )
                                                  )
                                              )
                                            ;
                                              sequence
                                              (
                                                marshal_to_block
                                                (
                                                    s
                                                    512
                                                    3.141592654
                                                    []
                                                                                                    )
                                              ;
                                                sequence
                                                (
                                                  test
                                                  (
                                                      410
                                                      =
                                                      (
                                                          marshal_from_block
                                                          (
                                                              s
                                                              512
                                                          )
                                                          3.141592654
                                                      )
                                                  )
                                                ;
                                                  sequence
                                                  (
                                                    marshal_to_block
                                                    (
                                                        s
                                                        512
                                                        ()
                                                                                                                []
                                                                                                            )
                                                  ;
                                                    sequence
                                                    (
                                                      test
                                                      (
                                                          411
                                                          =
                                                          (
                                                              marshal_from_block
                                                              (
                                                                  s
                                                                  512
                                                              )
                                                              ()
                                                                                                                        )
                                                      )
                                                    ;
                                                      sequence
                                                      (
                                                        marshal_to_block
                                                        (
                                                            s
                                                            512
                                                            A
                                                                                                                        []
                                                                                                                    )
                                                      ;
                                                        sequence
                                                        (
                                                          test
                                                          (
                                                              412
                                                              match
                                                              marshal_from_block
                                                              (
                                                                  s
                                                                  512
                                                              )
                                                              (
                                                                case
                                                                (
                                                                  A
                                                                                                                                    true
                                                                                                                                  )
                                                                case
                                                                (
                                                                  _
                                                                  false
                                                                                                                                  )
                                                              )
                                                          )
                                                        ;
                                                          sequence
                                                          (
                                                            marshal_to_block
                                                            (
                                                                s
                                                                512
                                                                B
                                                                  1
                                                                []
                                                                                                                            )
                                                          ;
                                                            sequence
                                                            (
                                                              test
                                                              (
                                                                  413
                                                                  match
                                                                  marshal_from_block
                                                                  (
                                                                      s
                                                                      512
                                                                  )
                                                                  (
                                                                    case
                                                                    (
                                                                      B
                                                                        1
                                                                      true
                                                                                                                                          )
                                                                    case
                                                                    (
                                                                      _
                                                                      false
                                                                                                                                          )
                                                                  )
                                                              )
                                                            ;
                                                              sequence
                                                              (
                                                                marshal_to_block
                                                                (
                                                                    s
                                                                    512
                                                                    C
                                                                      2.718
                                                                    []
                                                                                                                                    )
                                                              ;
                                                                sequence
                                                                (
                                                                  test
                                                                  (
                                                                      414
                                                                      match
                                                                      marshal_from_block
                                                                      (
                                                                          s
                                                                          512
                                                                      )
                                                                      (
                                                                        case
                                                                        (
                                                                          C
                                                                            f
                                                                          =
                                                                          (
                                                                              f
                                                                              2.718
                                                                          )
                                                                        )
                                                                        case
                                                                        (
                                                                          _
                                                                          false
                                                                                                                                                  )
                                                                      )
                                                                  )
                                                                ;
                                                                  sequence
                                                                  (
                                                                    marshal_to_block
                                                                    (
                                                                        s
                                                                        512
                                                                        D
                                                                          "hello, world!"
                                                                        []
                                                                                                                                            )
                                                                  ;
                                                                    sequence
                                                                    (
                                                                      test
                                                                      (
                                                                          415
                                                                          match
                                                                          marshal_from_block
                                                                          (
                                                                              s
                                                                              512
                                                                          )
                                                                          (
                                                                            case
                                                                            (
                                                                              D
                                                                                "hello, world!"
                                                                              true
                                                                                                                                                          )
                                                                            case
                                                                            (
                                                                              _
                                                                              false
                                                                                                                                                          )
                                                                          )
                                                                      )
                                                                    ;
                                                                      sequence
                                                                      (
                                                                        marshal_to_block
                                                                        (
                                                                            s
                                                                            512
                                                                            E
                                                                              6c
                                                                            []
                                                                                                                                                    )
                                                                      ;
                                                                        sequence
                                                                        (
                                                                          test
                                                                          (
                                                                              416
                                                                              match
                                                                              marshal_from_block
                                                                              (
                                                                                  s
                                                                                  512
                                                                              )
                                                                              (
                                                                                case
                                                                                (
                                                                                  E
                                                                                    6c
                                                                                  true
                                                                                                                                                                  )
                                                                                case
                                                                                (
                                                                                  _
                                                                                  false
                                                                                                                                                                  )
                                                                              )
                                                                          )
                                                                        ;
                                                                          sequence
                                                                          (
                                                                            marshal_to_block
                                                                            (
                                                                                s
                                                                                512
                                                                                F
                                                                                  B
                                                                                    1
                                                                                []
                                                                                                                                                            )
                                                                          ;
                                                                            sequence
                                                                            (
                                                                              test
                                                                              (
                                                                                  417
                                                                                  match
                                                                                  marshal_from_block
                                                                                  (
                                                                                      s
                                                                                      512
                                                                                  )
                                                                                  (
                                                                                    case
                                                                                    (
                                                                                      F
                                                                                        B
                                                                                          1
                                                                                      true
                                                                                                                                                                          )
                                                                                    case
                                                                                    (
                                                                                      _
                                                                                      false
                                                                                                                                                                          )
                                                                                  )
                                                                              )
                                                                            ;
                                                                              sequence
                                                                              (
                                                                                marshal_to_block
                                                                                (
                                                                                    s
                                                                                    512
                                                                                    G
                                                                                      (
                                                                                        A
                                                                                                                                                                                G
                                                                                          (
                                                                                            B
                                                                                              2
                                                                                            G
                                                                                              (
                                                                                                C
                                                                                                  3.14
                                                                                                G
                                                                                                  (
                                                                                                    D
                                                                                                      "glop"
                                                                                                    E
                                                                                                      65
                                                                                                  )
                                                                                              )
                                                                                          )
                                                                                      )
                                                                                    []
                                                                                                                                                                    )
                                                                              ;
                                                                                sequence
                                                                                (
                                                                                  test
                                                                                  (
                                                                                      418
                                                                                      match
                                                                                      marshal_from_block
                                                                                      (
                                                                                          s
                                                                                          512
                                                                                      )
                                                                                      (
                                                                                        case
                                                                                        (
                                                                                          G
                                                                                            (
                                                                                              A
                                                                                                                                                                                            G
                                                                                                (
                                                                                                  B
                                                                                                    2
                                                                                                  G
                                                                                                    (
                                                                                                      C
                                                                                                        3.14
                                                                                                      G
                                                                                                        (
                                                                                                          D
                                                                                                            "glop"
                                                                                                          E
                                                                                                            65
                                                                                                        )
                                                                                                    )
                                                                                                )
                                                                                            )
                                                                                          true
                                                                                                                                                                                  )
                                                                                        case
                                                                                        (
                                                                                          _
                                                                                          false
                                                                                                                                                                                  )
                                                                                      )
                                                                                  )
                                                                                ;
                                                                                  sequence
                                                                                  (
                                                                                    marshal_to_block
                                                                                    (
                                                                                        s
                                                                                        512
                                                                                        H
                                                                                          (
                                                                                            1
                                                                                            A
                                                                                                                                                                                      )
                                                                                        []
                                                                                                                                                                            )
                                                                                  ;
                                                                                    sequence
                                                                                    (
                                                                                      test
                                                                                      (
                                                                                          419
                                                                                          match
                                                                                          marshal_from_block
                                                                                          (
                                                                                              s
                                                                                              512
                                                                                          )
                                                                                          (
                                                                                            case
                                                                                            (
                                                                                              H
                                                                                                (
                                                                                                  1
                                                                                                  A
                                                                                                                                                                                                  )
                                                                                              true
                                                                                                                                                                                          )
                                                                                            case
                                                                                            (
                                                                                              _
                                                                                              false
                                                                                                                                                                                          )
                                                                                          )
                                                                                      )
                                                                                    ;
                                                                                      sequence
                                                                                      (
                                                                                        marshal_to_block
                                                                                        (
                                                                                            s
                                                                                            512
                                                                                            I
                                                                                              (
                                                                                                B
                                                                                                  2
                                                                                                1e-6
                                                                                              )
                                                                                            []
                                                                                                                                                                                    )
                                                                                      ;
                                                                                        sequence
                                                                                        (
                                                                                          test
                                                                                          (
                                                                                              420
                                                                                              match
                                                                                              marshal_from_block
                                                                                              (
                                                                                                  s
                                                                                                  512
                                                                                              )
                                                                                              (
                                                                                                case
                                                                                                (
                                                                                                  I
                                                                                                    (
                                                                                                      B
                                                                                                        2
                                                                                                      1e-6
                                                                                                    )
                                                                                                  true
                                                                                                                                                                                                  )
                                                                                                case
                                                                                                (
                                                                                                  _
                                                                                                  false
                                                                                                                                                                                                  )
                                                                                              )
                                                                                          )
                                                                                        ;
                                                                                          let
                                                                                          (
                                                                                            (
                                                                                              x
                                                                                                D
                                                                                                  "sharing"
                                                                                            )
                                                                                          in
                                                                                            let
                                                                                            (
                                                                                              (
                                                                                                y
                                                                                                  G
                                                                                                    (
                                                                                                      x
                                                                                                      x
                                                                                                    )
                                                                                              )
                                                                                            in
                                                                                              let
                                                                                              (
                                                                                                (
                                                                                                  z
                                                                                                    G
                                                                                                      (
                                                                                                        y
                                                                                                        G
                                                                                                          (
                                                                                                            x
                                                                                                            y
                                                                                                          )
                                                                                                      )
                                                                                                )
                                                                                              in
                                                                                                sequence
                                                                                                (
                                                                                                  marshal_to_block
                                                                                                  (
                                                                                                      s
                                                                                                      512
                                                                                                      z
                                                                                                      []
                                                                                                                                                                                                        )
                                                                                                ;
                                                                                                  sequence
                                                                                                  (
                                                                                                    test
                                                                                                    (
                                                                                                        421
                                                                                                        match
                                                                                                        marshal_from_block
                                                                                                        (
                                                                                                            s
                                                                                                            512
                                                                                                        )
                                                                                                        (
                                                                                                          case
                                                                                                          (
                                                                                                            G
                                                                                                              (
                                                                                                                alias t3
                                                                                                                (
                                                                                                                  G
                                                                                                                    (
                                                                                                                      alias t1
                                                                                                                      (
                                                                                                                        D
                                                                                                                          "sharing"
                                                                                                                      )
                                                                                                                      t2
                                                                                                                    )
                                                                                                                )
                                                                                                                G
                                                                                                                  (
                                                                                                                    t4
                                                                                                                    t5
                                                                                                                  )
                                                                                                              )
                                                                                                            &&
                                                                                                            (
                                                                                                                ==
                                                                                                                (
                                                                                                                    t1
                                                                                                                    t2
                                                                                                                )
                                                                                                                &&
                                                                                                                (
                                                                                                                    ==
                                                                                                                    (
                                                                                                                        t3
                                                                                                                        t5
                                                                                                                    )
                                                                                                                    ==
                                                                                                                    (
                                                                                                                        t4
                                                                                                                        t1
                                                                                                                    )
                                                                                                                )
                                                                                                            )
                                                                                                          )
                                                                                                          case
                                                                                                          (
                                                                                                            _
                                                                                                            false
                                                                                                                                                                                                                      )
                                                                                                        )
                                                                                                    )
                                                                                                  ;
                                                                                                    sequence
                                                                                                    (
                                                                                                      marshal_to_block
                                                                                                      (
                                                                                                          s
                                                                                                          512
                                                                                                          array
                                                                                                          (
                                                                                                            1
                                                                                                            2
                                                                                                            3
                                                                                                            4
                                                                                                            5
                                                                                                            6
                                                                                                            7
                                                                                                            8
                                                                                                            9
                                                                                                            10
                                                                                                            11
                                                                                                            12
                                                                                                            13
                                                                                                            14
                                                                                                            15
                                                                                                            16
                                                                                                          )
                                                                                                          []
                                                                                                                                                                                                                )
                                                                                                    ;
                                                                                                      sequence
                                                                                                      (
                                                                                                        test
                                                                                                        (
                                                                                                            422
                                                                                                            =
                                                                                                            (
                                                                                                                marshal_from_block
                                                                                                                (
                                                                                                                    s
                                                                                                                    512
                                                                                                                )
                                                                                                                array
                                                                                                                (
                                                                                                                  1
                                                                                                                  2
                                                                                                                  3
                                                                                                                  4
                                                                                                                  5
                                                                                                                  6
                                                                                                                  7
                                                                                                                  8
                                                                                                                  9
                                                                                                                  10
                                                                                                                  11
                                                                                                                  12
                                                                                                                  13
                                                                                                                  14
                                                                                                                  15
                                                                                                                  16
                                                                                                                )
                                                                                                            )
                                                                                                        )
                                                                                                      ;
                                                                                                        let
                                                                                                        (
                                                                                                          (
                                                                                                            big
                                                                                                              (
                                                                                                                case
                                                                                                                (
                                                                                                                  n
                                                                                                                  ifthenelse
                                                                                                                  (
                                                                                                                    if
                                                                                                                    (
                                                                                                                      <=
                                                                                                                      (
                                                                                                                          n
                                                                                                                          0
                                                                                                                      )
                                                                                                                    )
                                                                                                                    then
                                                                                                                    (
                                                                                                                      A
                                                                                                                                                                                                                                          )
                                                                                                                    else
                                                                                                                    (
                                                                                                                        H
                                                                                                                          (
                                                                                                                            n
                                                                                                                            big
                                                                                                                            (
                                                                                                                                -
                                                                                                                                (
                                                                                                                                    n
                                                                                                                                    1
                                                                                                                                )
                                                                                                                            )
                                                                                                                          )
                                                                                                                    )
                                                                                                                  )
                                                                                                                )
                                                                                                              )
                                                                                                          )
                                                                                                        in
                                                                                                          sequence
                                                                                                          (
                                                                                                            test
                                                                                                            (
                                                                                                                423
                                                                                                                try
                                                                                                                sequence
                                                                                                                (
                                                                                                                  marshal_to_block
                                                                                                                  (
                                                                                                                      s
                                                                                                                      512
                                                                                                                      big
                                                                                                                      (
                                                                                                                          1000
                                                                                                                      )
                                                                                                                      []
                                                                                                                                                                                                                                        )
                                                                                                                ;
                                                                                                                  false
                                                                                                                                                                                                                                  )
                                                                                                                (
                                                                                                                  case
                                                                                                                  (
                                                                                                                    Failure
                                                                                                                      _
                                                                                                                    true
                                                                                                                                                                                                                                      )
                                                                                                                )
                                                                                                            )
                                                                                                          ;
                                                                                                            test
                                                                                                            (
                                                                                                                424
                                                                                                                try
                                                                                                                sequence
                                                                                                                (
                                                                                                                  marshal_to_block
                                                                                                                  (
                                                                                                                      s
                                                                                                                      512
                                                                                                                      "Hello, world!"
                                                                                                                      []
                                                                                                                                                                                                                                        )
                                                                                                                ;
                                                                                                                  sequence
                                                                                                                  (
                                                                                                                    ignore
                                                                                                                    (
                                                                                                                        marshal_from_block
                                                                                                                        (
                                                                                                                            s
                                                                                                                            8
                                                                                                                        )
                                                                                                                    )
                                                                                                                  ;
                                                                                                                    false
                                                                                                                                                                                                                                      )
                                                                                                                )
                                                                                                                (
                                                                                                                  case
                                                                                                                  (
                                                                                                                    Failure
                                                                                                                      _
                                                                                                                    true
                                                                                                                                                                                                                                      )
                                                                                                                )
                                                                                                            )
                                                                                                          )
                                                                                                        )
                                                                                                      )
                                                                                                    )
                                                                                                  )
                                                                                                )
                                                                                              )
                                                                                            )
                                                                                          )
                                                                                        )
                                                                                      )
                                                                                    )
                                                                                  )
                                                                                )
                                                                              )
                                                                            )
                                                                          )
                                                                        )
                                                                      )
                                                                    )
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    counter
      ref
      (
          0
      )
  )
  let
  (
    make_big
      (
        case
        (
          n
          ifthenelse
          (
            if
            (
              <=
              (
                  n
                  0
              )
            )
            then
            (
              sequence
              (
                incr
                (
                    counter
                )
              ;
                B
                  !
                  (
                      counter
                  )
              )
            )
            else
            (
                let
                (
                  (
                    l
                      make_big
                      (
                          -
                          (
                              n
                              1
                          )
                      )
                  )
                in
                  let
                  (
                    (
                      r
                        make_big
                        (
                            -
                            (
                                n
                                1
                            )
                        )
                    )
                  in
                    G
                      (
                        l
                        r
                      )
                  )
                )
            )
          )
        )
      )
  )
  let
  (
    check_big
      (
        case
        (
          n
          (
            case
            (
              x
              ifthenelse
              (
                if
                (
                  <=
                  (
                      n
                      0
                  )
                )
                then
                (
                  match
                  x
                  (
                    case
                    (
                      B
                        k
                      sequence
                      (
                        incr
                        (
                            counter
                        )
                      ;
                        =
                        (
                            k
                            !
                            (
                                counter
                            )
                        )
                      )
                    )
                    case
                    (
                      _
                      false
                                          )
                  )
                )
                else
                (
                    match
                    x
                    (
                      case
                      (
                        G
                          (
                            l
                            r
                          )
                        &&
                        (
                            check_big
                            (
                                -
                                (
                                    n
                                    1
                                )
                                l
                            )
                            check_big
                            (
                                -
                                (
                                    n
                                    1
                                )
                                r
                            )
                        )
                      )
                      case
                      (
                        _
                        false
                                              )
                    )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test_deep
      (
        case
        (
          ()
                    let
          (
            (
              loop
                (
                  case
                  (
                    acc
                    (
                      case
                      (
                        i
                        ifthenelse
                        (
                          if
                          (
                            <
                            (
                                i
                                max_data_depth
                            )
                          )
                          then
                          (
                            loop
                            (
                                ::
                                  (
                                    i
                                    acc
                                  )
                                +
                                (
                                    i
                                    1
                                )
                            )
                          )
                          else
                          (
                              acc
                          )
                        )
                      )
                    )
                  )
                )
            )
          in
            let
            (
              (
                x
                  loop
                  (
                      []
                                            0
                  )
              )
            in
              let
              (
                (
                  s
                    Marshal.to_string
                    (
                        x
                        []
                                            )
                )
              in
                sequence
                (
                  test
                  (
                      425
                      =
                      (
                          Marshal.from_string
                          (
                              s
                              0
                          )
                          x
                      )
                  )
                ;
                  let
                  (
                    (
                      loop
                        (
                          case
                          (
                            acc
                            (
                              case
                              (
                                i
                                ifthenelse
                                (
                                  if
                                  (
                                    <
                                    (
                                        i
                                        max_data_depth
                                    )
                                  )
                                  then
                                  (
                                    loop
                                    (
                                        G
                                          (
                                            acc
                                            B
                                              i
                                          )
                                        +
                                        (
                                            i
                                            1
                                        )
                                    )
                                  )
                                  else
                                  (
                                      acc
                                  )
                                )
                              )
                            )
                          )
                        )
                    )
                  in
                    let
                    (
                      (
                        x
                          loop
                          (
                              A
                                                            0
                          )
                      )
                    in
                      let
                      (
                        (
                          s
                            Marshal.to_string
                            (
                                x
                                []
                                                            )
                        )
                      in
                        test
                        (
                            426
                            =
                            (
                                Marshal.from_string
                                (
                                    s
                                    0
                                )
                                x
                            )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  class
  (
      params =
          (
          )
      class name = foo
      class expr =
          class_structure
            (
              Pcf_val "data1" Immutable Fresh ([451,16088+2]..[451,16088+19])
                "foo"
              Pcf_val "data2" Immutable Fresh ([452,16108+2]..[452,16108+19])
                "bar"
              Pcf_val "data3" Immutable Fresh ([453,16128+2]..[453,16128+17])
                42
              method test1
                ^
                (
                    data1
                    data2
                )
                              method test2
                false
                                              method test3
                send test1
                (
                  self
                )
                              method test4
                data3
                            )
  )
  class
  (
      params =
          (
          )
      class name = bar
      class expr =
          class_structure
            (
              Pcf_inher Fresh
                  constr foo
                  (
                  )
                  "super"
              Pcf_val "data2" Immutable Override ([462,16313+2]..[462,16313+22])
                "test5"
              Pcf_val "data4" Immutable Fresh ([463,16336+2]..[463,16336+21])
                "test3"
              Pcf_val "data5" Immutable Fresh ([464,16358+2]..[464,16358+21])
                "test4"
              method test1
                ^
                (
                    data1
                    ^
                    (
                        data2
                        ^
                        (
                            data4
                            ^
                            (
                                data5
                                Int64.to_string
                                (
                                    send test4
                                    (
                                      self
                                    )
                                )
                            )
                        )
                    )
                )
                            )
  )
  class
  (
      params =
          (
          )
      class name = foobar
      class expr =
          class_structure
            (
              Pcf_inher Fresh
                  constr foo
                  (
                  )
                  "super"
              Pcf_inher Override
                  constr bar
                  (
                  )
                            )
  )
  let
  (
    test_objects
      (
        case
        (
          ()
                    let
          (
            (
              x
                new foo
            )
          in
            let
            (
              (
                s
                  Marshal.to_string
                  (
                      x
                      ::
                        (
                          Marshal.Closures
                                                    []
                                                  )
                  )
              )
            in
              let
              (
                (
                  x
                    Marshal.from_string
                    (
                        s
                        0
                    )
                )
              in
                sequence
                (
                  test
                  (
                      500
                      =
                      (
                          send test1
                          (
                            x
                          )
                          "foobar"
                      )
                  )
                ;
                  sequence
                  (
                    test
                    (
                        501
                        =
                        (
                            send test2
                            (
                              x
                            )
                            false
                                                    )
                    )
                  ;
                    sequence
                    (
                      test
                      (
                          502
                          =
                          (
                              send test3
                              (
                                x
                              )
                              "foobar"
                          )
                      )
                    ;
                      sequence
                      (
                        test
                        (
                            503
                            =
                            (
                                send test4
                                (
                                  x
                                )
                                42
                            )
                        )
                      ;
                        let
                        (
                          (
                            x
                              new bar
                          )
                        in
                          let
                          (
                            (
                              s
                                Marshal.to_string
                                (
                                    x
                                    ::
                                      (
                                        Marshal.Closures
                                                                                []
                                                                              )
                                )
                            )
                          in
                            let
                            (
                              (
                                x
                                  Marshal.from_string
                                  (
                                      s
                                      0
                                  )
                              )
                            in
                              sequence
                              (
                                test
                                (
                                    504
                                    =
                                    (
                                        send test1
                                        (
                                          x
                                        )
                                        "footest5test3test442"
                                    )
                                )
                              ;
                                sequence
                                (
                                  test
                                  (
                                      505
                                      =
                                      (
                                          send test2
                                          (
                                            x
                                          )
                                          false
                                                                                )
                                  )
                                ;
                                  sequence
                                  (
                                    test
                                    (
                                        506
                                        =
                                        (
                                            send test3
                                            (
                                              x
                                            )
                                            "footest5test3test442"
                                        )
                                    )
                                  ;
                                    sequence
                                    (
                                      test
                                      (
                                          507
                                          =
                                          (
                                              send test4
                                              (
                                                x
                                              )
                                              42
                                          )
                                      )
                                    ;
                                      let
                                      (
                                        (
                                          x0
                                            new foobar
                                        )
                                      in
                                        let
                                        (
                                          (
                                            s
                                              Marshal.to_string
                                              (
                                                  x0
                                                  ::
                                                    (
                                                      Marshal.Closures
                                                                                                            []
                                                                                                          )
                                              )
                                          )
                                        in
                                          let
                                          (
                                            (
                                              x
                                                Marshal.from_string
                                                (
                                                    s
                                                    0
                                                )
                                            )
                                          in
                                            sequence
                                            (
                                              test
                                              (
                                                  508
                                                  =
                                                  (
                                                      send test1
                                                      (
                                                        x
                                                      )
                                                      "footest5test3test442"
                                                  )
                                              )
                                            ;
                                              sequence
                                              (
                                                test
                                                (
                                                    509
                                                    =
                                                    (
                                                        send test2
                                                        (
                                                          x
                                                        )
                                                        false
                                                                                                            )
                                                )
                                              ;
                                                sequence
                                                (
                                                  test
                                                  (
                                                      510
                                                      =
                                                      (
                                                          send test3
                                                          (
                                                            x
                                                          )
                                                          "footest5test3test442"
                                                      )
                                                  )
                                                ;
                                                  sequence
                                                  (
                                                    test
                                                    (
                                                        511
                                                        =
                                                        (
                                                            send test4
                                                            (
                                                              x
                                                            )
                                                            42
                                                        )
                                                    )
                                                  ;
                                                    test
                                                    (
                                                        512
                                                        =
                                                        (
                                                            Oo.id
                                                            (
                                                                x
                                                            )
                                                            +
                                                            (
                                                                Oo.id
                                                                (
                                                                    x0
                                                                )
                                                                1
                                                            )
                                                        )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    test_infix
      (
        case
        (
          ()
                    let
          (
            (
              t
                true
                              f
                false
                            )
          in
            let
            (
              (
                odd
                  (
                    case
                    (
                      n
                      ifthenelse
                      (
                        if
                        (
                          =
                          (
                              n
                              0
                          )
                        )
                        then
                        (
                          f
                        )
                        else
                        (
                            even
                            (
                                -
                                (
                                    n
                                    1
                                )
                            )
                        )
                      )
                    )
                  )
                even
                  (
                    case
                    (
                      n
                      ifthenelse
                      (
                        if
                        (
                          =
                          (
                              n
                              0
                          )
                        )
                        then
                        (
                          t
                        )
                        else
                        (
                            odd
                            (
                                -
                                (
                                    n
                                    1
                                )
                            )
                        )
                      )
                    )
                  )
              )
            in
              let
              (
                (
                  s
                    Marshal.to_string
                    (
                        (
                          odd
                          even
                        )
                        ::
                          (
                            Marshal.Closures
                                                        []
                                                      )
                    )
                )
              in
                let
                (
                  (
                    (
                      odd'
                      even'
                    )
                      tuple
                      (
                          arrow
                             int
                            (
                            )
                             bool
                            (
                            )
                          arrow
                             int
                            (
                            )
                             bool
                            (
                            )
                      )
                      Marshal.from_string
                      (
                          s
                          0
                      )
                  )
                in
                  sequence
                  (
                    test
                    (
                        600
                        =
                        (
                            odd'
                            (
                                41
                            )
                            true
                                                    )
                    )
                  ;
                    sequence
                    (
                      test
                      (
                          601
                          =
                          (
                              odd'
                              (
                                  41
                              )
                              odd
                              (
                                  41
                              )
                          )
                      )
                    ;
                      sequence
                      (
                        test
                        (
                            602
                            =
                            (
                                odd'
                                (
                                    142
                                )
                                false
                                                            )
                        )
                      ;
                        sequence
                        (
                          test
                          (
                              603
                              =
                              (
                                  odd'
                                  (
                                      142
                                  )
                                  odd
                                  (
                                      142
                                  )
                              )
                          )
                        ;
                          sequence
                          (
                            test
                            (
                                604
                                =
                                (
                                    even'
                                    (
                                        41
                                    )
                                    false
                                                                    )
                            )
                          ;
                            sequence
                            (
                              test
                              (
                                  605
                                  =
                                  (
                                      even'
                                      (
                                          41
                                      )
                                      even
                                      (
                                          41
                                      )
                                  )
                              )
                            ;
                              sequence
                              (
                                test
                                (
                                    606
                                    =
                                    (
                                        even'
                                        (
                                            142
                                        )
                                        true
                                                                            )
                                )
                              ;
                                test
                                (
                                    607
                                    =
                                    (
                                        even'
                                        (
                                            142
                                        )
                                        even
                                        (
                                            142
                                        )
                                    )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
  )
  let
  (
    main
      (
        case
        (
          ()
                    ifthenelse
          (
            if
            (
              <=
              (
                  Array.length
                  (
                      Sys.argv
                  )
                  2
              )
            )
            then
            (
              sequence
              (
                test_out
                (
                    "intext.data"
                )
              ;
                sequence
                (
                  test_in
                  (
                      "intext.data"
                  )
                ;
                  sequence
                  (
                    test_out
                    (
                        "intext.data"
                    )
                  ;
                    sequence
                    (
                      test_in
                      (
                          "intext.data"
                      )
                    ;
                      sequence
                      (
                        Sys.remove
                        (
                            "intext.data"
                        )
                      ;
                        sequence
                        (
                          test_string
                          (
                              ()
                                                        )
                        ;
                          sequence
                          (
                            test_buffer
                            (
                                ()
                                                            )
                          ;
                            sequence
                            (
                              test_size
                              (
                                  ()
                                                                )
                            ;
                              sequence
                              (
                                test_block
                                (
                                    ()
                                                                    )
                              ;
                                sequence
                                (
                                  test_deep
                                  (
                                      ()
                                                                        )
                                ;
                                  sequence
                                  (
                                    test_objects
                                    (
                                        ()
                                                                            )
                                  ;
                                    test_infix
                                    (
                                        ()
                                                                            )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            )
            else
            (
                ifthenelse
                (
                  if
                  (
                    =
                    (
                        Array.get
                        (
                            Sys.argv
                            1
                        )
                        "make"
                    )
                  )
                  then
                  (
                    let
                    (
                      (
                        n
                          int_of_string
                          (
                              Array.get
                              (
                                  Sys.argv
                                  2
                              )
                          )
                      )
                    in
                      let
                      (
                        (
                          oc
                            open_out_bin
                            (
                                "intext.data"
                            )
                        )
                      in
                        sequence
                        (
                          :=
                          (
                              counter
                              0
                          )
                        ;
                          sequence
                          (
                            output_value
                            (
                                oc
                                make_big
                                (
                                    n
                                )
                            )
                          ;
                            close_out
                            (
                                oc
                            )
                          )
                        )
                      )
                    )
                  )
                  else
                  (
                      ifthenelse
                      (
                        if
                        (
                          =
                          (
                              Array.get
                              (
                                  Sys.argv
                                  1
                              )
                              "test"
                          )
                        )
                        then
                        (
                          let
                          (
                            (
                              n
                                int_of_string
                                (
                                    Array.get
                                    (
                                        Sys.argv
                                        2
                                    )
                                )
                            )
                          in
                            let
                            (
                              (
                                ic
                                  open_in_bin
                                  (
                                      "intext.data"
                                  )
                              )
                            in
                              let
                              (
                                (
                                  b
                                    (
                                    input_value
                                    (
                                        ic
                                    )
                                    :
                                         t
                                        (
                                        )
                                                                        )
                                )
                              in
                                sequence
                                (
                                  Gc.full_major
                                  (
                                      ()
                                                                        )
                                ;
                                  sequence
                                  (
                                    close_in
                                    (
                                        ic
                                    )
                                  ;
                                    sequence
                                    (
                                      :=
                                      (
                                          counter
                                          0
                                      )
                                    ;
                                      sequence
                                      (
                                        ifthenelse
                                        (
                                          if
                                          (
                                            check_big
                                            (
                                                n
                                                b
                                            )
                                          )
                                          then
                                          (
                                            Printf.printf
                                            (
                                                "Test big %d passed"
                                                n
                                            )
                                          )
                                          else
                                          (
                                              Printf.printf
                                              (
                                                  "Test big %d FAILED"
                                                  n
                                              )
                                          )
                                        )
                                      ;
                                        print_newline
                                        (
                                            ()
                                                                                    )
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                        else
                        (
                                                  )
                      )
                  )
                )
            )
          )
        )
      )
  )
  sequence
  (
    Printexc.catch
    (
        main
        ()
            )
  ;
    exit
    (
        0
    )
  )
)
