(
  open Testing
  open Buffer
  let
  (
    identity
      (
        case
        (
          s
          s
        )
      )
  )
  let
  (
    b
      Buffer.create
      (
          100
      )
  )
  let
  (
    (
      pat0
        "\\\\a"
    )
  in
    let
    (
      (
        n0
          String.length
          (
              pat0
          )
      )
    in
      sequence
      (
        Buffer.add_substitute
        (
            b
            identity
            pat0
        )
      ;
        test
        (
            =
            (
                String.length
                (
                    Buffer.contents
                    (
                        b
                    )
                )
                n0
            )
        )
      )
    )
  )
  let
  (
    (
      pat1
        "b\\"
    )
  in
    let
    (
      (
        n1
          String.length
          (
              pat1
          )
      )
    in
      sequence
      (
        Buffer.clear
        (
            b
        )
      ;
        sequence
        (
          Buffer.add_substitute
          (
              b
              identity
              pat1
          )
        ;
          test
          (
              =
              (
                  String.length
                  (
                      Buffer.contents
                      (
                          b
                      )
                  )
                  n1
              )
          )
        )
      )
    )
  )
)
